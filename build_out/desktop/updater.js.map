{"version":3,"file":"updater.js","sourceRoot":"","sources":["../../src/desktop/updater.ts"],"names":[],"mappings":"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","sourcesContent":["import { autoUpdater } from \"electron-updater\";\r\nimport type { UpdateInfo } from \"electron-updater\";\r\nimport { log } from \"@/node/services/log\";\r\nimport { parseDebugUpdater } from \"@/common/utils/env\";\r\n\r\n// Update check timeout in milliseconds (30 seconds)\r\nconst UPDATE_CHECK_TIMEOUT_MS = 30_000;\r\n\r\n// Backend UpdateStatus type (uses full UpdateInfo from electron-updater)\r\nexport type UpdateStatus =\r\n  | { type: \"idle\" } // Initial state, no check performed yet\r\n  | { type: \"checking\" }\r\n  | { type: \"available\"; info: UpdateInfo }\r\n  | { type: \"up-to-date\" } // Explicitly checked, no updates available\r\n  | { type: \"downloading\"; percent: number }\r\n  | { type: \"downloaded\"; info: UpdateInfo }\r\n  | { type: \"error\"; message: string };\r\n\r\n/**\r\n * Manages application updates using electron-updater.\r\n *\r\n * This service integrates with Electron's auto-updater to:\r\n * - Check for updates automatically and on-demand\r\n * - Download updates in the background\r\n * - Notify the renderer process of update status changes\r\n * - Install updates when requested by the user\r\n */\r\nexport class UpdaterService {\r\n  private updateStatus: UpdateStatus = { type: \"idle\" };\r\n  private checkTimeout: ReturnType<typeof setTimeout> | null = null;\r\n  private readonly fakeVersion: string | undefined;\r\n  private subscribers = new Set<(status: UpdateStatus) => void>();\r\n\r\n  constructor() {\r\n    // Configure auto-updater\r\n    autoUpdater.autoDownload = false; // Wait for user confirmation\r\n    autoUpdater.autoInstallOnAppQuit = true;\r\n\r\n    // Parse DEBUG_UPDATER for dev mode and optional fake version\r\n    const debugConfig = parseDebugUpdater(process.env.DEBUG_UPDATER);\r\n    this.fakeVersion = debugConfig.fakeVersion;\r\n\r\n    if (debugConfig.enabled) {\r\n      log.debug(\"Forcing dev update config (DEBUG_UPDATER is set)\");\r\n      autoUpdater.forceDevUpdateConfig = true;\r\n\r\n      if (this.fakeVersion) {\r\n        log.debug(`DEBUG_UPDATER fake version enabled: ${this.fakeVersion}`);\r\n      }\r\n    }\r\n\r\n    // Set up event handlers\r\n    this.setupEventHandlers();\r\n  }\r\n\r\n  private setupEventHandlers() {\r\n    autoUpdater.on(\"checking-for-update\", () => {\r\n      log.debug(\"Checking for updates...\");\r\n      this.updateStatus = { type: \"checking\" };\r\n      this.notifyRenderer();\r\n    });\r\n\r\n    autoUpdater.on(\"update-available\", (info: UpdateInfo) => {\r\n      log.info(\"Update available:\", info.version);\r\n      this.clearCheckTimeout();\r\n      this.updateStatus = { type: \"available\", info };\r\n      this.notifyRenderer();\r\n    });\r\n\r\n    autoUpdater.on(\"update-not-available\", () => {\r\n      log.debug(\"No updates available - up to date\");\r\n      this.clearCheckTimeout();\r\n      this.updateStatus = { type: \"up-to-date\" };\r\n      this.notifyRenderer();\r\n    });\r\n\r\n    autoUpdater.on(\"download-progress\", (progress) => {\r\n      const percent = Math.round(progress.percent);\r\n      log.debug(`Download progress: ${percent}%`);\r\n      this.updateStatus = { type: \"downloading\", percent };\r\n      this.notifyRenderer();\r\n    });\r\n\r\n    autoUpdater.on(\"update-downloaded\", (info: UpdateInfo) => {\r\n      log.info(\"Update downloaded:\", info.version);\r\n      this.updateStatus = { type: \"downloaded\", info };\r\n      this.notifyRenderer();\r\n    });\r\n\r\n    autoUpdater.on(\"error\", (error) => {\r\n      log.error(\"Update error:\", error);\r\n      this.clearCheckTimeout();\r\n      this.updateStatus = { type: \"error\", message: error.message };\r\n      this.notifyRenderer();\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Clear the check timeout\r\n   */\r\n  private clearCheckTimeout() {\r\n    if (this.checkTimeout) {\r\n      clearTimeout(this.checkTimeout);\r\n      this.checkTimeout = null;\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Check for updates manually\r\n   *\r\n   * This triggers the check but returns immediately. The actual results\r\n   * will be delivered via event handlers (checking-for-update, update-available, etc.)\r\n   *\r\n   * A 30-second timeout ensures we don't stay in \"checking\" state indefinitely.\r\n   */\r\n  checkForUpdates(): void {\r\n    log.debug(\"checkForUpdates() called\");\r\n    try {\r\n      // Clear any existing timeout\r\n      this.clearCheckTimeout();\r\n\r\n      // Set checking status immediately\r\n      log.debug(\"Setting status to 'checking'\");\r\n      this.updateStatus = { type: \"checking\" };\r\n      this.notifyRenderer();\r\n\r\n      // If fake version is set, immediately report it as available\r\n      if (this.fakeVersion) {\r\n        log.debug(`Faking update available: ${this.fakeVersion}`);\r\n        const version = this.fakeVersion;\r\n        setTimeout(() => {\r\n          const fakeInfo = {\r\n            version,\r\n          } satisfies Partial<UpdateInfo> as UpdateInfo;\r\n          this.updateStatus = {\r\n            type: \"available\",\r\n            info: fakeInfo,\r\n          };\r\n          this.notifyRenderer();\r\n        }, 500); // Small delay to simulate check\r\n        return;\r\n      }\r\n\r\n      // Set timeout to prevent hanging in \"checking\" state\r\n      log.debug(`Setting ${UPDATE_CHECK_TIMEOUT_MS}ms timeout`);\r\n      this.checkTimeout = setTimeout(() => {\r\n        if (this.updateStatus.type === \"checking\") {\r\n          log.debug(\r\n            `Update check timed out after ${UPDATE_CHECK_TIMEOUT_MS}ms, returning to idle state`\r\n          );\r\n          this.updateStatus = { type: \"idle\" };\r\n          this.notifyRenderer();\r\n        } else {\r\n          log.debug(`Timeout fired but status already changed to: ${this.updateStatus.type}`);\r\n        }\r\n      }, UPDATE_CHECK_TIMEOUT_MS);\r\n\r\n      // Trigger the check (don't await - it never resolves, just fires events)\r\n      log.debug(\"Calling autoUpdater.checkForUpdates()\");\r\n      autoUpdater.checkForUpdates().catch((error) => {\r\n        this.clearCheckTimeout();\r\n        const message = error instanceof Error ? error.message : \"Unknown error\";\r\n        log.error(\"Update check failed:\", message);\r\n        this.updateStatus = { type: \"error\", message };\r\n        this.notifyRenderer();\r\n      });\r\n    } catch (error) {\r\n      this.clearCheckTimeout();\r\n      const message = error instanceof Error ? error.message : \"Unknown error\";\r\n      log.error(\"Update check error:\", message);\r\n      this.updateStatus = { type: \"error\", message };\r\n      this.notifyRenderer();\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Download an available update\r\n   */\r\n  async downloadUpdate(): Promise<void> {\r\n    if (this.updateStatus.type !== \"available\") {\r\n      throw new Error(\"No update available to download\");\r\n    }\r\n\r\n    // If using fake version, simulate download progress\r\n    if (this.fakeVersion) {\r\n      log.debug(`Faking download for version ${this.fakeVersion}`);\r\n      this.updateStatus = { type: \"downloading\", percent: 0 };\r\n      this.notifyRenderer();\r\n\r\n      // Simulate download progress\r\n      for (let percent = 0; percent <= 100; percent += 10) {\r\n        await new Promise((resolve) => setTimeout(resolve, 200));\r\n        this.updateStatus = { type: \"downloading\", percent };\r\n        this.notifyRenderer();\r\n      }\r\n\r\n      // Mark as downloaded\r\n      const version = this.fakeVersion;\r\n      const fakeDownloadedInfo = { version } satisfies Partial<UpdateInfo> as UpdateInfo;\r\n      this.updateStatus = {\r\n        type: \"downloaded\",\r\n        info: fakeDownloadedInfo,\r\n      };\r\n      this.notifyRenderer();\r\n      return;\r\n    }\r\n\r\n    await autoUpdater.downloadUpdate();\r\n  }\r\n\r\n  /**\r\n   * Install a downloaded update and restart the app\r\n   */\r\n  installUpdate(): void {\r\n    if (this.updateStatus.type !== \"downloaded\") {\r\n      throw new Error(\"No update downloaded to install\");\r\n    }\r\n\r\n    // If using fake version, just log (can't actually restart with fake update)\r\n    if (this.fakeVersion) {\r\n      log.debug(`Fake update install requested for ${this.fakeVersion} - would restart app here`);\r\n      return;\r\n    }\r\n\r\n    autoUpdater.quitAndInstall();\r\n  }\r\n\r\n  /**\r\n   * Get the current update status\r\n   */\r\n\r\n  /**\r\n   * Subscribe to status updates\r\n   */\r\n  subscribe(callback: (status: UpdateStatus) => void): () => void {\r\n    this.subscribers.add(callback);\r\n    return () => {\r\n      this.subscribers.delete(callback);\r\n    };\r\n  }\r\n  getStatus(): UpdateStatus {\r\n    return this.updateStatus;\r\n  }\r\n\r\n  /**\r\n   * Notify the renderer process of status changes\r\n   */\r\n  private notifyRenderer() {\r\n    log.debug(\"notifyRenderer() called, status:\", this.updateStatus);\r\n    // Notify subscribers (ORPC)\r\n    for (const subscriber of this.subscribers) {\r\n      try {\r\n        subscriber(this.updateStatus);\r\n      } catch (err) {\r\n        log.error(\"Error notifying subscriber:\", err);\r\n      }\r\n    }\r\n  }\r\n}\r\n"]}