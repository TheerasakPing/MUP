{"version":3,"file":"StreamingTokenTracker.js","sourceRoot":"","sources":["../../../../src/node/utils/main/StreamingTokenTracker.ts"],"names":[],"mappings":";AAAA;;;;;GAKG;;;AAEH,2CAAmE;AAEnE;;GAEG;AACH;IACU,SAAS,GAAqB,IAAI,CAAC;IAE3C;;;OAGG;IACH,KAAK,CAAC,QAAQ,CAAC,KAAa,EAAiB;QAC3C,IAAI,CAAC,SAAS,KAAd,IAAI,CAAC,SAAS,GAAK,MAAM,IAAA,gCAAoB,EAAC,KAAK,CAAC,EAAC;IAAA,CACtD;IAED;;;OAGG;IACH,KAAK,CAAC,WAAW,CAAC,IAAY,EAAmB;QAC/C,IAAI,CAAC,IAAI,CAAC,SAAS,IAAI,CAAC,IAAI;YAAE,OAAO,CAAC,CAAC;QACvC,OAAO,IAAI,CAAC,SAAS,CAAC,WAAW,CAAC,IAAI,CAAC,CAAC;IAAA,CACzC;CACF","sourcesContent":["/**\r\n * StreamingTokenTracker - Synchronous token counting for streaming deltas\r\n *\r\n * Simplified tracker that provides immediate token counts for each delta.\r\n * TPS calculation moved to frontend for better replay support and flexibility.\r\n */\r\n\r\nimport { getTokenizerForModel, type Tokenizer } from \"./tokenizer\";\r\n\r\n/**\r\n * StreamingTokenTracker provides synchronous token counting\r\n */\r\nexport class StreamingTokenTracker {\r\n  private tokenizer: Tokenizer | null = null;\r\n\r\n  /**\r\n   * Initialize tokenizer for the current model\r\n   * Should be called when model changes or on first stream\r\n   */\r\n  async setModel(model: string): Promise<void> {\r\n    this.tokenizer ??= await getTokenizerForModel(model);\r\n  }\r\n\r\n  /**\r\n   * Count tokens in a text string synchronously\r\n   * Performance: <1ms per delta with LRU caching\r\n   */\r\n  async countTokens(text: string): Promise<number> {\r\n    if (!this.tokenizer || !text) return 0;\r\n    return this.tokenizer.countTokens(text);\r\n  }\r\n}\r\n"]}