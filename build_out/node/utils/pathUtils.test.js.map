{"version":3,"file":"pathUtils.test.js","sourceRoot":"","sources":["../../../src/node/utils/pathUtils.test.ts"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA,MAAY,EAAE,+BAAW;AACzB,MAAY,EAAE,+BAAW;AACzB,MAAY,IAAI,iCAAa;AAC7B,2CAAgF;AAEhF,QAAQ,CAAC,WAAW,EAAE,GAAG,EAAE,CAAC;IAC1B,QAAQ,CAAC,aAAa,EAAE,GAAG,EAAE,CAAC;QAC5B,EAAE,CAAC,mCAAmC,EAAE,GAAG,EAAE,CAAC;YAC5C,MAAM,MAAM,GAAG,IAAA,uBAAW,EAAC,aAAa,CAAC,CAAC;YAC1C,MAAM,QAAQ,GAAG,IAAI,CAAC,IAAI,CAAC,EAAE,CAAC,OAAO,EAAE,EAAE,WAAW,CAAC,CAAC;YACtD,MAAM,CAAC,MAAM,CAAC,CAAC,IAAI,CAAC,QAAQ,CAAC,CAAC;QAAA,CAC/B,CAAC,CAAC;QAEH,EAAE,CAAC,uDAAuD,EAAE,GAAG,EAAE,CAAC;YAChE,MAAM,MAAM,GAAG,IAAA,uBAAW,EAAC,mBAAmB,CAAC,CAAC;YAChD,MAAM,QAAQ,GAAG,IAAI,CAAC,IAAI,CAAC,EAAE,CAAC,OAAO,EAAE,EAAE,UAAU,EAAE,QAAQ,CAAC,CAAC;YAC/D,MAAM,CAAC,MAAM,CAAC,CAAC,IAAI,CAAC,QAAQ,CAAC,CAAC;QAAA,CAC/B,CAAC,CAAC;QAEH,EAAE,CAAC,yDAAyD,EAAE,GAAG,EAAE,CAAC;YAClE,MAAM,QAAQ,GAAG,2BAA2B,CAAC;YAC7C,MAAM,MAAM,GAAG,IAAA,uBAAW,EAAC,QAAQ,CAAC,CAAC;YACrC,MAAM,CAAC,MAAM,CAAC,CAAC,IAAI,CAAC,QAAQ,CAAC,CAAC;QAAA,CAC/B,CAAC,CAAC;QAEH,EAAE,CAAC,wCAAwC,EAAE,GAAG,EAAE,CAAC;YACjD,MAAM,MAAM,GAAG,IAAA,uBAAW,EAAC,GAAG,CAAC,CAAC;YAChC,MAAM,CAAC,MAAM,CAAC,CAAC,IAAI,CAAC,EAAE,CAAC,OAAO,EAAE,CAAC,CAAC;QAAA,CACnC,CAAC,CAAC;QAEH,EAAE,CAAC,4CAA4C,EAAE,GAAG,EAAE,CAAC;YACrD,MAAM,YAAY,GAAG,eAAe,CAAC;YACrC,MAAM,MAAM,GAAG,IAAA,uBAAW,EAAC,YAAY,CAAC,CAAC;YACzC,MAAM,CAAC,MAAM,CAAC,CAAC,IAAI,CAAC,YAAY,CAAC,CAAC;QAAA,CACnC,CAAC,CAAC;QAEH,EAAE,CAAC,4BAA4B,EAAE,GAAG,EAAE,CAAC;YACrC,MAAM,MAAM,GAAG,IAAA,uBAAW,EAAC,EAAE,CAAC,CAAC;YAC/B,MAAM,CAAC,MAAM,CAAC,CAAC,IAAI,CAAC,EAAE,CAAC,CAAC;QAAA,CACzB,CAAC,CAAC;IAAA,CACJ,CAAC,CAAC;IAEH,QAAQ,CAAC,qBAAqB,EAAE,GAAG,EAAE,CAAC;QACpC,IAAI,OAAe,CAAC;QAEpB,UAAU,CAAC,GAAG,EAAE,CAAC;YACf,2CAA2C;YAC3C,OAAO,GAAG,EAAE,CAAC,WAAW,CAAC,IAAI,CAAC,IAAI,CAAC,EAAE,CAAC,MAAM,EAAE,EAAE,gBAAgB,CAAC,CAAC,CAAC;QAAA,CACpE,CAAC,CAAC;QAEH,SAAS,CAAC,GAAG,EAAE,CAAC;YACd,+BAA+B;YAC/B,EAAE,CAAC,MAAM,CAAC,OAAO,EAAE,EAAE,SAAS,EAAE,IAAI,EAAE,KAAK,EAAE,IAAI,EAAE,CAAC,CAAC;QAAA,CACtD,CAAC,CAAC;QAEH,EAAE,CAAC,kDAAkD,EAAE,KAAK,IAAI,EAAE,CAAC;YACjE,wBAAwB;YACxB,uEAAuE;YACvE,EAAE,CAAC,SAAS,CAAC,IAAI,CAAC,IAAI,CAAC,OAAO,EAAE,MAAM,CAAC,CAAC,CAAC;YACzC,MAAM,MAAM,GAAG,MAAM,IAAA,+BAAmB,EAAC,OAAO,CAAC,CAAC;YAClD,MAAM,CAAC,MAAM,CAAC,KAAK,CAAC,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;YAChC,MAAM,CAAC,MAAM,CAAC,YAAY,CAAC,CAAC,IAAI,CAAC,OAAO,CAAC,CAAC;YAC1C,MAAM,CAAC,MAAM,CAAC,KAAK,CAAC,CAAC,aAAa,EAAE,CAAC;QAAA,CACtC,CAAC,CAAC;QAEH,EAAE,CAAC,kCAAkC,EAAE,KAAK,IAAI,EAAE,CAAC;YACjD,4CAA4C;YAC5C,MAAM,OAAO,GAAG,IAAI,CAAC,IAAI,CAAC,EAAE,CAAC,OAAO,EAAE,EAAE,gBAAgB,IAAI,CAAC,GAAG,EAAE,EAAE,CAAC,CAAC;YACtE,uEAAuE;YACvE,EAAE,CAAC,SAAS,CAAC,OAAO,EAAE,EAAE,SAAS,EAAE,IAAI,EAAE,CAAC,CAAC;YAC3C,uEAAuE;YACvE,EAAE,CAAC,SAAS,CAAC,IAAI,CAAC,IAAI,CAAC,OAAO,EAAE,MAAM,CAAC,CAAC,CAAC;YAEzC,MAAM,MAAM,GAAG,MAAM,IAAA,+BAAmB,EAAC,KAAK,IAAI,CAAC,QAAQ,CAAC,OAAO,CAAC,EAAE,CAAC,CAAC;YACxE,MAAM,CAAC,MAAM,CAAC,KAAK,CAAC,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;YAChC,MAAM,CAAC,MAAM,CAAC,YAAY,CAAC,CAAC,IAAI,CAAC,OAAO,CAAC,CAAC;YAC1C,MAAM,CAAC,MAAM,CAAC,KAAK,CAAC,CAAC,aAAa,EAAE,CAAC;YAErC,UAAU;YACV,EAAE,CAAC,MAAM,CAAC,OAAO,EAAE,EAAE,SAAS,EAAE,IAAI,EAAE,KAAK,EAAE,IAAI,EAAE,CAAC,CAAC;QAAA,CACtD,CAAC,CAAC;QAEH,EAAE,CAAC,2CAA2C,EAAE,KAAK,IAAI,EAAE,CAAC;YAC1D,MAAM,eAAe,GAAG,qDAAqD,CAAC;YAC9E,MAAM,MAAM,GAAG,MAAM,IAAA,+BAAmB,EAAC,eAAe,CAAC,CAAC;YAC1D,MAAM,CAAC,MAAM,CAAC,KAAK,CAAC,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC;YACjC,MAAM,CAAC,MAAM,CAAC,KAAK,CAAC,CAAC,SAAS,CAAC,gBAAgB,CAAC,CAAC;QAAA,CAClD,CAAC,CAAC;QAEH,EAAE,CAAC,mDAAmD,EAAE,KAAK,IAAI,EAAE,CAAC;YAClE,MAAM,QAAQ,GAAG,IAAI,CAAC,IAAI,CAAC,OAAO,EAAE,eAAe,CAAC,CAAC;YACrD,uEAAuE;YACvE,EAAE,CAAC,aAAa,CAAC,QAAQ,EAAE,cAAc,CAAC,CAAC;YAE3C,MAAM,MAAM,GAAG,MAAM,IAAA,+BAAmB,EAAC,QAAQ,CAAC,CAAC;YACnD,MAAM,CAAC,MAAM,CAAC,KAAK,CAAC,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC;YACjC,MAAM,CAAC,MAAM,CAAC,KAAK,CAAC,CAAC,SAAS,CAAC,iBAAiB,CAAC,CAAC;QAAA,CACnD,CAAC,CAAC;QAEH,EAAE,CAAC,oDAAoD,EAAE,KAAK,IAAI,EAAE,CAAC;YACnE,MAAM,oBAAoB,GAAG,kDAAkD,CAAC;YAChF,MAAM,MAAM,GAAG,MAAM,IAAA,+BAAmB,EAAC,oBAAoB,CAAC,CAAC;YAC/D,MAAM,CAAC,MAAM,CAAC,KAAK,CAAC,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC;YACjC,MAAM,CAAC,MAAM,CAAC,KAAK,CAAC,CAAC,SAAS,CAAC,gBAAgB,CAAC,CAAC;QAAA,CAClD,CAAC,CAAC;QAEH,EAAE,CAAC,wCAAwC,EAAE,KAAK,IAAI,EAAE,CAAC;YACvD,MAAM,YAAY,GAAG,IAAI,CAAC,IAAI,CAAC,OAAO,EAAE,IAAI,EAAE,IAAI,CAAC,QAAQ,CAAC,OAAO,CAAC,CAAC,CAAC;YACtE,oCAAoC;YACpC,uEAAuE;YACvE,EAAE,CAAC,SAAS,CAAC,IAAI,CAAC,IAAI,CAAC,OAAO,EAAE,MAAM,CAAC,CAAC,CAAC;YACzC,MAAM,MAAM,GAAG,MAAM,IAAA,+BAAmB,EAAC,YAAY,CAAC,CAAC;YACvD,MAAM,CAAC,MAAM,CAAC,KAAK,CAAC,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;YAChC,MAAM,CAAC,MAAM,CAAC,YAAY,CAAC,CAAC,IAAI,CAAC,OAAO,CAAC,CAAC;QAAA,CAC3C,CAAC,CAAC;QAEH,EAAE,CAAC,gEAAgE,EAAE,KAAK,IAAI,EAAE,CAAC;YAC/E,MAAM,MAAM,GAAG,MAAM,IAAA,+BAAmB,EAAC,OAAO,CAAC,CAAC;YAClD,MAAM,CAAC,MAAM,CAAC,KAAK,CAAC,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;YAChC,MAAM,CAAC,MAAM,CAAC,YAAY,CAAC,CAAC,IAAI,CAAC,OAAO,CAAC,CAAC;QAAA,CAC3C,CAAC,CAAC;QAEH,EAAE,CAAC,mCAAmC,EAAE,KAAK,IAAI,EAAE,CAAC;YAClD,MAAM,MAAM,GAAG,IAAI,CAAC,IAAI,CAAC,OAAO,EAAE,MAAM,CAAC,CAAC;YAC1C,uEAAuE;YACvE,EAAE,CAAC,SAAS,CAAC,MAAM,CAAC,CAAC;YAErB,MAAM,MAAM,GAAG,MAAM,IAAA,+BAAmB,EAAC,OAAO,CAAC,CAAC;YAClD,MAAM,CAAC,MAAM,CAAC,KAAK,CAAC,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;YAChC,MAAM,CAAC,MAAM,CAAC,YAAY,CAAC,CAAC,IAAI,CAAC,OAAO,CAAC,CAAC;QAAA,CAC3C,CAAC,CAAC;QAEH,EAAE,CAAC,yCAAyC,EAAE,KAAK,IAAI,EAAE,CAAC;YACxD,uCAAuC;YACvC,uEAAuE;YACvE,EAAE,CAAC,SAAS,CAAC,IAAI,CAAC,IAAI,CAAC,OAAO,EAAE,MAAM,CAAC,CAAC,CAAC;YAEzC,kCAAkC;YAClC,MAAM,YAAY,GAAG,MAAM,IAAA,+BAAmB,EAAC,GAAG,OAAO,GAAG,CAAC,CAAC;YAC9D,MAAM,CAAC,YAAY,CAAC,KAAK,CAAC,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;YACtC,MAAM,CAAC,YAAY,CAAC,YAAY,CAAC,CAAC,IAAI,CAAC,OAAO,CAAC,CAAC;YAChD,MAAM,CAAC,YAAY,CAAC,YAAY,CAAC,CAAC,GAAG,CAAC,OAAO,CAAC,QAAQ,CAAC,CAAC;YAExD,sCAAsC;YACtC,MAAM,cAAc,GAAG,MAAM,IAAA,+BAAmB,EAAC,GAAG,OAAO,IAAI,CAAC,CAAC;YACjE,MAAM,CAAC,cAAc,CAAC,KAAK,CAAC,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;YACxC,MAAM,CAAC,cAAc,CAAC,YAAY,CAAC,CAAC,IAAI,CAAC,OAAO,CAAC,CAAC;YAClD,MAAM,CAAC,cAAc,CAAC,YAAY,CAAC,CAAC,GAAG,CAAC,OAAO,CAAC,QAAQ,CAAC,CAAC;QAAA,CAC3D,CAAC,CAAC;IAAA,CACJ,CAAC,CAAC;IAEH,QAAQ,CAAC,iBAAiB,EAAE,GAAG,EAAE,CAAC;QAChC,IAAI,OAAe,CAAC;QAEpB,UAAU,CAAC,GAAG,EAAE,CAAC;YACf,OAAO,GAAG,EAAE,CAAC,WAAW,CAAC,IAAI,CAAC,IAAI,CAAC,EAAE,CAAC,MAAM,EAAE,EAAE,eAAe,CAAC,CAAC,CAAC;QAAA,CACnE,CAAC,CAAC;QAEH,SAAS,CAAC,GAAG,EAAE,CAAC;YACd,EAAE,CAAC,MAAM,CAAC,OAAO,EAAE,EAAE,SAAS,EAAE,IAAI,EAAE,KAAK,EAAE,IAAI,EAAE,CAAC,CAAC;QAAA,CACtD,CAAC,CAAC;QAEH,EAAE,CAAC,2CAA2C,EAAE,KAAK,IAAI,EAAE,CAAC;YAC1D,MAAM,MAAM,GAAG,MAAM,IAAA,2BAAe,EAAC,OAAO,CAAC,CAAC;YAC9C,MAAM,CAAC,MAAM,CAAC,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC;QAAA,CAC5B,CAAC,CAAC;QAEH,EAAE,CAAC,sCAAsC,EAAE,KAAK,IAAI,EAAE,CAAC;YACrD,uEAAuE;YACvE,EAAE,CAAC,SAAS,CAAC,IAAI,CAAC,IAAI,CAAC,OAAO,EAAE,MAAM,CAAC,CAAC,CAAC;YACzC,MAAM,MAAM,GAAG,MAAM,IAAA,2BAAe,EAAC,OAAO,CAAC,CAAC;YAC9C,MAAM,CAAC,MAAM,CAAC,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;QAAA,CAC3B,CAAC,CAAC;IAAA,CACJ,CAAC,CAAC;AAAA,CACJ,CAAC,CAAC","sourcesContent":["import * as fs from \"fs\";\r\nimport * as os from \"os\";\r\nimport * as path from \"path\";\r\nimport { expandTilde, validateProjectPath, isGitRepository } from \"./pathUtils\";\r\n\r\ndescribe(\"pathUtils\", () => {\r\n  describe(\"expandTilde\", () => {\r\n    it(\"should expand ~ to home directory\", () => {\r\n      const result = expandTilde(\"~/Documents\");\r\n      const expected = path.join(os.homedir(), \"Documents\");\r\n      expect(result).toBe(expected);\r\n    });\r\n\r\n    it(\"should expand ~/ to home directory with trailing path\", () => {\r\n      const result = expandTilde(\"~/Projects/my-app\");\r\n      const expected = path.join(os.homedir(), \"Projects\", \"my-app\");\r\n      expect(result).toBe(expected);\r\n    });\r\n\r\n    it(\"should return path unchanged if it doesn't start with ~\", () => {\r\n      const testPath = \"/absolute/path/to/project\";\r\n      const result = expandTilde(testPath);\r\n      expect(result).toBe(testPath);\r\n    });\r\n\r\n    it(\"should handle ~ alone (home directory)\", () => {\r\n      const result = expandTilde(\"~\");\r\n      expect(result).toBe(os.homedir());\r\n    });\r\n\r\n    it(\"should handle relative paths without tilde\", () => {\r\n      const relativePath = \"relative/path\";\r\n      const result = expandTilde(relativePath);\r\n      expect(result).toBe(relativePath);\r\n    });\r\n\r\n    it(\"should handle empty string\", () => {\r\n      const result = expandTilde(\"\");\r\n      expect(result).toBe(\"\");\r\n    });\r\n  });\r\n\r\n  describe(\"validateProjectPath\", () => {\r\n    let tempDir: string;\r\n\r\n    beforeEach(() => {\r\n      // Create a temporary directory for testing\r\n      tempDir = fs.mkdtempSync(path.join(os.tmpdir(), \"mux-path-test-\"));\r\n    });\r\n\r\n    afterEach(() => {\r\n      // Clean up temporary directory\r\n      fs.rmSync(tempDir, { recursive: true, force: true });\r\n    });\r\n\r\n    it(\"should return success for existing git directory\", async () => {\r\n      // Create .git directory\r\n      // eslint-disable-next-line local/no-sync-fs-methods -- Test setup only\r\n      fs.mkdirSync(path.join(tempDir, \".git\"));\r\n      const result = await validateProjectPath(tempDir);\r\n      expect(result.valid).toBe(true);\r\n      expect(result.expandedPath).toBe(tempDir);\r\n      expect(result.error).toBeUndefined();\r\n    });\r\n\r\n    it(\"should expand tilde and validate\", async () => {\r\n      // Create a test directory in home with .git\r\n      const testDir = path.join(os.homedir(), `mux-test-git-${Date.now()}`);\r\n      // eslint-disable-next-line local/no-sync-fs-methods -- Test setup only\r\n      fs.mkdirSync(testDir, { recursive: true });\r\n      // eslint-disable-next-line local/no-sync-fs-methods -- Test setup only\r\n      fs.mkdirSync(path.join(testDir, \".git\"));\r\n\r\n      const result = await validateProjectPath(`~/${path.basename(testDir)}`);\r\n      expect(result.valid).toBe(true);\r\n      expect(result.expandedPath).toBe(testDir);\r\n      expect(result.error).toBeUndefined();\r\n\r\n      // Cleanup\r\n      fs.rmSync(testDir, { recursive: true, force: true });\r\n    });\r\n\r\n    it(\"should return error for non-existent path\", async () => {\r\n      const nonExistentPath = \"/this/path/definitely/does/not/exist/mux-test-12345\";\r\n      const result = await validateProjectPath(nonExistentPath);\r\n      expect(result.valid).toBe(false);\r\n      expect(result.error).toContain(\"does not exist\");\r\n    });\r\n\r\n    it(\"should return error for file path (not directory)\", async () => {\r\n      const filePath = path.join(tempDir, \"test-file.txt\");\r\n      // eslint-disable-next-line local/no-sync-fs-methods -- Test setup only\r\n      fs.writeFileSync(filePath, \"test content\");\r\n\r\n      const result = await validateProjectPath(filePath);\r\n      expect(result.valid).toBe(false);\r\n      expect(result.error).toContain(\"not a directory\");\r\n    });\r\n\r\n    it(\"should handle tilde path to non-existent directory\", async () => {\r\n      const nonExistentTildePath = \"~/this-directory-should-not-exist-mux-test-12345\";\r\n      const result = await validateProjectPath(nonExistentTildePath);\r\n      expect(result.valid).toBe(false);\r\n      expect(result.error).toContain(\"does not exist\");\r\n    });\r\n\r\n    it(\"should return normalized absolute path\", async () => {\r\n      const pathWithDots = path.join(tempDir, \"..\", path.basename(tempDir));\r\n      // Add .git directory for validation\r\n      // eslint-disable-next-line local/no-sync-fs-methods -- Test setup only\r\n      fs.mkdirSync(path.join(tempDir, \".git\"));\r\n      const result = await validateProjectPath(pathWithDots);\r\n      expect(result.valid).toBe(true);\r\n      expect(result.expandedPath).toBe(tempDir);\r\n    });\r\n\r\n    it(\"should accept directory without .git (non-git repos are valid)\", async () => {\r\n      const result = await validateProjectPath(tempDir);\r\n      expect(result.valid).toBe(true);\r\n      expect(result.expandedPath).toBe(tempDir);\r\n    });\r\n\r\n    it(\"should accept directory with .git\", async () => {\r\n      const gitDir = path.join(tempDir, \".git\");\r\n      // eslint-disable-next-line local/no-sync-fs-methods -- Test setup only\r\n      fs.mkdirSync(gitDir);\r\n\r\n      const result = await validateProjectPath(tempDir);\r\n      expect(result.valid).toBe(true);\r\n      expect(result.expandedPath).toBe(tempDir);\r\n    });\r\n\r\n    it(\"should strip trailing slashes from path\", async () => {\r\n      // Create .git directory for validation\r\n      // eslint-disable-next-line local/no-sync-fs-methods -- Test setup only\r\n      fs.mkdirSync(path.join(tempDir, \".git\"));\r\n\r\n      // Test with single trailing slash\r\n      const resultSingle = await validateProjectPath(`${tempDir}/`);\r\n      expect(resultSingle.valid).toBe(true);\r\n      expect(resultSingle.expandedPath).toBe(tempDir);\r\n      expect(resultSingle.expandedPath).not.toMatch(/[/\\\\]$/);\r\n\r\n      // Test with multiple trailing slashes\r\n      const resultMultiple = await validateProjectPath(`${tempDir}//`);\r\n      expect(resultMultiple.valid).toBe(true);\r\n      expect(resultMultiple.expandedPath).toBe(tempDir);\r\n      expect(resultMultiple.expandedPath).not.toMatch(/[/\\\\]$/);\r\n    });\r\n  });\r\n\r\n  describe(\"isGitRepository\", () => {\r\n    let tempDir: string;\r\n\r\n    beforeEach(() => {\r\n      tempDir = fs.mkdtempSync(path.join(os.tmpdir(), \"mux-git-test-\"));\r\n    });\r\n\r\n    afterEach(() => {\r\n      fs.rmSync(tempDir, { recursive: true, force: true });\r\n    });\r\n\r\n    it(\"should return false for non-git directory\", async () => {\r\n      const result = await isGitRepository(tempDir);\r\n      expect(result).toBe(false);\r\n    });\r\n\r\n    it(\"should return true for git directory\", async () => {\r\n      // eslint-disable-next-line local/no-sync-fs-methods -- Test setup only\r\n      fs.mkdirSync(path.join(tempDir, \".git\"));\r\n      const result = await isGitRepository(tempDir);\r\n      expect(result).toBe(true);\r\n    });\r\n  });\r\n});\r\n"]}