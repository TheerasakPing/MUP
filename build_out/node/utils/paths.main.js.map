{"version":3,"file":"paths.main.js","sourceRoot":"","sources":["../../../src/node/utils/paths.main.ts"],"names":[],"mappings":"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","sourcesContent":["/**\r\n * Platform-aware path utilities for main process (Node) only.\r\n * Safe to use Node globals like process and environment variables.\r\n *\r\n * NOTE: Renderer should import from './paths' (renderer-safe subset)\r\n * and use IPC for any operations that require environment access.\r\n */\r\n\r\nimport { platform, env } from \"node:process\";\r\n\r\nexport interface PathComponents {\r\n  root: string; // \"/\" on Unix, \"C:\\\\\" on Windows, \"\" for relative paths\r\n  segments: string[]; // Directory segments (excluding basename)\r\n  basename: string; // Final path component\r\n}\r\n\r\n/**\r\n * Determine if current platform is Windows (main process)\r\n */\r\nfunction isWindowsPlatform(): boolean {\r\n  return platform === \"win32\";\r\n}\r\n\r\nfunction getSeparator(): string {\r\n  return isWindowsPlatform() ? \"\\\\\" : \"/\";\r\n}\r\n\r\nfunction getHomeDir(): string {\r\n  if (isWindowsPlatform()) {\r\n    return env.USERPROFILE ?? \"\";\r\n  }\r\n\r\n  return env.HOME ?? \"\";\r\n}\r\n\r\n/**\r\n * OS-aware path utilities that handle Windows and Unix paths correctly.\r\n * Main-process version includes environment-aware helpers.\r\n */\r\nexport class PlatformPaths {\r\n  /**\r\n   * Get the appropriate path separator for the current platform\r\n   */\r\n  static get separator(): string {\r\n    return getSeparator();\r\n  }\r\n\r\n  /**\r\n   * Extract basename from path (OS-aware)\r\n   */\r\n  static basename(filePath: string): string {\r\n    if (!filePath || typeof filePath !== \"string\") {\r\n      return filePath;\r\n    }\r\n\r\n    const lastSlash = isWindowsPlatform()\r\n      ? Math.max(filePath.lastIndexOf(\"/\"), filePath.lastIndexOf(\"\\\\\"))\r\n      : filePath.lastIndexOf(\"/\");\r\n    if (lastSlash === -1) {\r\n      return filePath;\r\n    }\r\n    return filePath.slice(lastSlash + 1);\r\n  }\r\n\r\n  /**\r\n   * Split path into components (OS-aware)\r\n   */\r\n  static parse(filePath: string): PathComponents {\r\n    if (!filePath || typeof filePath !== \"string\") {\r\n      return { root: \"\", segments: [], basename: filePath };\r\n    }\r\n\r\n    const original = filePath;\r\n    let root = \"\";\r\n    let dir = \"\";\r\n    let base = \"\";\r\n\r\n    // Determine basename and directory\r\n    const lastSlash = isWindowsPlatform()\r\n      ? Math.max(original.lastIndexOf(\"/\"), original.lastIndexOf(\"\\\\\"))\r\n      : original.lastIndexOf(\"/\");\r\n    if (lastSlash === -1) {\r\n      base = original;\r\n      dir = \"\";\r\n    } else {\r\n      base = original.slice(lastSlash + 1);\r\n      dir = original.slice(0, lastSlash);\r\n    }\r\n\r\n    // Determine root\r\n    if (isWindowsPlatform()) {\r\n      const driveMatch = /^[A-Za-z]:[\\\\/]/.exec(original);\r\n      if (driveMatch) {\r\n        root = driveMatch[0];\r\n        // Ensure dir does not include root\r\n        if (dir.startsWith(root)) {\r\n          dir = dir.slice(root.length);\r\n        }\r\n      } else if (original.startsWith(\"\\\\\\\\\")) {\r\n        // UNC paths - treat leading double-backslash as root\r\n        root = \"\\\\\\\\\";\r\n        if (dir.startsWith(root)) {\r\n          dir = dir.slice(root.length);\r\n        }\r\n      }\r\n      // Also treat Unix-style absolute paths as absolute even on Windows\r\n      if (!root && original.startsWith(\"/\")) {\r\n        root = \"/\";\r\n        if (dir.startsWith(root)) {\r\n          dir = dir.slice(root.length);\r\n        }\r\n      }\r\n    } else if (original.startsWith(\"/\")) {\r\n      root = \"/\";\r\n      if (dir.startsWith(root)) {\r\n        dir = dir.slice(root.length);\r\n      }\r\n    }\r\n\r\n    const separatorRegex = isWindowsPlatform() ? /[\\\\/]+/ : /\\/+/;\r\n    const segments = dir ? dir.split(separatorRegex).filter(Boolean) : [];\r\n\r\n    return {\r\n      root,\r\n      segments,\r\n      basename: base,\r\n    };\r\n  }\r\n\r\n  /**\r\n   * Format path for display with fish-style abbreviation (OS-aware)\r\n   * Abbreviates all directory components except the last one to their first letter\r\n   */\r\n  static abbreviate(filePath: string): string {\r\n    if (!filePath || typeof filePath !== \"string\") {\r\n      return filePath;\r\n    }\r\n\r\n    const { root, segments, basename } = this.parse(filePath);\r\n\r\n    // Abbreviate all segments to first character\r\n    const abbreviated = segments.map((seg) => (seg.length > 0 ? seg[0] : seg));\r\n\r\n    // Reconstruct path - handle root separately to avoid double separator\r\n    if (!root && abbreviated.length === 0) {\r\n      return basename;\r\n    }\r\n\r\n    const sep = isWindowsPlatform() ? (filePath.includes(\"\\\\\") ? \"\\\\\" : \"/\") : \"/\";\r\n    const joined = [...abbreviated, basename].filter(Boolean).join(sep);\r\n    if (!root) {\r\n      return joined;\r\n    }\r\n    const rootEndsWithSep = root.endsWith(\"\\\\\") || root.endsWith(\"/\");\r\n    return rootEndsWithSep ? root + joined : root + sep + joined;\r\n  }\r\n\r\n  /**\r\n   * Split an abbreviated path into directory path and basename\r\n   */\r\n  static splitAbbreviated(filePath: string): { dirPath: string; basename: string } {\r\n    if (!filePath || typeof filePath !== \"string\") {\r\n      return { dirPath: \"\", basename: filePath };\r\n    }\r\n\r\n    const sep = isWindowsPlatform() ? (filePath.includes(\"\\\\\") ? \"\\\\\" : \"/\") : \"/\";\r\n    const lastSlash = filePath.lastIndexOf(sep);\r\n    if (lastSlash === -1) {\r\n      return { dirPath: \"\", basename: filePath };\r\n    }\r\n    return {\r\n      dirPath: filePath.slice(0, lastSlash + 1),\r\n      basename: filePath.slice(lastSlash + 1),\r\n    };\r\n  }\r\n\r\n  /**\r\n   * Format home directory path for display (shows ~ on Unix, full path on Windows)\r\n   */\r\n  static formatHome(filePath: string): string {\r\n    if (!filePath || typeof filePath !== \"string\") {\r\n      return filePath;\r\n    }\r\n\r\n    const home = getHomeDir();\r\n    if (!home) {\r\n      return filePath;\r\n    }\r\n\r\n    // Replace home with tilde on all platforms for display purposes\r\n    if (filePath.startsWith(home)) {\r\n      return filePath.replace(home, \"~\");\r\n    }\r\n\r\n    return filePath;\r\n  }\r\n\r\n  /**\r\n   * Expand user home in path (cross-platform)\r\n   * Handles ~ on Unix and %USERPROFILE% on Windows\r\n   */\r\n  static expandHome(filePath: string): string {\r\n    if (!filePath || typeof filePath !== \"string\") {\r\n      return filePath;\r\n    }\r\n\r\n    // In tests and other isolated environments, mux can be configured to store all\r\n    // state under a custom root via MUX_ROOT. We also allow runtime config paths\r\n    // like \"~/.mux/src\" (portable, works for both local + SSH) to resolve to that\r\n    // root when MUX_ROOT is set.\r\n    const muxRoot = env.MUX_ROOT;\r\n    if (muxRoot) {\r\n      const normalizedMuxRoot = muxRoot.replace(/[\\\\/]+$/g, \"\");\r\n      const sep = getSeparator();\r\n      const prefixes = [\"~/.mux\", \"~\\\\.mux\"] as const;\r\n      for (const prefix of prefixes) {\r\n        if (filePath === prefix) {\r\n          return normalizedMuxRoot;\r\n        }\r\n\r\n        const slashPrefix = `${prefix}/`;\r\n        const backslashPrefix = `${prefix}\\\\`;\r\n        if (filePath.startsWith(slashPrefix) || filePath.startsWith(backslashPrefix)) {\r\n          const rest = filePath.slice(prefix.length + 1);\r\n          const normalizedRest = rest.replace(/[\\\\/]+/g, sep);\r\n          return normalizedMuxRoot + (normalizedRest ? sep + normalizedRest : \"\");\r\n        }\r\n      }\r\n    }\r\n\r\n    if (filePath === \"~\") {\r\n      return getHomeDir() || filePath;\r\n    }\r\n\r\n    // Handle Unix-style ~/path\r\n    if (filePath.startsWith(\"~/\") || filePath.startsWith(\"~\\\\\")) {\r\n      const home = getHomeDir();\r\n      if (!home) return filePath;\r\n      const sep = getSeparator();\r\n      const rest = filePath.slice(2);\r\n      return home + (rest ? sep + rest.replace(/[\\\\/]+/g, sep) : \"\");\r\n    }\r\n\r\n    // Handle Windows %USERPROFILE% environment variable\r\n    if (isWindowsPlatform() && filePath.includes(\"%USERPROFILE%\")) {\r\n      const home = getHomeDir();\r\n      if (!home) return filePath;\r\n      return filePath.replace(/%USERPROFILE%/g, home);\r\n    }\r\n\r\n    return filePath;\r\n  }\r\n\r\n  /**\r\n   * Get project name from path (OS-aware)\r\n   * Extracts the final directory name from a project path\r\n   */\r\n  static getProjectName(projectPath: string): string {\r\n    return this.basename(projectPath) || \"unknown\";\r\n  }\r\n}\r\n"]}