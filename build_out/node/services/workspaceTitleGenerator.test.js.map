{"version":3,"file":"workspaceTitleGenerator.test.js","sourceRoot":"","sources":["../../../src/node/services/workspaceTitleGenerator.test.ts"],"names":[],"mappings":"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","sourcesContent":["import { describe, expect, test } from \"bun:test\";\r\nimport { extractIdentityFromText } from \"./workspaceTitleGenerator\";\r\n\r\ndescribe(\"extractIdentityFromText\", () => {\r\n  test(\"extracts from markdown bold + backtick format\", () => {\r\n    const text = [\r\n      'Based on the development task \"testing\", here are my recommendations:',\r\n      \"\",\r\n      \"**name:** `testing`\",\r\n      \"- Concise, git-safe (lowercase), and clearly identifies the codebase area\",\r\n      \"\",\r\n      \"**title:** `Improve test coverage`\",\r\n      \"- Follows the verb-noun format and describes the testing work generically\",\r\n    ].join(\"\\n\");\r\n\r\n    const result = extractIdentityFromText(text);\r\n    expect(result).toEqual({ name: \"testing\", title: \"Improve test coverage\" });\r\n  });\r\n\r\n  test(\"extracts from embedded JSON object\", () => {\r\n    const text =\r\n      'Here is the result: {\"name\": \"sidebar\", \"title\": \"Fix sidebar layout\"} as requested.';\r\n    const result = extractIdentityFromText(text);\r\n    expect(result).toEqual({ name: \"sidebar\", title: \"Fix sidebar layout\" });\r\n  });\r\n\r\n  test(\"extracts from JSON with reverse field order\", () => {\r\n    const text = '{\"title\": \"Add user auth\", \"name\": \"auth\"}';\r\n    const result = extractIdentityFromText(text);\r\n    expect(result).toEqual({ name: \"auth\", title: \"Add user auth\" });\r\n  });\r\n\r\n  test(\"extracts from quoted values in prose\", () => {\r\n    const text = 'The name: \"config\" and title: \"Refactor config loading\"';\r\n    const result = extractIdentityFromText(text);\r\n    expect(result).toEqual({ name: \"config\", title: \"Refactor config loading\" });\r\n  });\r\n\r\n  test(\"sanitizes name to be git-safe\", () => {\r\n    const text = [\"**name:** `My Feature`\", \"**title:** `Add cool feature`\"].join(\"\\n\");\r\n    const result = extractIdentityFromText(text);\r\n    expect(result).toEqual({ name: \"my-feature\", title: \"Add cool feature\" });\r\n  });\r\n\r\n  test(\"returns null for empty text\", () => {\r\n    expect(extractIdentityFromText(\"\")).toBeNull();\r\n  });\r\n\r\n  test(\"returns null when only name is present\", () => {\r\n    const text = \"**name:** `testing`\\nSome other content without title\";\r\n    expect(extractIdentityFromText(text)).toBeNull();\r\n  });\r\n\r\n  test(\"returns null when only title is present\", () => {\r\n    const text = \"**title:** `Fix bugs`\\nSome other content without name\";\r\n    expect(extractIdentityFromText(text)).toBeNull();\r\n  });\r\n\r\n  test(\"returns null when name is too short after sanitization\", () => {\r\n    const text = \"**name:** `-`\\n**title:** `Fix something here`\";\r\n    expect(extractIdentityFromText(text)).toBeNull();\r\n  });\r\n\r\n  test(\"returns null when title is too short\", () => {\r\n    const text = \"**name:** `auth`\\n**title:** `Fix`\";\r\n    expect(extractIdentityFromText(text)).toBeNull();\r\n  });\r\n\r\n  test(\"returns null for completely unrelated text\", () => {\r\n    const text = \"I'm sorry, I cannot help with that request. Please try again.\";\r\n    expect(extractIdentityFromText(text)).toBeNull();\r\n  });\r\n\r\n  test(\"handles the exact failing response from the bug report\", () => {\r\n    // This is the exact text content from the claude-haiku response that triggered the bug.\r\n    // In the raw API response JSON, newlines are escaped as \\n â€” once parsed they become\r\n    // real newline characters in the string that NoObjectGeneratedError.text carries.\r\n    const text = [\r\n      'Based on the development task \"testing\", here are my recommendations:',\r\n      \"\",\r\n      \"**name:** `testing`\",\r\n      \"- Concise, git-safe (lowercase), and clearly identifies the codebase area\",\r\n      \"\",\r\n      \"**title:** `Improve test coverage`\",\r\n      \"- Follows the verb-noun format and describes the testing work generically\",\r\n      \"\",\r\n      \"These are suitable for a testing-focused development task.\",\r\n    ].join(\"\\n\");\r\n\r\n    const result = extractIdentityFromText(text);\r\n    expect(result).toEqual({ name: \"testing\", title: \"Improve test coverage\" });\r\n  });\r\n});\r\n"]}