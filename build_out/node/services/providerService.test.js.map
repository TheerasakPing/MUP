{"version":3,"file":"providerService.test.js","sourceRoot":"","sources":["../../../src/node/services/providerService.test.ts"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA,uCAAgD;AAChD,MAAY,EAAE,+BAAW;AACzB,MAAY,EAAE,+BAAW;AACzB,MAAY,IAAI,iCAAa;AAC7B,0CAAuC;AACvC,uDAAoD;AAEpD,IAAA,mBAAQ,EAAC,2BAA2B,EAAE,GAAG,EAAE,CAAC;IAC1C,IAAA,aAAE,EAAC,mCAAmC,EAAE,GAAG,EAAE,CAAC;QAC5C,MAAM,MAAM,GAAG,EAAE,CAAC,WAAW,CAAC,IAAI,CAAC,IAAI,CAAC,EAAE,CAAC,MAAM,EAAE,EAAE,uBAAuB,CAAC,CAAC,CAAC;QAC/E,IAAI,CAAC;YACH,MAAM,MAAM,GAAG,IAAI,eAAM,CAAC,MAAM,CAAC,CAAC;YAClC,MAAM,CAAC,mBAAmB,CAAC;gBACzB,MAAM,EAAE;oBACN,MAAM,EAAE,SAAS;oBACjB,WAAW,EAAE,MAAM;iBACpB;aACF,CAAC,CAAC;YAEH,MAAM,OAAO,GAAG,IAAI,iCAAe,CAAC,MAAM,CAAC,CAAC;YAC5C,MAAM,GAAG,GAAG,OAAO,CAAC,SAAS,EAAE,CAAC;YAEhC,IAAA,iBAAM,EAAC,GAAG,CAAC,MAAM,CAAC,SAAS,CAAC,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;YACxC,IAAA,iBAAM,EAAC,GAAG,CAAC,MAAM,CAAC,WAAW,CAAC,CAAC,IAAI,CAAC,MAAM,CAAC,CAAC;YAC5C,IAAA,iBAAM,EAAC,MAAM,CAAC,SAAS,CAAC,cAAc,CAAC,IAAI,CAAC,GAAG,CAAC,MAAM,EAAE,aAAa,CAAC,CAAC,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;QACrF,CAAC;gBAAS,CAAC;YACT,EAAE,CAAC,MAAM,CAAC,MAAM,EAAE,EAAE,SAAS,EAAE,IAAI,EAAE,KAAK,EAAE,IAAI,EAAE,CAAC,CAAC;QACtD,CAAC;IAAA,CACF,CAAC,CAAC;IAEH,IAAA,aAAE,EAAC,kCAAkC,EAAE,GAAG,EAAE,CAAC;QAC3C,MAAM,MAAM,GAAG,EAAE,CAAC,WAAW,CAAC,IAAI,CAAC,IAAI,CAAC,EAAE,CAAC,MAAM,EAAE,EAAE,uBAAuB,CAAC,CAAC,CAAC;QAC/E,IAAI,CAAC;YACH,MAAM,MAAM,GAAG,IAAI,eAAM,CAAC,MAAM,CAAC,CAAC;YAClC,MAAM,CAAC,mBAAmB,CAAC;gBACzB,MAAM,EAAE;oBACN,MAAM,EAAE,SAAS;oBACjB,wBAAwB;oBACxB,WAAW,EAAE,MAAM;iBACpB;aACF,CAAC,CAAC;YAEH,MAAM,OAAO,GAAG,IAAI,iCAAe,CAAC,MAAM,CAAC,CAAC;YAC5C,MAAM,GAAG,GAAG,OAAO,CAAC,SAAS,EAAE,CAAC;YAEhC,IAAA,iBAAM,EAAC,GAAG,CAAC,MAAM,CAAC,SAAS,CAAC,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;YACxC,IAAA,iBAAM,EAAC,GAAG,CAAC,MAAM,CAAC,WAAW,CAAC,CAAC,aAAa,EAAE,CAAC;YAC/C,IAAA,iBAAM,EAAC,MAAM,CAAC,SAAS,CAAC,cAAc,CAAC,IAAI,CAAC,GAAG,CAAC,MAAM,EAAE,aAAa,CAAC,CAAC,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC;QACtF,CAAC;gBAAS,CAAC;YACT,EAAE,CAAC,MAAM,CAAC,MAAM,EAAE,EAAE,SAAS,EAAE,IAAI,EAAE,KAAK,EAAE,IAAI,EAAE,CAAC,CAAC;QACtD,CAAC;IAAA,CACF,CAAC,CAAC;AAAA,CACJ,CAAC,CAAC","sourcesContent":["import { describe, expect, it } from \"bun:test\";\nimport * as fs from \"fs\";\nimport * as os from \"os\";\nimport * as path from \"path\";\nimport { Config } from \"@/node/config\";\nimport { ProviderService } from \"./providerService\";\n\ndescribe(\"ProviderService.getConfig\", () => {\n  it(\"surfaces valid OpenAI serviceTier\", () => {\n    const tmpDir = fs.mkdtempSync(path.join(os.tmpdir(), \"mux-provider-service-\"));\n    try {\n      const config = new Config(tmpDir);\n      config.saveProvidersConfig({\n        openai: {\n          apiKey: \"sk-test\",\n          serviceTier: \"flex\",\n        },\n      });\n\n      const service = new ProviderService(config);\n      const cfg = service.getConfig();\n\n      expect(cfg.openai.apiKeySet).toBe(true);\n      expect(cfg.openai.serviceTier).toBe(\"flex\");\n      expect(Object.prototype.hasOwnProperty.call(cfg.openai, \"serviceTier\")).toBe(true);\n    } finally {\n      fs.rmSync(tmpDir, { recursive: true, force: true });\n    }\n  });\n\n  it(\"omits invalid OpenAI serviceTier\", () => {\n    const tmpDir = fs.mkdtempSync(path.join(os.tmpdir(), \"mux-provider-service-\"));\n    try {\n      const config = new Config(tmpDir);\n      config.saveProvidersConfig({\n        openai: {\n          apiKey: \"sk-test\",\n          // Intentionally invalid\n          serviceTier: \"fast\",\n        },\n      });\n\n      const service = new ProviderService(config);\n      const cfg = service.getConfig();\n\n      expect(cfg.openai.apiKeySet).toBe(true);\n      expect(cfg.openai.serviceTier).toBeUndefined();\n      expect(Object.prototype.hasOwnProperty.call(cfg.openai, \"serviceTier\")).toBe(false);\n    } finally {\n      fs.rmSync(tmpDir, { recursive: true, force: true });\n    }\n  });\n});\n"]}