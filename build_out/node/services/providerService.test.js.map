{"version":3,"file":"providerService.test.js","sourceRoot":"","sources":["../../../src/node/services/providerService.test.ts"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA,uCAAgD;AAChD,MAAY,EAAE,+BAAW;AACzB,MAAY,EAAE,+BAAW;AACzB,MAAY,IAAI,iCAAa;AAC7B,0CAAuC;AACvC,uDAAoD;AAEpD,IAAA,mBAAQ,EAAC,2BAA2B,EAAE,GAAG,EAAE,CAAC;IAC1C,IAAA,aAAE,EAAC,mCAAmC,EAAE,GAAG,EAAE,CAAC;QAC5C,MAAM,MAAM,GAAG,EAAE,CAAC,WAAW,CAAC,IAAI,CAAC,IAAI,CAAC,EAAE,CAAC,MAAM,EAAE,EAAE,uBAAuB,CAAC,CAAC,CAAC;QAC/E,IAAI,CAAC;YACH,MAAM,MAAM,GAAG,IAAI,eAAM,CAAC,MAAM,CAAC,CAAC;YAClC,MAAM,CAAC,mBAAmB,CAAC;gBACzB,MAAM,EAAE;oBACN,MAAM,EAAE,SAAS;oBACjB,WAAW,EAAE,MAAM;iBACpB;aACF,CAAC,CAAC;YAEH,MAAM,OAAO,GAAG,IAAI,iCAAe,CAAC,MAAM,CAAC,CAAC;YAC5C,MAAM,GAAG,GAAG,OAAO,CAAC,SAAS,EAAE,CAAC;YAEhC,IAAA,iBAAM,EAAC,GAAG,CAAC,MAAM,CAAC,SAAS,CAAC,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;YACxC,IAAA,iBAAM,EAAC,GAAG,CAAC,MAAM,CAAC,WAAW,CAAC,CAAC,IAAI,CAAC,MAAM,CAAC,CAAC;YAC5C,IAAA,iBAAM,EAAC,MAAM,CAAC,SAAS,CAAC,cAAc,CAAC,IAAI,CAAC,GAAG,CAAC,MAAM,EAAE,aAAa,CAAC,CAAC,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;QACrF,CAAC;gBAAS,CAAC;YACT,EAAE,CAAC,MAAM,CAAC,MAAM,EAAE,EAAE,SAAS,EAAE,IAAI,EAAE,KAAK,EAAE,IAAI,EAAE,CAAC,CAAC;QACtD,CAAC;IAAA,CACF,CAAC,CAAC;IAEH,IAAA,aAAE,EAAC,kCAAkC,EAAE,GAAG,EAAE,CAAC;QAC3C,MAAM,MAAM,GAAG,EAAE,CAAC,WAAW,CAAC,IAAI,CAAC,IAAI,CAAC,EAAE,CAAC,MAAM,EAAE,EAAE,uBAAuB,CAAC,CAAC,CAAC;QAC/E,IAAI,CAAC;YACH,MAAM,MAAM,GAAG,IAAI,eAAM,CAAC,MAAM,CAAC,CAAC;YAClC,MAAM,CAAC,mBAAmB,CAAC;gBACzB,MAAM,EAAE;oBACN,MAAM,EAAE,SAAS;oBACjB,wBAAwB;oBACxB,WAAW,EAAE,MAAM;iBACpB;aACF,CAAC,CAAC;YAEH,MAAM,OAAO,GAAG,IAAI,iCAAe,CAAC,MAAM,CAAC,CAAC;YAC5C,MAAM,GAAG,GAAG,OAAO,CAAC,SAAS,EAAE,CAAC;YAEhC,IAAA,iBAAM,EAAC,GAAG,CAAC,MAAM,CAAC,SAAS,CAAC,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;YACxC,IAAA,iBAAM,EAAC,GAAG,CAAC,MAAM,CAAC,WAAW,CAAC,CAAC,aAAa,EAAE,CAAC;YAC/C,IAAA,iBAAM,EAAC,MAAM,CAAC,SAAS,CAAC,cAAc,CAAC,IAAI,CAAC,GAAG,CAAC,MAAM,EAAE,aAAa,CAAC,CAAC,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC;QACtF,CAAC;gBAAS,CAAC;YACT,EAAE,CAAC,MAAM,CAAC,MAAM,EAAE,EAAE,SAAS,EAAE,IAAI,EAAE,KAAK,EAAE,IAAI,EAAE,CAAC,CAAC;QACtD,CAAC;IAAA,CACF,CAAC,CAAC;AAAA,CACJ,CAAC,CAAC","sourcesContent":["import { describe, expect, it } from \"bun:test\";\r\nimport * as fs from \"fs\";\r\nimport * as os from \"os\";\r\nimport * as path from \"path\";\r\nimport { Config } from \"@/node/config\";\r\nimport { ProviderService } from \"./providerService\";\r\n\r\ndescribe(\"ProviderService.getConfig\", () => {\r\n  it(\"surfaces valid OpenAI serviceTier\", () => {\r\n    const tmpDir = fs.mkdtempSync(path.join(os.tmpdir(), \"mux-provider-service-\"));\r\n    try {\r\n      const config = new Config(tmpDir);\r\n      config.saveProvidersConfig({\r\n        openai: {\r\n          apiKey: \"sk-test\",\r\n          serviceTier: \"flex\",\r\n        },\r\n      });\r\n\r\n      const service = new ProviderService(config);\r\n      const cfg = service.getConfig();\r\n\r\n      expect(cfg.openai.apiKeySet).toBe(true);\r\n      expect(cfg.openai.serviceTier).toBe(\"flex\");\r\n      expect(Object.prototype.hasOwnProperty.call(cfg.openai, \"serviceTier\")).toBe(true);\r\n    } finally {\r\n      fs.rmSync(tmpDir, { recursive: true, force: true });\r\n    }\r\n  });\r\n\r\n  it(\"omits invalid OpenAI serviceTier\", () => {\r\n    const tmpDir = fs.mkdtempSync(path.join(os.tmpdir(), \"mux-provider-service-\"));\r\n    try {\r\n      const config = new Config(tmpDir);\r\n      config.saveProvidersConfig({\r\n        openai: {\r\n          apiKey: \"sk-test\",\r\n          // Intentionally invalid\r\n          serviceTier: \"fast\",\r\n        },\r\n      });\r\n\r\n      const service = new ProviderService(config);\r\n      const cfg = service.getConfig();\r\n\r\n      expect(cfg.openai.apiKeySet).toBe(true);\r\n      expect(cfg.openai.serviceTier).toBeUndefined();\r\n      expect(Object.prototype.hasOwnProperty.call(cfg.openai, \"serviceTier\")).toBe(false);\r\n    } finally {\r\n      fs.rmSync(tmpDir, { recursive: true, force: true });\r\n    }\r\n  });\r\n});\r\n"]}