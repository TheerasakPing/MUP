{"version":3,"file":"tempDir.js","sourceRoot":"","sources":["../../../src/node/services/tempDir.ts"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA,MAAY,EAAE,+BAAW;AACzB,MAAY,IAAI,iCAAa;AAC7B,MAAY,EAAE,+BAAW;AACzB,6CAA0C;AAE1C;;;GAGG;AACH;IACkB,IAAI,CAAS;IAE7B,YAAY,MAAM,GAAG,UAAU,EAAE;QAC/B,+BAA+B;QAC/B,MAAM,EAAE,GAAG,IAAI,CAAC,MAAM,EAAE,CAAC,QAAQ,CAAC,EAAE,CAAC,CAAC,SAAS,CAAC,CAAC,EAAE,EAAE,CAAC,CAAC;QACvD,IAAI,CAAC,IAAI,GAAG,IAAI,CAAC,IAAI,CAAC,EAAE,CAAC,MAAM,EAAE,EAAE,GAAG,MAAM,IAAI,EAAE,EAAE,CAAC,CAAC;QACtD,EAAE,CAAC,SAAS,CAAC,IAAI,CAAC,IAAI,EAAE,EAAE,SAAS,EAAE,IAAI,EAAE,IAAI,EAAE,KAAK,EAAE,CAAC,CAAC;IAAA,CAC3D;IAED,CAAC,MAAM,CAAC,OAAO,CAAC,GAAS;QACvB,0BAA0B;QAC1B,IAAI,EAAE,CAAC,UAAU,CAAC,IAAI,CAAC,IAAI,CAAC,EAAE,CAAC;YAC7B,IAAI,CAAC;gBACH,EAAE,CAAC,MAAM,CAAC,IAAI,CAAC,IAAI,EAAE,EAAE,SAAS,EAAE,IAAI,EAAE,KAAK,EAAE,IAAI,EAAE,CAAC,CAAC;YACzD,CAAC;YAAC,OAAO,KAAK,EAAE,CAAC;gBACf,SAAG,CAAC,IAAI,CAAC,8BAA8B,IAAI,CAAC,IAAI,GAAG,EAAE,KAAK,CAAC,CAAC;gBAC5D,uCAAuC;YACzC,CAAC;QACH,CAAC;IAAA,CACF;CACF","sourcesContent":["import * as fs from \"fs\";\r\nimport * as path from \"path\";\r\nimport * as os from \"os\";\r\nimport { log } from \"@/node/services/log\";\r\n\r\n/**\r\n * Disposable temporary directory that auto-cleans when disposed\r\n * Use with `using` statement for automatic cleanup\r\n */\r\nexport class DisposableTempDir implements Disposable {\r\n  public readonly path: string;\r\n\r\n  constructor(prefix = \"mux-temp\") {\r\n    // Create unique temp directory\r\n    const id = Math.random().toString(16).substring(2, 10);\r\n    this.path = path.join(os.tmpdir(), `${prefix}-${id}`);\r\n    fs.mkdirSync(this.path, { recursive: true, mode: 0o700 });\r\n  }\r\n\r\n  [Symbol.dispose](): void {\r\n    // Clean up temp directory\r\n    if (fs.existsSync(this.path)) {\r\n      try {\r\n        fs.rmSync(this.path, { recursive: true, force: true });\r\n      } catch (error) {\r\n        log.warn(`Failed to cleanup temp dir ${this.path}:`, error);\r\n        // Don't throw - cleanup is best-effort\r\n      }\r\n    }\r\n  }\r\n}\r\n"]}