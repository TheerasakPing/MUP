{"version":3,"file":"coderService.test.js","sourceRoot":"","sources":["../../../src/node/services/coderService.test.ts"],"names":[],"mappings":"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","sourcesContent":["import { EventEmitter } from \"events\";\nimport { Readable } from \"stream\";\nimport { describe, it, expect, vi, beforeEach, afterEach, spyOn } from \"bun:test\";\nimport { CoderService, compareVersions } from \"./coderService\";\nimport * as childProcess from \"child_process\";\nimport * as disposableExec from \"@/node/utils/disposableExec\";\n\n// eslint-disable-next-line @typescript-eslint/no-empty-function\nconst noop = () => {};\n\n/**\n * Mock execAsync for non-streaming tests.\n * Uses spyOn instead of vi.mock to avoid polluting other test files.\n */\nlet execAsyncSpy: ReturnType<typeof spyOn<typeof disposableExec, \"execAsync\">> | null = null;\n\n// Minimal mock that satisfies the interface used by CoderService\n// Uses cast via `unknown` because we only implement the subset actually used by tests\nfunction createMockExecResult(\n  result: Promise<{ stdout: string; stderr: string }>\n): ReturnType<typeof disposableExec.execAsync> {\n  const mock = {\n    result,\n    get promise() {\n      return result;\n    },\n    child: {}, // not used by CoderService\n    [Symbol.dispose]: noop,\n  };\n  return mock as unknown as ReturnType<typeof disposableExec.execAsync>;\n}\n\nfunction mockExecOk(stdout: string, stderr = \"\"): void {\n  execAsyncSpy?.mockReturnValue(createMockExecResult(Promise.resolve({ stdout, stderr })));\n}\n\nfunction mockExecError(error: Error): void {\n  execAsyncSpy?.mockReturnValue(createMockExecResult(Promise.reject(error)));\n}\n\nfunction mockVersionAndWhoami(options: { version: string; username?: string }): void {\n  execAsyncSpy?.mockImplementationOnce(() =>\n    createMockExecResult(Promise.resolve({ stdout: \"/usr/local/bin/coder\\n\", stderr: \"\" }))\n  );\n  execAsyncSpy?.mockImplementationOnce(() =>\n    createMockExecResult(\n      Promise.resolve({ stdout: JSON.stringify({ version: options.version }), stderr: \"\" })\n    )\n  );\n  const whoamiPayload = {\n    url: \"https://coder.example.com\",\n    ...(options.username ? { username: options.username } : {}),\n  };\n  execAsyncSpy?.mockImplementationOnce(() =>\n    createMockExecResult(Promise.resolve({ stdout: JSON.stringify([whoamiPayload]), stderr: \"\" }))\n  );\n}\n\n/**\n * Mock spawn for streaming createWorkspace() tests.\n * Uses spyOn instead of vi.mock to avoid polluting other test files.\n */\nlet spawnSpy: ReturnType<typeof spyOn<typeof childProcess, \"spawn\">> | null = null;\n\nfunction mockCoderCommandResult(options: {\n  stdout?: string;\n  stderr?: string;\n  exitCode: number;\n}): void {\n  const stdout = Readable.from(options.stdout ? [Buffer.from(options.stdout)] : []);\n  const stderr = Readable.from(options.stderr ? [Buffer.from(options.stderr)] : []);\n  const events = new EventEmitter();\n\n  spawnSpy?.mockReturnValue({\n    stdout,\n    stderr,\n    exitCode: null,\n    signalCode: null,\n    kill: vi.fn(),\n    on: events.on.bind(events),\n    removeListener: events.removeListener.bind(events),\n  } as never);\n\n  // Emit close after handlers are attached.\n  setTimeout(() => events.emit(\"close\", options.exitCode), 0);\n}\n\ndescribe(\"CoderService\", () => {\n  let service: CoderService;\n\n  beforeEach(() => {\n    service = new CoderService();\n    vi.clearAllMocks();\n    // Set up spies for mocking - uses spyOn instead of vi.mock to avoid polluting other test files\n    execAsyncSpy = spyOn(disposableExec, \"execAsync\");\n    spawnSpy = spyOn(childProcess, \"spawn\");\n  });\n\n  afterEach(() => {\n    service.clearCache();\n    execAsyncSpy?.mockRestore();\n    execAsyncSpy = null;\n    spawnSpy?.mockRestore();\n    spawnSpy = null;\n  });\n\n  describe(\"getCoderInfo\", () => {\n    it(\"returns available state with valid version\", async () => {\n      mockVersionAndWhoami({ version: \"2.28.2\", username: \"coder-user\" });\n\n      const info = await service.getCoderInfo();\n\n      expect(info).toEqual({\n        state: \"available\",\n        version: \"2.28.2\",\n        username: \"coder-user\",\n        url: \"https://coder.example.com\",\n      });\n    });\n\n    it(\"returns available state for exact minimum version\", async () => {\n      mockVersionAndWhoami({ version: \"2.25.0\", username: \"coder-user\" });\n\n      const info = await service.getCoderInfo();\n\n      expect(info).toEqual({\n        state: \"available\",\n        version: \"2.25.0\",\n        username: \"coder-user\",\n        url: \"https://coder.example.com\",\n      });\n    });\n\n    it(\"returns outdated state for version below minimum\", async () => {\n      execAsyncSpy?.mockImplementationOnce(() =>\n        createMockExecResult(Promise.resolve({ stdout: \"/usr/local/bin/coder\\n\", stderr: \"\" }))\n      );\n      execAsyncSpy?.mockImplementationOnce(() =>\n        createMockExecResult(\n          Promise.resolve({ stdout: JSON.stringify({ version: \"2.24.9\" }), stderr: \"\" })\n        )\n      );\n\n      const info = await service.getCoderInfo();\n\n      expect(info).toEqual({\n        state: \"outdated\",\n        version: \"2.24.9\",\n        minVersion: \"2.25.0\",\n        binaryPath: \"/usr/local/bin/coder\",\n      });\n    });\n\n    it(\"returns outdated state without binaryPath when lookup fails\", async () => {\n      execAsyncSpy?.mockImplementationOnce(() =>\n        createMockExecResult(Promise.reject(new Error(\"lookup failed\")))\n      );\n      execAsyncSpy?.mockImplementationOnce(() =>\n        createMockExecResult(\n          Promise.resolve({ stdout: JSON.stringify({ version: \"2.24.9\" }), stderr: \"\" })\n        )\n      );\n\n      const info = await service.getCoderInfo();\n\n      expect(info).toEqual({ state: \"outdated\", version: \"2.24.9\", minVersion: \"2.25.0\" });\n    });\n    it(\"handles version with dev suffix\", async () => {\n      mockVersionAndWhoami({\n        version: \"2.28.2-devel+903c045b9\",\n        username: \"coder-user\",\n      });\n\n      const info = await service.getCoderInfo();\n\n      expect(info).toEqual({\n        state: \"available\",\n        version: \"2.28.2-devel+903c045b9\",\n        username: \"coder-user\",\n        url: \"https://coder.example.com\",\n      });\n    });\n\n    it(\"returns unavailable state with not-logged-in reason when whoami fails\", async () => {\n      execAsyncSpy?.mockImplementationOnce(() =>\n        createMockExecResult(Promise.resolve({ stdout: \"/usr/local/bin/coder\\n\", stderr: \"\" }))\n      );\n      execAsyncSpy?.mockImplementationOnce(() =>\n        createMockExecResult(\n          Promise.resolve({ stdout: JSON.stringify({ version: \"2.28.2\" }), stderr: \"\" })\n        )\n      );\n      execAsyncSpy?.mockImplementationOnce(() =>\n        createMockExecResult(\n          Promise.reject(\n            new Error(\n              `Encountered an error running \"coder whoami\", see \"coder whoami --help\" for more information\\nerror: You are not logged in. Try logging in using 'coder login <url>'.`\n            )\n          )\n        )\n      );\n\n      const info = await service.getCoderInfo();\n\n      expect(info).toMatchObject({\n        state: \"unavailable\",\n        reason: { kind: \"not-logged-in\" },\n      });\n\n      if (\n        info.state !== \"unavailable\" ||\n        typeof info.reason === \"string\" ||\n        info.reason.kind !== \"not-logged-in\"\n      ) {\n        throw new Error(`Expected not-logged-in unavailable state, got: ${JSON.stringify(info)}`);\n      }\n\n      expect(info.reason.message).toContain(\"/usr/local/bin/coder\");\n      expect(info.reason.message.toLowerCase()).toContain(\"not logged in\");\n    });\n\n    it(\"re-checks whoami after transient failure (does not cache error state)\", async () => {\n      // First call: whoami transient error\n      execAsyncSpy?.mockImplementationOnce(() =>\n        createMockExecResult(Promise.resolve({ stdout: \"/usr/local/bin/coder\\n\", stderr: \"\" }))\n      );\n      execAsyncSpy?.mockImplementationOnce(() =>\n        createMockExecResult(\n          Promise.resolve({ stdout: JSON.stringify({ version: \"2.28.2\" }), stderr: \"\" })\n        )\n      );\n      execAsyncSpy?.mockImplementationOnce(() =>\n        createMockExecResult(Promise.reject(new Error(\"error: Connection refused\")))\n      );\n\n      // Second call: should try again (previous error must not be cached)\n      execAsyncSpy?.mockImplementationOnce(() =>\n        createMockExecResult(Promise.resolve({ stdout: \"/usr/local/bin/coder\\n\", stderr: \"\" }))\n      );\n      execAsyncSpy?.mockImplementationOnce(() =>\n        createMockExecResult(\n          Promise.resolve({ stdout: JSON.stringify({ version: \"2.28.2\" }), stderr: \"\" })\n        )\n      );\n      execAsyncSpy?.mockImplementationOnce(() =>\n        createMockExecResult(Promise.reject(new Error(\"error: Connection refused\")))\n      );\n\n      const first = await service.getCoderInfo();\n      expect(first).toMatchObject({ state: \"unavailable\", reason: { kind: \"error\" } });\n\n      if (\n        first.state !== \"unavailable\" ||\n        typeof first.reason === \"string\" ||\n        first.reason.kind !== \"error\"\n      ) {\n        throw new Error(`Expected unavailable error state, got: ${JSON.stringify(first)}`);\n      }\n\n      expect(first.reason.message.toLowerCase()).toContain(\"connection refused\");\n\n      const second = await service.getCoderInfo();\n      expect(second).toMatchObject({ state: \"unavailable\", reason: { kind: \"error\" } });\n\n      const cmds = execAsyncSpy?.mock.calls.map(([cmd]) => cmd) ?? [];\n      expect(cmds.filter((c) => c === \"coder whoami --output=json\")).toHaveLength(2);\n    });\n\n    it(\"re-checks login status after not-logged-in and caches once logged in\", async () => {\n      // First call: not logged in\n      execAsyncSpy?.mockImplementationOnce(() =>\n        createMockExecResult(Promise.resolve({ stdout: \"/usr/local/bin/coder\\n\", stderr: \"\" }))\n      );\n      execAsyncSpy?.mockImplementationOnce(() =>\n        createMockExecResult(\n          Promise.resolve({ stdout: JSON.stringify({ version: \"2.28.2\" }), stderr: \"\" })\n        )\n      );\n      execAsyncSpy?.mockImplementationOnce(() =>\n        createMockExecResult(\n          Promise.reject(\n            new Error(\n              `Encountered an error running \"coder whoami\", see \"coder whoami --help\" for more information\\nerror: You are not logged in. Try logging in using 'coder login <url>'.`\n            )\n          )\n        )\n      );\n\n      // Second call: now logged in\n      mockVersionAndWhoami({ version: \"2.28.2\", username: \"coder-user\" });\n\n      const first = await service.getCoderInfo();\n      expect(first).toMatchObject({\n        state: \"unavailable\",\n        reason: { kind: \"not-logged-in\" },\n      });\n\n      if (\n        first.state !== \"unavailable\" ||\n        typeof first.reason === \"string\" ||\n        first.reason.kind !== \"not-logged-in\"\n      ) {\n        throw new Error(`Expected not-logged-in unavailable state, got: ${JSON.stringify(first)}`);\n      }\n\n      expect(first.reason.message).toContain(\"/usr/local/bin/coder\");\n      expect(first.reason.message.toLowerCase()).toContain(\"not logged in\");\n\n      const second = await service.getCoderInfo();\n      expect(second).toEqual({\n        state: \"available\",\n        version: \"2.28.2\",\n        username: \"coder-user\",\n        url: \"https://coder.example.com\",\n      });\n\n      const callsAfterSecond = execAsyncSpy?.mock.calls.length ?? 0;\n\n      // Third call should come from cache (no extra execAsync calls)\n      await service.getCoderInfo();\n      expect(execAsyncSpy?.mock.calls.length ?? 0).toBe(callsAfterSecond);\n\n      const cmds = execAsyncSpy?.mock.calls.map(([cmd]) => cmd) ?? [];\n      expect(cmds.filter((c) => c === \"coder whoami --output=json\")).toHaveLength(2);\n    });\n\n    it(\"returns unavailable state with reason missing when CLI not installed\", async () => {\n      mockExecError(new Error(\"command not found: coder\"));\n\n      const info = await service.getCoderInfo();\n\n      expect(info).toEqual({ state: \"unavailable\", reason: \"missing\" });\n    });\n\n    it(\"returns unavailable state with error reason for other errors\", async () => {\n      mockExecError(new Error(\"Connection refused\"));\n\n      const info = await service.getCoderInfo();\n\n      expect(info).toEqual({\n        state: \"unavailable\",\n        reason: { kind: \"error\", message: \"Connection refused\" },\n      });\n    });\n\n    it(\"returns unavailable state with error when version is missing from output\", async () => {\n      mockExecOk(JSON.stringify({}));\n\n      const info = await service.getCoderInfo();\n\n      expect(info).toEqual({\n        state: \"unavailable\",\n        reason: { kind: \"error\", message: \"Version output missing from CLI\" },\n      });\n    });\n\n    it(\"caches the result\", async () => {\n      mockVersionAndWhoami({ version: \"2.28.2\", username: \"coder-user\" });\n\n      await service.getCoderInfo();\n      await service.getCoderInfo();\n\n      expect(execAsyncSpy).toHaveBeenCalledTimes(3);\n    });\n  });\n\n  describe(\"listTemplates\", () => {\n    it(\"returns templates with display names\", async () => {\n      execAsyncSpy?.mockReturnValue(\n        createMockExecResult(\n          Promise.resolve({\n            stdout: JSON.stringify([\n              {\n                Template: {\n                  name: \"template-1\",\n                  display_name: \"Template One\",\n                  organization_name: \"org1\",\n                },\n              },\n              { Template: { name: \"template-2\", display_name: \"Template Two\" } },\n            ]),\n            stderr: \"\",\n          })\n        )\n      );\n\n      const templates = await service.listTemplates();\n\n      expect(templates).toEqual({\n        ok: true,\n        templates: [\n          { name: \"template-1\", displayName: \"Template One\", organizationName: \"org1\" },\n          { name: \"template-2\", displayName: \"Template Two\", organizationName: \"default\" },\n        ],\n      });\n    });\n\n    it(\"uses name as displayName when display_name not present\", async () => {\n      execAsyncSpy?.mockReturnValue(\n        createMockExecResult(\n          Promise.resolve({\n            stdout: JSON.stringify([{ Template: { name: \"my-template\" } }]),\n            stderr: \"\",\n          })\n        )\n      );\n\n      const templates = await service.listTemplates();\n\n      expect(templates).toEqual({\n        ok: true,\n        templates: [\n          { name: \"my-template\", displayName: \"my-template\", organizationName: \"default\" },\n        ],\n      });\n    });\n\n    it(\"returns error result on error\", async () => {\n      mockExecError(new Error(\"not logged in\"));\n\n      const templates = await service.listTemplates();\n\n      expect(templates).toEqual({ ok: false, error: \"not logged in\" });\n    });\n\n    it(\"returns empty array for empty output\", async () => {\n      mockExecOk(\"\");\n\n      const templates = await service.listTemplates();\n\n      expect(templates).toEqual({ ok: true, templates: [] });\n    });\n  });\n\n  describe(\"listPresets\", () => {\n    it(\"returns presets for a template\", async () => {\n      mockExecOk(\n        JSON.stringify([\n          {\n            TemplatePreset: {\n              ID: \"preset-1\",\n              Name: \"Small\",\n              Description: \"Small instance\",\n              Default: true,\n            },\n          },\n          {\n            TemplatePreset: {\n              ID: \"preset-2\",\n              Name: \"Large\",\n              Description: \"Large instance\",\n            },\n          },\n        ])\n      );\n\n      const presets = await service.listPresets(\"my-template\");\n\n      expect(presets).toEqual({\n        ok: true,\n        presets: [\n          { id: \"preset-1\", name: \"Small\", description: \"Small instance\", isDefault: true },\n          { id: \"preset-2\", name: \"Large\", description: \"Large instance\", isDefault: false },\n        ],\n      });\n    });\n\n    it(\"returns empty array when template has no presets\", async () => {\n      mockExecOk(\"\");\n\n      const presets = await service.listPresets(\"no-presets-template\");\n\n      expect(presets).toEqual({ ok: true, presets: [] });\n    });\n\n    it(\"returns empty array when CLI prints info message instead of JSON\", async () => {\n      mockExecOk('No presets found for template \"my-template\" and template-version \"v1\".\\n');\n\n      const presets = await service.listPresets(\"my-template\");\n\n      expect(presets).toEqual({ ok: true, presets: [] });\n    });\n\n    it(\"returns error result on error\", async () => {\n      mockExecError(new Error(\"template not found\"));\n\n      const presets = await service.listPresets(\"nonexistent\");\n\n      expect(presets).toEqual({ ok: false, error: \"template not found\" });\n    });\n  });\n\n  describe(\"listWorkspaces\", () => {\n    it(\"returns all workspaces regardless of status\", async () => {\n      mockExecOk(\n        JSON.stringify([\n          {\n            name: \"ws-1\",\n            template_name: \"t1\",\n            template_display_name: \"t1\",\n            latest_build: { status: \"running\" },\n          },\n          {\n            name: \"ws-2\",\n            template_name: \"t2\",\n            template_display_name: \"t2\",\n            latest_build: { status: \"stopped\" },\n          },\n          {\n            name: \"ws-3\",\n            template_name: \"t3\",\n            template_display_name: \"t3\",\n            latest_build: { status: \"starting\" },\n          },\n        ])\n      );\n\n      const workspaces = await service.listWorkspaces();\n\n      expect(workspaces).toEqual({\n        ok: true,\n        workspaces: [\n          { name: \"ws-1\", templateName: \"t1\", templateDisplayName: \"t1\", status: \"running\" },\n          { name: \"ws-2\", templateName: \"t2\", templateDisplayName: \"t2\", status: \"stopped\" },\n          { name: \"ws-3\", templateName: \"t3\", templateDisplayName: \"t3\", status: \"starting\" },\n        ],\n      });\n    });\n\n    it(\"returns error result on failure\", async () => {\n      mockExecError(\n        new Error(\n          `Encountered an error running \"coder list\", see \"coder list --help\" for more information\\nerror: You are not logged in. Try logging in using '/usr/local/bin/coder login <url>'.`\n        )\n      );\n\n      const workspaces = await service.listWorkspaces();\n\n      expect(workspaces).toEqual({\n        ok: false,\n        error: \"You are not logged in. Try logging in using '/usr/local/bin/coder login <url>'.\",\n      });\n    });\n  });\n\n  describe(\"workspaceExists\", () => {\n    it(\"returns true when exact match is found in search results\", async () => {\n      mockExecOk(JSON.stringify([{ name: \"ws-1\" }, { name: \"ws-10\" }]));\n\n      const exists = await service.workspaceExists(\"ws-1\");\n\n      expect(exists).toBe(true);\n    });\n\n    it(\"returns false when only prefix matches\", async () => {\n      mockExecOk(JSON.stringify([{ name: \"ws-10\" }]));\n\n      const exists = await service.workspaceExists(\"ws-1\");\n\n      expect(exists).toBe(false);\n    });\n\n    it(\"returns false on CLI error\", async () => {\n      mockExecError(new Error(\"not logged in\"));\n\n      const exists = await service.workspaceExists(\"ws-1\");\n\n      expect(exists).toBe(false);\n    });\n  });\n\n  describe(\"getWorkspaceStatus\", () => {\n    it(\"returns status for exact match (search is prefix-based)\", async () => {\n      mockCoderCommandResult({\n        exitCode: 0,\n        stdout: JSON.stringify([\n          { name: \"ws-1\", latest_build: { status: \"running\" } },\n          { name: \"ws-10\", latest_build: { status: \"stopped\" } },\n        ]),\n      });\n\n      const result = await service.getWorkspaceStatus(\"ws-1\");\n\n      expect(result.kind).toBe(\"ok\");\n      if (result.kind === \"ok\") {\n        expect(result.status).toBe(\"running\");\n      }\n    });\n\n    it(\"returns not_found when only prefix matches\", async () => {\n      mockCoderCommandResult({\n        exitCode: 0,\n        stdout: JSON.stringify([{ name: \"ws-10\", latest_build: { status: \"running\" } }]),\n      });\n\n      const result = await service.getWorkspaceStatus(\"ws-1\");\n\n      expect(result.kind).toBe(\"not_found\");\n    });\n\n    it(\"returns error for unknown workspace status\", async () => {\n      mockCoderCommandResult({\n        exitCode: 0,\n        stdout: JSON.stringify([{ name: \"ws-1\", latest_build: { status: \"weird\" } }]),\n      });\n\n      const result = await service.getWorkspaceStatus(\"ws-1\");\n\n      expect(result.kind).toBe(\"error\");\n      if (result.kind === \"error\") {\n        expect(result.error).toContain(\"Unknown status\");\n      }\n    });\n  });\n\n  describe(\"waitForStartupScripts\", () => {\n    it(\"streams stdout/stderr lines while waiting\", async () => {\n      const stdout = Readable.from([Buffer.from(\"Waiting for agent...\\nAgent ready\\n\")]);\n      const stderr = Readable.from([]);\n      const events = new EventEmitter();\n\n      spawnSpy!.mockReturnValue({\n        stdout,\n        stderr,\n        kill: vi.fn(),\n        on: events.on.bind(events),\n      } as never);\n\n      setTimeout(() => events.emit(\"close\", 0), 0);\n\n      const lines: string[] = [];\n      for await (const line of service.waitForStartupScripts(\"my-ws\")) {\n        lines.push(line);\n      }\n\n      expect(lines).toContain(\"$ coder ssh my-ws --wait=yes -- true\");\n      expect(lines).toContain(\"Waiting for agent...\");\n      expect(lines).toContain(\"Agent ready\");\n      expect(spawnSpy).toHaveBeenCalledWith(\"coder\", [\"ssh\", \"my-ws\", \"--wait=yes\", \"--\", \"true\"], {\n        stdio: [\"ignore\", \"pipe\", \"pipe\"],\n      });\n    });\n\n    it(\"throws when exit code is non-zero\", async () => {\n      const stdout = Readable.from([]);\n      const stderr = Readable.from([Buffer.from(\"Connection refused\\n\")]);\n      const events = new EventEmitter();\n\n      spawnSpy!.mockReturnValue({\n        stdout,\n        stderr,\n        kill: vi.fn(),\n        on: events.on.bind(events),\n      } as never);\n\n      setTimeout(() => events.emit(\"close\", 1), 0);\n\n      const lines: string[] = [];\n      const run = async () => {\n        for await (const line of service.waitForStartupScripts(\"my-ws\")) {\n          lines.push(line);\n        }\n      };\n\n      let thrown: unknown;\n      try {\n        await run();\n      } catch (error) {\n        thrown = error;\n      }\n\n      expect(thrown).toBeTruthy();\n      expect(thrown instanceof Error ? thrown.message : String(thrown)).toBe(\n        \"coder ssh --wait failed (exit 1): Connection refused\"\n      );\n    });\n  });\n\n  describe(\"fetchDeploymentSshConfig\", () => {\n    let originalFetch: typeof fetch;\n\n    beforeEach(() => {\n      originalFetch = global.fetch;\n    });\n\n    afterEach(() => {\n      global.fetch = originalFetch;\n    });\n\n    function mockWhoami() {\n      execAsyncSpy?.mockImplementation((cmd: string) => {\n        if (cmd === \"coder whoami --output=json\") {\n          return createMockExecResult(\n            Promise.resolve({\n              stdout: JSON.stringify([\n                { url: \"https://coder.example.com\", username: \"coder-user\" },\n              ]),\n              stderr: \"\",\n            })\n          );\n        }\n        return createMockExecResult(Promise.reject(new Error(`Unexpected command: ${cmd}`)));\n      });\n    }\n\n    it(\"uses provided session and normalizes leading dot\", async () => {\n      mockWhoami();\n      const fetchSpy = vi.fn().mockResolvedValue({\n        ok: true,\n        json: () => Promise.resolve({ hostname_suffix: \".corp\" }),\n      });\n      global.fetch = fetchSpy as unknown as typeof fetch;\n\n      const session = {\n        token: \"session-token\",\n        dispose: vi.fn().mockResolvedValue(undefined),\n      };\n      const result = await service.fetchDeploymentSshConfig(session);\n\n      expect(result).toEqual({ hostnameSuffix: \"corp\" });\n      const calledUrl = fetchSpy.mock.calls[0]?.[0] as URL | undefined;\n      const options = fetchSpy.mock.calls[0]?.[1] as RequestInit | undefined;\n      expect(calledUrl?.toString()).toBe(\"https://coder.example.com/api/v2/deployment/ssh\");\n      expect(options).toEqual({\n        headers: { \"Coder-Session-Token\": \"session-token\" },\n      });\n      expect(execAsyncSpy).toHaveBeenCalledTimes(1);\n    });\n\n    it(\"reuses cached whoami after getCoderInfo\", async () => {\n      mockVersionAndWhoami({ version: \"2.28.2\", username: \"coder-user\" });\n      execAsyncSpy?.mockImplementation((cmd: string) =>\n        createMockExecResult(Promise.reject(new Error(`Unexpected command: ${cmd}`)))\n      );\n      const fetchSpy = vi.fn().mockResolvedValue({\n        ok: true,\n        json: () => Promise.resolve({ hostname_suffix: \".corp\" }),\n      });\n      global.fetch = fetchSpy as unknown as typeof fetch;\n\n      await service.getCoderInfo();\n\n      const session = {\n        token: \"session-token\",\n        dispose: vi.fn().mockResolvedValue(undefined),\n      };\n      await service.fetchDeploymentSshConfig(session);\n\n      expect(execAsyncSpy).toHaveBeenCalledTimes(3);\n      const whoamiCalls =\n        execAsyncSpy?.mock.calls.filter(([cmd]) => cmd === \"coder whoami --output=json\") ?? [];\n      expect(whoamiCalls).toHaveLength(1);\n    });\n\n    it(\"defaults to coder when hostname suffix missing\", async () => {\n      mockWhoami();\n      const fetchSpy = vi.fn().mockResolvedValue({\n        ok: true,\n        json: () => Promise.resolve({}),\n      });\n      global.fetch = fetchSpy as unknown as typeof fetch;\n\n      const session = {\n        token: \"session-token\",\n        dispose: vi.fn().mockResolvedValue(undefined),\n      };\n      const result = await service.fetchDeploymentSshConfig(session);\n\n      expect(result).toEqual({ hostnameSuffix: \"coder\" });\n    });\n  });\n\n  describe(\"provisioning sessions\", () => {\n    function mockTokenCommands() {\n      execAsyncSpy?.mockImplementation((cmd: string) => {\n        if (cmd.startsWith(\"coder tokens create --lifetime 5m --name\")) {\n          return createMockExecResult(Promise.resolve({ stdout: \"token-123\", stderr: \"\" }));\n        }\n        if (cmd.startsWith(\"coder tokens delete\")) {\n          return createMockExecResult(Promise.resolve({ stdout: \"\", stderr: \"\" }));\n        }\n        return createMockExecResult(Promise.reject(new Error(`Unexpected command: ${cmd}`)));\n      });\n    }\n\n    it(\"reuses provisioning sessions for the same workspace\", async () => {\n      mockTokenCommands();\n      const session1 = await service.ensureProvisioningSession(\"ws\");\n      const session2 = await service.ensureProvisioningSession(\"ws\");\n\n      expect(session1).toBe(session2);\n      expect(session1.token).toBe(\"token-123\");\n\n      await service.disposeProvisioningSession(\"ws\");\n      expect(execAsyncSpy).toHaveBeenCalledTimes(2);\n    });\n\n    it(\"takeProvisioningSession returns and clears the session\", async () => {\n      mockTokenCommands();\n      const session = await service.ensureProvisioningSession(\"ws\");\n      const taken = service.takeProvisioningSession(\"ws\");\n\n      expect(taken).toBe(session);\n      expect(service.takeProvisioningSession(\"ws\")).toBeUndefined();\n\n      await taken?.dispose();\n      expect(execAsyncSpy).toHaveBeenCalledTimes(2);\n    });\n  });\n\n  describe(\"createWorkspace\", () => {\n    // Capture original fetch once per describe block to avoid nested mock issues\n    let originalFetch: typeof fetch;\n\n    beforeEach(() => {\n      originalFetch = global.fetch;\n    });\n\n    afterEach(() => {\n      global.fetch = originalFetch;\n    });\n\n    // Helper to mock the pre-fetch calls that happen before spawn\n    function mockPrefetchCalls(options?: { presetParamNames?: string[] }) {\n      // Mock getDeploymentUrl (coder whoami)\n      // Mock getActiveTemplateVersionId (coder templates list)\n      // Mock getPresetParamNames (coder templates presets list)\n      // Mock getTemplateRichParameters (coder tokens create + fetch)\n      execAsyncSpy?.mockImplementation((cmd: string) => {\n        if (cmd === \"coder whoami --output=json\") {\n          return createMockExecResult(\n            Promise.resolve({\n              stdout: JSON.stringify([\n                { url: \"https://coder.example.com\", username: \"coder-user\" },\n              ]),\n              stderr: \"\",\n            })\n          );\n        }\n        if (cmd === \"coder templates list --output=json\") {\n          return createMockExecResult(\n            Promise.resolve({\n              stdout: JSON.stringify([\n                { Template: { name: \"my-template\", active_version_id: \"version-123\" } },\n                { Template: { name: \"tmpl\", active_version_id: \"version-456\" } },\n              ]),\n              stderr: \"\",\n            })\n          );\n        }\n        if (cmd.startsWith(\"coder templates presets list\")) {\n          const paramNames = options?.presetParamNames ?? [];\n          return createMockExecResult(\n            Promise.resolve({\n              stdout: JSON.stringify([\n                {\n                  TemplatePreset: {\n                    Name: \"preset\",\n                    Parameters: paramNames.map((name) => ({ Name: name })),\n                  },\n                },\n              ]),\n              stderr: \"\",\n            })\n          );\n        }\n        if (cmd.startsWith(\"coder tokens create --lifetime 5m --name\")) {\n          return createMockExecResult(Promise.resolve({ stdout: \"fake-token-123\", stderr: \"\" }));\n        }\n        if (cmd.startsWith(\"coder tokens delete\")) {\n          return createMockExecResult(Promise.resolve({ stdout: \"\", stderr: \"\" }));\n        }\n        // Fallback for any other command\n        return createMockExecResult(Promise.reject(new Error(`Unexpected command: ${cmd}`)));\n      });\n    }\n\n    // Helper to mock fetch for rich parameters API\n    function mockFetchRichParams(\n      params: Array<{\n        name: string;\n        default_value: string;\n        ephemeral?: boolean;\n        required?: boolean;\n      }>\n    ) {\n      global.fetch = vi.fn().mockResolvedValue({\n        ok: true,\n        json: () => Promise.resolve(params),\n      }) as unknown as typeof fetch;\n    }\n\n    it(\"streams stdout/stderr lines and passes expected args\", async () => {\n      mockPrefetchCalls();\n      mockFetchRichParams([]);\n\n      const stdout = Readable.from([Buffer.from(\"out-1\\nout-2\\n\")]);\n      const stderr = Readable.from([Buffer.from(\"err-1\\n\")]);\n      const events = new EventEmitter();\n\n      spawnSpy!.mockReturnValue({\n        stdout,\n        stderr,\n        kill: vi.fn(),\n        on: events.on.bind(events),\n      } as never);\n\n      // Emit close after handlers are attached.\n      setTimeout(() => events.emit(\"close\", 0), 0);\n\n      const lines: string[] = [];\n      for await (const line of service.createWorkspace(\"my-workspace\", \"my-template\")) {\n        lines.push(line);\n      }\n\n      expect(spawnSpy).toHaveBeenCalledWith(\n        \"coder\",\n        [\"create\", \"my-workspace\", \"-t\", \"my-template\", \"--yes\"],\n        { stdio: [\"ignore\", \"pipe\", \"pipe\"] }\n      );\n\n      // First line is the command, rest are stdout/stderr\n      expect(lines[0]).toBe(\"$ coder create my-workspace -t my-template --yes\");\n      expect(lines.slice(1).sort()).toEqual([\"err-1\", \"out-1\", \"out-2\"]);\n    });\n\n    it(\"includes --preset when provided\", async () => {\n      mockPrefetchCalls({ presetParamNames: [\"covered-param\"] });\n      mockFetchRichParams([{ name: \"covered-param\", default_value: \"val\" }]);\n\n      const stdout = Readable.from([]);\n      const stderr = Readable.from([]);\n      const events = new EventEmitter();\n\n      spawnSpy!.mockReturnValue({\n        stdout,\n        stderr,\n        kill: vi.fn(),\n        on: events.on.bind(events),\n      } as never);\n\n      setTimeout(() => events.emit(\"close\", 0), 0);\n\n      for await (const _line of service.createWorkspace(\"ws\", \"tmpl\", \"preset\")) {\n        // drain\n      }\n\n      expect(spawnSpy).toHaveBeenCalledWith(\n        \"coder\",\n        [\"create\", \"ws\", \"-t\", \"tmpl\", \"--yes\", \"--preset\", \"preset\"],\n        { stdio: [\"ignore\", \"pipe\", \"pipe\"] }\n      );\n    });\n\n    it(\"includes --parameter flags for uncovered non-ephemeral params\", async () => {\n      mockPrefetchCalls({ presetParamNames: [\"covered-param\"] });\n      mockFetchRichParams([\n        { name: \"covered-param\", default_value: \"val1\" },\n        { name: \"uncovered-param\", default_value: \"val2\" },\n        { name: \"ephemeral-param\", default_value: \"val3\", ephemeral: true },\n      ]);\n\n      const stdout = Readable.from([]);\n      const stderr = Readable.from([]);\n      const events = new EventEmitter();\n\n      spawnSpy!.mockReturnValue({\n        stdout,\n        stderr,\n        kill: vi.fn(),\n        on: events.on.bind(events),\n      } as never);\n\n      setTimeout(() => events.emit(\"close\", 0), 0);\n\n      for await (const _line of service.createWorkspace(\"ws\", \"tmpl\", \"preset\")) {\n        // drain\n      }\n\n      expect(spawnSpy).toHaveBeenCalledWith(\n        \"coder\",\n        [\n          \"create\",\n          \"ws\",\n          \"-t\",\n          \"tmpl\",\n          \"--yes\",\n          \"--preset\",\n          \"preset\",\n          \"--parameter\",\n          \"uncovered-param=val2\",\n        ],\n        { stdio: [\"ignore\", \"pipe\", \"pipe\"] }\n      );\n    });\n\n    it(\"throws when exit code is non-zero\", async () => {\n      mockPrefetchCalls();\n      mockFetchRichParams([]);\n\n      const stdout = Readable.from([]);\n      const stderr = Readable.from([]);\n      const events = new EventEmitter();\n\n      spawnSpy!.mockReturnValue({\n        stdout,\n        stderr,\n        kill: vi.fn(),\n        on: events.on.bind(events),\n      } as never);\n\n      setTimeout(() => events.emit(\"close\", 42), 0);\n\n      let thrown: unknown;\n      try {\n        for await (const _line of service.createWorkspace(\"ws\", \"tmpl\")) {\n          // drain\n        }\n      } catch (error) {\n        thrown = error;\n      }\n\n      expect(thrown).toBeTruthy();\n      expect(thrown instanceof Error ? thrown.message : String(thrown)).toContain(\n        \"coder create failed (exit 42)\"\n      );\n    });\n\n    it(\"aborts before spawn when already aborted\", async () => {\n      const abortController = new AbortController();\n      abortController.abort();\n\n      let thrown: unknown;\n      try {\n        for await (const _line of service.createWorkspace(\n          \"ws\",\n          \"tmpl\",\n          undefined,\n          abortController.signal\n        )) {\n          // drain\n        }\n      } catch (error) {\n        thrown = error;\n      }\n\n      expect(thrown).toBeTruthy();\n      expect(thrown instanceof Error ? thrown.message : String(thrown)).toContain(\"aborted\");\n    });\n\n    it(\"throws when required param has no default and is not covered by preset\", async () => {\n      mockPrefetchCalls({ presetParamNames: [] });\n      mockFetchRichParams([{ name: \"required-param\", default_value: \"\", required: true }]);\n\n      let thrown: unknown;\n      try {\n        for await (const _line of service.createWorkspace(\"ws\", \"tmpl\")) {\n          // drain\n        }\n      } catch (error) {\n        thrown = error;\n      }\n\n      expect(thrown).toBeTruthy();\n      expect(thrown instanceof Error ? thrown.message : String(thrown)).toContain(\"required-param\");\n    });\n  });\n});\n\ndescribe(\"computeExtraParams\", () => {\n  let service: CoderService;\n\n  beforeEach(() => {\n    service = new CoderService();\n  });\n\n  it(\"returns empty array when all params are covered by preset\", () => {\n    const params = [\n      { name: \"param1\", defaultValue: \"val1\", type: \"string\", ephemeral: false, required: false },\n      { name: \"param2\", defaultValue: \"val2\", type: \"string\", ephemeral: false, required: false },\n    ];\n    const covered = new Set([\"param1\", \"param2\"]);\n\n    expect(service.computeExtraParams(params, covered)).toEqual([]);\n  });\n\n  it(\"returns uncovered non-ephemeral params with defaults\", () => {\n    const params = [\n      { name: \"covered\", defaultValue: \"val1\", type: \"string\", ephemeral: false, required: false },\n      {\n        name: \"uncovered\",\n        defaultValue: \"val2\",\n        type: \"string\",\n        ephemeral: false,\n        required: false,\n      },\n    ];\n    const covered = new Set([\"covered\"]);\n\n    expect(service.computeExtraParams(params, covered)).toEqual([\n      { name: \"uncovered\", encoded: \"uncovered=val2\" },\n    ]);\n  });\n\n  it(\"excludes ephemeral params\", () => {\n    const params = [\n      { name: \"normal\", defaultValue: \"val1\", type: \"string\", ephemeral: false, required: false },\n      { name: \"ephemeral\", defaultValue: \"val2\", type: \"string\", ephemeral: true, required: false },\n    ];\n    const covered = new Set<string>();\n\n    expect(service.computeExtraParams(params, covered)).toEqual([\n      { name: \"normal\", encoded: \"normal=val1\" },\n    ]);\n  });\n\n  it(\"includes params with empty default values\", () => {\n    const params = [\n      {\n        name: \"empty-default\",\n        defaultValue: \"\",\n        type: \"string\",\n        ephemeral: false,\n        required: false,\n      },\n    ];\n    const covered = new Set<string>();\n\n    expect(service.computeExtraParams(params, covered)).toEqual([\n      { name: \"empty-default\", encoded: \"empty-default=\" },\n    ]);\n  });\n\n  it(\"CSV-encodes list(string) values containing quotes\", () => {\n    const params = [\n      {\n        name: \"Select IDEs\",\n        defaultValue: '[\"vscode\",\"code-server\",\"cursor\"]',\n        type: \"list(string)\",\n        ephemeral: false,\n        required: false,\n      },\n    ];\n    const covered = new Set<string>();\n\n    // CLI uses CSV parsing, so quotes need escaping: \" -> \"\"\n    expect(service.computeExtraParams(params, covered)).toEqual([\n      { name: \"Select IDEs\", encoded: '\"Select IDEs=[\"\"vscode\"\",\"\"code-server\"\",\"\"cursor\"\"]\"' },\n    ]);\n  });\n\n  it(\"passes empty list(string) array without CSV encoding\", () => {\n    const params = [\n      {\n        name: \"empty-list\",\n        defaultValue: \"[]\",\n        type: \"list(string)\",\n        ephemeral: false,\n        required: false,\n      },\n    ];\n    const covered = new Set<string>();\n\n    // No quotes or commas, so no encoding needed\n    expect(service.computeExtraParams(params, covered)).toEqual([\n      { name: \"empty-list\", encoded: \"empty-list=[]\" },\n    ]);\n  });\n});\n\ndescribe(\"validateRequiredParams\", () => {\n  let service: CoderService;\n\n  beforeEach(() => {\n    service = new CoderService();\n  });\n\n  it(\"does not throw when all required params have defaults\", () => {\n    const params = [\n      {\n        name: \"required-with-default\",\n        defaultValue: \"val\",\n        type: \"string\",\n        ephemeral: false,\n        required: true,\n      },\n    ];\n    const covered = new Set<string>();\n\n    expect(() => service.validateRequiredParams(params, covered)).not.toThrow();\n  });\n\n  it(\"does not throw when required params are covered by preset\", () => {\n    const params = [\n      {\n        name: \"required-no-default\",\n        defaultValue: \"\",\n        type: \"string\",\n        ephemeral: false,\n        required: true,\n      },\n    ];\n    const covered = new Set([\"required-no-default\"]);\n\n    expect(() => service.validateRequiredParams(params, covered)).not.toThrow();\n  });\n\n  it(\"throws when required param has no default and is not covered\", () => {\n    const params = [\n      { name: \"missing-param\", defaultValue: \"\", type: \"string\", ephemeral: false, required: true },\n    ];\n    const covered = new Set<string>();\n\n    expect(() => service.validateRequiredParams(params, covered)).toThrow(\"missing-param\");\n  });\n\n  it(\"ignores ephemeral required params\", () => {\n    const params = [\n      {\n        name: \"ephemeral-required\",\n        defaultValue: \"\",\n        type: \"string\",\n        ephemeral: true,\n        required: true,\n      },\n    ];\n    const covered = new Set<string>();\n\n    expect(() => service.validateRequiredParams(params, covered)).not.toThrow();\n  });\n\n  it(\"lists all missing required params in error\", () => {\n    const params = [\n      { name: \"missing1\", defaultValue: \"\", type: \"string\", ephemeral: false, required: true },\n      { name: \"missing2\", defaultValue: \"\", type: \"string\", ephemeral: false, required: true },\n    ];\n    const covered = new Set<string>();\n\n    expect(() => service.validateRequiredParams(params, covered)).toThrow(\n      /missing1.*missing2|missing2.*missing1/\n    );\n  });\n});\n\ndescribe(\"non-string parameter defaults\", () => {\n  let service: CoderService;\n\n  beforeEach(() => {\n    service = new CoderService();\n  });\n\n  it(\"validateRequiredParams passes when required param has numeric default 0\", () => {\n    // After parseRichParameters, numeric 0 becomes \"0\" (not \"\")\n    const params = [\n      { name: \"count\", defaultValue: \"0\", type: \"number\", ephemeral: false, required: true },\n    ];\n    const covered = new Set<string>();\n\n    expect(() => service.validateRequiredParams(params, covered)).not.toThrow();\n  });\n\n  it(\"validateRequiredParams passes when required param has boolean default false\", () => {\n    // After parseRichParameters, boolean false becomes \"false\" (not \"\")\n    const params = [\n      { name: \"enabled\", defaultValue: \"false\", type: \"bool\", ephemeral: false, required: true },\n    ];\n    const covered = new Set<string>();\n\n    expect(() => service.validateRequiredParams(params, covered)).not.toThrow();\n  });\n\n  it(\"computeExtraParams emits numeric default correctly\", () => {\n    const params = [\n      { name: \"count\", defaultValue: \"42\", type: \"number\", ephemeral: false, required: false },\n    ];\n    const covered = new Set<string>();\n\n    expect(service.computeExtraParams(params, covered)).toEqual([\n      { name: \"count\", encoded: \"count=42\" },\n    ]);\n  });\n\n  it(\"computeExtraParams emits boolean default correctly\", () => {\n    const params = [\n      { name: \"enabled\", defaultValue: \"true\", type: \"bool\", ephemeral: false, required: false },\n    ];\n    const covered = new Set<string>();\n\n    expect(service.computeExtraParams(params, covered)).toEqual([\n      { name: \"enabled\", encoded: \"enabled=true\" },\n    ]);\n  });\n\n  it(\"computeExtraParams emits array default as JSON with CSV encoding\", () => {\n    // After parseRichParameters, array becomes JSON string\n    const params = [\n      {\n        name: \"tags\",\n        defaultValue: '[\"a\",\"b\"]',\n        type: \"list(string)\",\n        ephemeral: false,\n        required: false,\n      },\n    ];\n    const covered = new Set<string>();\n\n    // JSON array with quotes gets CSV-encoded (quotes escaped as \"\")\n    expect(service.computeExtraParams(params, covered)).toEqual([\n      { name: \"tags\", encoded: '\"tags=[\"\"a\"\",\"\"b\"\"]\"' },\n    ]);\n  });\n});\n\ndescribe(\"deleteWorkspace\", () => {\n  let service: CoderService;\n\n  beforeEach(() => {\n    service = new CoderService();\n    vi.clearAllMocks();\n  });\n\n  afterEach(() => {\n    service.clearCache();\n  });\n\n  // deleteWorkspace is a thin wrapper around deleteWorkspaceEventually.\n  // Detailed polling/retry behavior is tested in the deleteWorkspaceEventually suite.\n\n  it(\"delegates to deleteWorkspaceEventually with correct options\", async () => {\n    const spy = spyOn(service, \"deleteWorkspaceEventually\").mockResolvedValue({\n      success: true as const,\n      data: undefined,\n    });\n\n    await service.deleteWorkspace(\"mux-my-workspace\");\n\n    expect(spy).toHaveBeenCalledWith(\"mux-my-workspace\", {\n      timeoutMs: 30_000,\n      waitForExistence: false,\n    });\n  });\n\n  it(\"throws when deleteWorkspaceEventually returns an error\", async () => {\n    spyOn(service, \"deleteWorkspaceEventually\").mockResolvedValue({\n      success: false as const,\n      error: \"workspace stuck\",\n    });\n\n    let error: unknown;\n    try {\n      await service.deleteWorkspace(\"mux-my-workspace\");\n    } catch (err) {\n      error = err;\n    }\n\n    expect(error).toBeInstanceOf(Error);\n    expect((error as Error).message).toContain(\"workspace stuck\");\n  });\n});\n\ndescribe(\"deleteWorkspaceEventually\", () => {\n  it(\"polls past initial not_found when waitForExistence=true\", async () => {\n    const service = new CoderService();\n\n    const getWorkspaceStatusSpy = spyOn(service, \"getWorkspaceStatus\");\n    const statuses = [\n      { kind: \"not_found\" as const },\n      { kind: \"ok\" as const, status: \"pending\" as const },\n      { kind: \"ok\" as const, status: \"deleting\" as const },\n    ];\n    getWorkspaceStatusSpy.mockImplementation(() =>\n      Promise.resolve(statuses.shift() ?? { kind: \"ok\" as const, status: \"deleting\" as const })\n    );\n\n    const serviceHack = service as unknown as {\n      runCoderCommand: (\n        args: string[],\n        options: { timeoutMs: number; signal?: AbortSignal }\n      ) => Promise<{\n        exitCode: number | null;\n        stdout: string;\n        stderr: string;\n        error?: string;\n      }>;\n      sleep: (ms: number, signal?: AbortSignal) => Promise<void>;\n    };\n\n    serviceHack.runCoderCommand = vi.fn(() =>\n      Promise.resolve({ exitCode: 0, stdout: \"\", stderr: \"\" })\n    );\n    serviceHack.sleep = vi.fn(() => Promise.resolve());\n\n    const result = await service.deleteWorkspaceEventually(\"mux-my-workspace\", {\n      timeoutMs: 1_000,\n      waitForExistence: true,\n    });\n\n    expect(result.success).toBe(true);\n    expect(getWorkspaceStatusSpy.mock.calls.length).toBeGreaterThan(1);\n    expect(serviceHack.runCoderCommand).toHaveBeenCalled();\n  });\n\n  it(\"treats sustained not_found as success after timeout when waitForExistence=true\", async () => {\n    const service = new CoderService();\n\n    let now = 0;\n    const nowSpy = spyOn(Date, \"now\").mockImplementation(() => now);\n\n    const getWorkspaceStatusSpy = spyOn(service, \"getWorkspaceStatus\").mockResolvedValue({\n      kind: \"not_found\" as const,\n    });\n\n    const serviceHack = service as unknown as {\n      runCoderCommand: (\n        args: string[],\n        options: { timeoutMs: number; signal?: AbortSignal }\n      ) => Promise<{\n        exitCode: number | null;\n        stdout: string;\n        stderr: string;\n        error?: string;\n      }>;\n      sleep: (ms: number, signal?: AbortSignal) => Promise<void>;\n    };\n\n    serviceHack.runCoderCommand = vi.fn(() =>\n      Promise.resolve({ exitCode: 0, stdout: \"\", stderr: \"\" })\n    );\n    serviceHack.sleep = vi.fn((ms: number) => {\n      now += ms;\n      return Promise.resolve();\n    });\n\n    try {\n      const result = await service.deleteWorkspaceEventually(\"mux-my-workspace\", {\n        timeoutMs: 1_000,\n        waitForExistence: true,\n      });\n\n      expect(result.success).toBe(true);\n      expect(getWorkspaceStatusSpy).toHaveBeenCalled();\n      expect(serviceHack.runCoderCommand).not.toHaveBeenCalled();\n    } finally {\n      // Reset Date.now even if the test fails.\n      nowSpy.mockRestore();\n    }\n  });\n\n  it(\"short-circuits on waitForExistenceTimeoutMs before overall timeout\", async () => {\n    const service = new CoderService();\n\n    let now = 0;\n    const nowSpy = spyOn(Date, \"now\").mockImplementation(() => now);\n\n    const getWorkspaceStatusSpy = spyOn(service, \"getWorkspaceStatus\").mockResolvedValue({\n      kind: \"not_found\" as const,\n    });\n\n    const serviceHack = service as unknown as {\n      runCoderCommand: (\n        args: string[],\n        options: { timeoutMs: number; signal?: AbortSignal }\n      ) => Promise<{\n        exitCode: number | null;\n        stdout: string;\n        stderr: string;\n        error?: string;\n      }>;\n      sleep: (ms: number, signal?: AbortSignal) => Promise<void>;\n    };\n\n    serviceHack.runCoderCommand = vi.fn(() =>\n      Promise.resolve({ exitCode: 0, stdout: \"\", stderr: \"\" })\n    );\n    serviceHack.sleep = vi.fn((ms: number) => {\n      now += ms;\n      return Promise.resolve();\n    });\n\n    try {\n      const result = await service.deleteWorkspaceEventually(\"mux-my-workspace\", {\n        timeoutMs: 60_000,\n        waitForExistence: true,\n        // Short existence-wait window: succeed after ~5s of only not_found\n        waitForExistenceTimeoutMs: 5_000,\n      });\n\n      expect(result.success).toBe(true);\n      expect(getWorkspaceStatusSpy).toHaveBeenCalled();\n      // Should never attempt `coder delete` since we only saw not_found\n      expect(serviceHack.runCoderCommand).not.toHaveBeenCalled();\n      // Should have returned well before the 60s overall timeout\n      expect(now).toBeLessThan(10_000);\n    } finally {\n      nowSpy.mockRestore();\n    }\n  });\n\n  it(\"treats a successful delete as terminal even if status polling errors\", async () => {\n    const service = new CoderService();\n\n    spyOn(service, \"getWorkspaceStatus\").mockResolvedValue({\n      kind: \"error\" as const,\n      error: \"auth failed\",\n    });\n\n    const serviceHack = service as unknown as {\n      runCoderCommand: (\n        args: string[],\n        options: { timeoutMs: number; signal?: AbortSignal }\n      ) => Promise<{\n        exitCode: number | null;\n        stdout: string;\n        stderr: string;\n        error?: string;\n      }>;\n      sleep: (ms: number, signal?: AbortSignal) => Promise<void>;\n    };\n\n    serviceHack.runCoderCommand = vi.fn(() =>\n      Promise.resolve({ exitCode: 0, stdout: \"\", stderr: \"\" })\n    );\n    serviceHack.sleep = vi.fn(() => Promise.resolve());\n\n    const result = await service.deleteWorkspaceEventually(\"mux-my-workspace\", {\n      timeoutMs: 60_000,\n      waitForExistence: false,\n    });\n\n    expect(result.success).toBe(true);\n    expect(serviceHack.runCoderCommand).toHaveBeenCalledTimes(1);\n    expect(serviceHack.sleep).not.toHaveBeenCalled();\n  });\n\n  it(\"treats a successful delete as terminal even when waitForExistence=true\", async () => {\n    const service = new CoderService();\n\n    spyOn(service, \"getWorkspaceStatus\").mockResolvedValue({\n      kind: \"error\" as const,\n      error: \"auth failed\",\n    });\n\n    const serviceHack = service as unknown as {\n      runCoderCommand: (\n        args: string[],\n        options: { timeoutMs: number; signal?: AbortSignal }\n      ) => Promise<{\n        exitCode: number | null;\n        stdout: string;\n        stderr: string;\n        error?: string;\n      }>;\n      sleep: (ms: number, signal?: AbortSignal) => Promise<void>;\n    };\n\n    serviceHack.runCoderCommand = vi.fn(() =>\n      Promise.resolve({ exitCode: 0, stdout: \"\", stderr: \"\" })\n    );\n    serviceHack.sleep = vi.fn(() => Promise.resolve());\n\n    const result = await service.deleteWorkspaceEventually(\"mux-my-workspace\", {\n      timeoutMs: 60_000,\n      waitForExistence: true,\n    });\n\n    expect(result.success).toBe(true);\n    expect(serviceHack.runCoderCommand).toHaveBeenCalledTimes(1);\n    expect(serviceHack.sleep).not.toHaveBeenCalled();\n  });\n});\n\ndescribe(\"compareVersions\", () => {\n  it(\"returns 0 for equal versions\", () => {\n    expect(compareVersions(\"2.28.6\", \"2.28.6\")).toBe(0);\n  });\n\n  it(\"returns 0 for equal versions with different formats\", () => {\n    expect(compareVersions(\"v2.28.6\", \"2.28.6\")).toBe(0);\n    expect(compareVersions(\"v2.28.6+hash\", \"2.28.6\")).toBe(0);\n  });\n\n  it(\"returns negative when first version is older\", () => {\n    expect(compareVersions(\"2.25.0\", \"2.28.6\")).toBeLessThan(0);\n    expect(compareVersions(\"2.28.5\", \"2.28.6\")).toBeLessThan(0);\n    expect(compareVersions(\"1.0.0\", \"2.0.0\")).toBeLessThan(0);\n  });\n\n  it(\"returns positive when first version is newer\", () => {\n    expect(compareVersions(\"2.28.6\", \"2.25.0\")).toBeGreaterThan(0);\n    expect(compareVersions(\"2.28.6\", \"2.28.5\")).toBeGreaterThan(0);\n    expect(compareVersions(\"3.0.0\", \"2.28.6\")).toBeGreaterThan(0);\n  });\n\n  it(\"handles versions with v prefix\", () => {\n    expect(compareVersions(\"v2.28.6\", \"2.25.0\")).toBeGreaterThan(0);\n    expect(compareVersions(\"v2.25.0\", \"v2.28.6\")).toBeLessThan(0);\n  });\n\n  it(\"handles dev versions correctly\", () => {\n    // v2.28.2-devel+903c045b9 should be compared as 2.28.2\n    expect(compareVersions(\"v2.28.2-devel+903c045b9\", \"2.25.0\")).toBeGreaterThan(0);\n    expect(compareVersions(\"v2.28.2-devel+903c045b9\", \"2.28.2\")).toBe(0);\n  });\n\n  it(\"handles missing patch version\", () => {\n    expect(compareVersions(\"2.28\", \"2.28.0\")).toBe(0);\n    expect(compareVersions(\"2.28\", \"2.28.1\")).toBeLessThan(0);\n  });\n});\n"]}