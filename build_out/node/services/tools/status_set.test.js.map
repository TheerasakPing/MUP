{"version":3,"file":"status_set.test.js","sourceRoot":"","sources":["../../../../src/node/services/tools/status_set.test.ts"],"names":[],"mappings":"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","sourcesContent":["import { describe, it, expect } from \"bun:test\";\nimport { createStatusSetTool } from \"./status_set\";\nimport type { ToolConfiguration } from \"@/common/utils/tools/tools\";\nimport { createRuntime } from \"@/node/runtime/runtimeFactory\";\nimport type { ToolExecutionOptions } from \"ai\";\nimport { STATUS_MESSAGE_MAX_LENGTH } from \"@/common/constants/toolLimits\";\n\ndescribe(\"status_set tool validation\", () => {\n  const mockConfig: ToolConfiguration = {\n    cwd: \"/test\",\n    runtime: createRuntime({ type: \"local\", srcBaseDir: \"/tmp\" }),\n    runtimeTempDir: \"/tmp\",\n    workspaceId: \"test-workspace\",\n  };\n\n  const mockToolCallOptions: ToolExecutionOptions = {\n    toolCallId: \"test-call-id\",\n    messages: [],\n  };\n\n  describe(\"emoji validation\", () => {\n    it(\"should accept single emoji characters\", async () => {\n      const tool = createStatusSetTool(mockConfig);\n\n      const emojis = [\"ðŸ”\", \"ðŸ“\", \"âœ…\", \"ðŸš€\", \"â³\"];\n      for (const emoji of emojis) {\n        const result = (await tool.execute!({ emoji, message: \"Test\" }, mockToolCallOptions)) as {\n          success: boolean;\n          emoji: string;\n          message: string;\n        };\n        expect(result).toEqual({ success: true, emoji, message: \"Test\" });\n      }\n    });\n\n    it(\"should accept emojis with variation selectors\", async () => {\n      const tool = createStatusSetTool(mockConfig);\n\n      // Emojis with variation selectors (U+FE0F)\n      const emojis = [\"âœï¸\", \"âœ…\", \"âž¡ï¸\", \"â˜€ï¸\"];\n      for (const emoji of emojis) {\n        const result = (await tool.execute!({ emoji, message: \"Test\" }, mockToolCallOptions)) as {\n          success: boolean;\n          emoji: string;\n          message: string;\n        };\n        expect(result).toEqual({ success: true, emoji, message: \"Test\" });\n      }\n    });\n\n    it(\"should accept emojis with skin tone modifiers\", async () => {\n      const tool = createStatusSetTool(mockConfig);\n\n      const emojis = [\"ðŸ‘‹ðŸ»\", \"ðŸ‘‹ðŸ½\", \"ðŸ‘‹ðŸ¿\"];\n      for (const emoji of emojis) {\n        const result = (await tool.execute!({ emoji, message: \"Test\" }, mockToolCallOptions)) as {\n          success: boolean;\n          emoji: string;\n          message: string;\n        };\n        expect(result).toEqual({ success: true, emoji, message: \"Test\" });\n      }\n    });\n\n    it(\"should reject multiple emojis\", async () => {\n      const tool = createStatusSetTool(mockConfig);\n\n      const result1 = (await tool.execute!(\n        { emoji: \"ðŸ”ðŸ“\", message: \"Test\" },\n        mockToolCallOptions\n      )) as { success: boolean; error: string };\n      expect(result1.success).toBe(false);\n      expect(result1.error).toBe(\"emoji must be a single emoji character\");\n\n      const result2 = (await tool.execute!(\n        { emoji: \"âœ…âœ…\", message: \"Test\" },\n        mockToolCallOptions\n      )) as { success: boolean; error: string };\n      expect(result2.success).toBe(false);\n      expect(result2.error).toBe(\"emoji must be a single emoji character\");\n    });\n\n    it(\"should reject text (non-emoji)\", async () => {\n      const tool = createStatusSetTool(mockConfig);\n\n      const result1 = (await tool.execute!(\n        { emoji: \"a\", message: \"Test\" },\n        mockToolCallOptions\n      )) as {\n        success: boolean;\n        error: string;\n      };\n      expect(result1.success).toBe(false);\n      expect(result1.error).toBe(\"emoji must be a single emoji character\");\n\n      const result2 = (await tool.execute!(\n        { emoji: \"abc\", message: \"Test\" },\n        mockToolCallOptions\n      )) as { success: boolean; error: string };\n      expect(result2.success).toBe(false);\n      expect(result2.error).toBe(\"emoji must be a single emoji character\");\n\n      const result3 = (await tool.execute!(\n        { emoji: \"!\", message: \"Test\" },\n        mockToolCallOptions\n      )) as {\n        success: boolean;\n        error: string;\n      };\n      expect(result3.success).toBe(false);\n      expect(result3.error).toBe(\"emoji must be a single emoji character\");\n    });\n\n    it(\"should reject empty emoji\", async () => {\n      const tool = createStatusSetTool(mockConfig);\n\n      const result = (await tool.execute!({ emoji: \"\", message: \"Test\" }, mockToolCallOptions)) as {\n        success: boolean;\n        error: string;\n      };\n      expect(result.success).toBe(false);\n      expect(result.error).toBe(\"emoji must be a single emoji character\");\n    });\n\n    it(\"should reject emoji with text\", async () => {\n      const tool = createStatusSetTool(mockConfig);\n\n      const result1 = (await tool.execute!(\n        { emoji: \"ðŸ”a\", message: \"Test\" },\n        mockToolCallOptions\n      )) as { success: boolean; error: string };\n      expect(result1.success).toBe(false);\n      expect(result1.error).toBe(\"emoji must be a single emoji character\");\n\n      const result2 = (await tool.execute!(\n        { emoji: \"xðŸ”\", message: \"Test\" },\n        mockToolCallOptions\n      )) as { success: boolean; error: string };\n      expect(result2.success).toBe(false);\n      expect(result2.error).toBe(\"emoji must be a single emoji character\");\n    });\n  });\n\n  describe(\"message validation\", () => {\n    it(`should accept messages up to ${STATUS_MESSAGE_MAX_LENGTH} characters`, async () => {\n      const tool = createStatusSetTool(mockConfig);\n\n      const result1 = (await tool.execute!(\n        { emoji: \"âœ…\", message: \"a\".repeat(STATUS_MESSAGE_MAX_LENGTH) },\n        mockToolCallOptions\n      )) as { success: boolean; message: string };\n      expect(result1.success).toBe(true);\n      expect(result1.message).toBe(\"a\".repeat(STATUS_MESSAGE_MAX_LENGTH));\n\n      const result2 = (await tool.execute!(\n        { emoji: \"âœ…\", message: \"Analyzing code structure\" },\n        mockToolCallOptions\n      )) as { success: boolean };\n      expect(result2.success).toBe(true);\n    });\n\n    it(`should truncate messages longer than ${STATUS_MESSAGE_MAX_LENGTH} characters with ellipsis`, async () => {\n      const tool = createStatusSetTool(mockConfig);\n\n      // Test with MAX_LENGTH + 1 characters\n      const result1 = (await tool.execute!(\n        { emoji: \"âœ…\", message: \"a\".repeat(STATUS_MESSAGE_MAX_LENGTH + 1) },\n        mockToolCallOptions\n      )) as { success: boolean; message: string };\n      expect(result1.success).toBe(true);\n      expect(result1.message).toBe(\"a\".repeat(STATUS_MESSAGE_MAX_LENGTH - 1) + \"â€¦\");\n      expect(result1.message.length).toBe(STATUS_MESSAGE_MAX_LENGTH);\n\n      // Test with longer message\n      const longMessage =\n        \"This is a very long message that exceeds the 60 character limit and should be truncated\";\n      const result2 = (await tool.execute!(\n        { emoji: \"âœ…\", message: longMessage },\n        mockToolCallOptions\n      )) as { success: boolean; message: string };\n      expect(result2.success).toBe(true);\n      expect(result2.message).toBe(longMessage.slice(0, STATUS_MESSAGE_MAX_LENGTH - 1) + \"â€¦\");\n      expect(result2.message.length).toBe(STATUS_MESSAGE_MAX_LENGTH);\n    });\n\n    it(\"should accept empty message\", async () => {\n      const tool = createStatusSetTool(mockConfig);\n\n      const result = (await tool.execute!({ emoji: \"âœ…\", message: \"\" }, mockToolCallOptions)) as {\n        success: boolean;\n      };\n      expect(result.success).toBe(true);\n    });\n  });\n\n  describe(\"url parameter\", () => {\n    it(\"should accept valid URLs\", async () => {\n      const tool = createStatusSetTool(mockConfig);\n\n      const validUrls = [\n        \"https://github.com/owner/repo/pull/123\",\n        \"http://example.com\",\n        \"https://example.com/path/to/resource?query=param\",\n      ];\n\n      for (const url of validUrls) {\n        const result = (await tool.execute!(\n          { emoji: \"ðŸ”\", message: \"Test\", url },\n          mockToolCallOptions\n        )) as {\n          success: boolean;\n          url: string;\n        };\n        expect(result.success).toBe(true);\n        expect(result.url).toBe(url);\n      }\n    });\n\n    it(\"should work without URL parameter\", async () => {\n      const tool = createStatusSetTool(mockConfig);\n\n      const result = (await tool.execute!(\n        { emoji: \"âœ…\", message: \"Test\" },\n        mockToolCallOptions\n      )) as {\n        success: boolean;\n        url?: string;\n      };\n      expect(result.success).toBe(true);\n      expect(result.url).toBeUndefined();\n    });\n\n    it(\"should omit URL from result when undefined\", async () => {\n      const tool = createStatusSetTool(mockConfig);\n\n      const result = (await tool.execute!(\n        { emoji: \"âœ…\", message: \"Test\", url: undefined },\n        mockToolCallOptions\n      )) as {\n        success: boolean;\n      };\n      expect(result.success).toBe(true);\n      expect(\"url\" in result).toBe(false);\n    });\n  });\n});\n"]}