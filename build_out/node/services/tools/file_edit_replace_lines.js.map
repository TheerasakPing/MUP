{"version":3,"file":"file_edit_replace_lines.js","sourceRoot":"","sources":["../../../../src/node/services/tools/file_edit_replace_lines.ts"],"names":[],"mappings":";;;AAAA,2BAA0B;AAG1B,0EAAwE;AACxE,+DAAiE;AACjE,yEAAqF;AAkBrF;;GAEG;AACI,MAAM,8BAA8B,GAAgB,CAAC,MAAyB,EAAE,EAAE,CAAC;IACxF,OAAO,IAAA,SAAI,EAAC;QACV,WAAW,EAAE,kCAAgB,CAAC,uBAAuB,CAAC,WAAW;QACjE,WAAW,EAAE,kCAAgB,CAAC,uBAAuB,CAAC,MAAM;QAC5D,OAAO,EAAE,KAAK,EACZ,IAAqB,EACrB,EAAE,WAAW,EAAE,EAC0B,EAAE,CAAC;YAC5C,MAAM,MAAM,GAAG,MAAM,IAAA,8CAAwB,EAAC;gBAC5C,MAAM;gBACN,QAAQ,EAAE,IAAI,CAAC,SAAS;gBACxB,SAAS,EAAE,CAAC,eAAe,EAAE,EAAE,CAAC,IAAA,4CAAiB,EAAC,IAAI,EAAE,eAAe,CAAC;gBACxE,WAAW;aACZ,CAAC,CAAC;YAEH,kEAAkE;YAClE,oEAAoE;YACpE,IAAI,MAAM,CAAC,OAAO,EAAE,CAAC;gBACnB,OAAO;oBACL,OAAO,EAAE,IAAI;oBACb,IAAI,EAAE,MAAM,CAAC,IAAI;oBACjB,OAAO,EAAE,MAAM,CAAC,OAAO;oBACvB,OAAO,EAAE,MAAM,CAAC,OAAO;oBACvB,aAAa,EAAE,MAAM,CAAC,aAAa;oBACnC,cAAc,EAAE,MAAM,CAAC,cAAe;oBACtC,UAAU,EAAE,MAAM,CAAC,UAAW;iBAC/B,CAAC;YACJ,CAAC;YAED,OAAO,MAAM,CAAC;QAAA,CACf;KACF,CAAC,CAAC;AAAA,CACJ,CAAC;AAhCW,QAAA,8BAA8B,GAA9B,8BAA8B,CAgCzC","sourcesContent":["import { tool } from \"ai\";\nimport type { ToolOutputUiOnlyFields } from \"@/common/types/tools\";\nimport type { ToolConfiguration, ToolFactory } from \"@/common/utils/tools/tools\";\nimport { TOOL_DEFINITIONS } from \"@/common/utils/tools/toolDefinitions\";\nimport { executeFileEditOperation } from \"./file_edit_operation\";\nimport { handleLineReplace, type LineReplaceArgs } from \"./file_edit_replace_shared\";\n\nexport interface FileEditReplaceLinesResult extends ToolOutputUiOnlyFields {\n  success: true;\n  diff: string;\n  edits_applied: number;\n  lines_replaced: number;\n  line_delta: number;\n  warning?: string;\n}\n\nexport interface FileEditReplaceLinesError extends ToolOutputUiOnlyFields {\n  success: false;\n  error: string;\n}\n\nexport type FileEditReplaceLinesToolResult = FileEditReplaceLinesResult | FileEditReplaceLinesError;\n\n/**\n * Line-based file edit replace tool factory\n */\nexport const createFileEditReplaceLinesTool: ToolFactory = (config: ToolConfiguration) => {\n  return tool({\n    description: TOOL_DEFINITIONS.file_edit_replace_lines.description,\n    inputSchema: TOOL_DEFINITIONS.file_edit_replace_lines.schema,\n    execute: async (\n      args: LineReplaceArgs,\n      { abortSignal }\n    ): Promise<FileEditReplaceLinesToolResult> => {\n      const result = await executeFileEditOperation({\n        config,\n        filePath: args.file_path,\n        operation: (originalContent) => handleLineReplace(args, originalContent),\n        abortSignal,\n      });\n\n      // handleLineReplace always returns lines_replaced and line_delta,\n      // so we can safely assert this meets FileEditReplaceLinesToolResult\n      if (result.success) {\n        return {\n          success: true,\n          diff: result.diff,\n          ui_only: result.ui_only,\n          warning: result.warning,\n          edits_applied: result.edits_applied,\n          lines_replaced: result.lines_replaced!,\n          line_delta: result.line_delta!,\n        };\n      }\n\n      return result;\n    },\n  });\n};\n"]}