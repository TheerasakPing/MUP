{"version":3,"file":"file_read.test.js","sourceRoot":"","sources":["../../../../src/node/services/tools/file_read.test.ts"],"names":[],"mappings":"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","sourcesContent":["import { describe, it, expect, beforeEach, afterEach } from \"bun:test\";\nimport { LocalRuntime } from \"@/node/runtime/LocalRuntime\";\nimport * as fs from \"fs/promises\";\nimport * as path from \"path\";\nimport * as os from \"os\";\nimport { createFileReadTool } from \"./file_read\";\nimport type { FileReadToolArgs, FileReadToolResult } from \"@/common/types/tools\";\nimport type { ToolExecutionOptions } from \"ai\";\nimport { TestTempDir, createTestToolConfig, getTestDeps } from \"./testHelpers\";\n\n// Mock ToolCallOptions for testing\nconst mockToolCallOptions: ToolExecutionOptions = {\n  toolCallId: \"test-call-id\",\n  messages: [],\n};\n\n// Helper to create file_read tool with test configuration\n// Returns both tool and disposable temp directory\nfunction createTestFileReadTool(options?: { cwd?: string }) {\n  const tempDir = new TestTempDir(\"test-file-read\");\n  const config = createTestToolConfig(options?.cwd ?? process.cwd());\n  config.runtimeTempDir = tempDir.path; // Override runtimeTempDir to use test's disposable temp dir\n  const tool = createFileReadTool(config);\n\n  return {\n    tool,\n    runtimeTempDir: tempDir.path,\n    [Symbol.dispose]() {\n      tempDir[Symbol.dispose]();\n    },\n  };\n}\n\ndescribe(\"file_read tool\", () => {\n  let testDir: string;\n  let testFilePath: string;\n\n  beforeEach(async () => {\n    // Create a temporary directory for test files\n    testDir = await fs.mkdtemp(path.join(os.tmpdir(), \"fileRead-test-\"));\n    testFilePath = path.join(testDir, \"test.txt\");\n  });\n\n  afterEach(async () => {\n    // Clean up test directory\n    await fs.rm(testDir, { recursive: true, force: true });\n  });\n\n  it(\"should read entire file with line numbers\", async () => {\n    // Setup\n    const content = \"line one\\nline two\\nline three\";\n    await fs.writeFile(testFilePath, content);\n\n    using testEnv = createTestFileReadTool({ cwd: testDir });\n    const tool = testEnv.tool;\n    const args: FileReadToolArgs = {\n      file_path: \"test.txt\", // Use relative path\n    };\n\n    // Execute\n    const result = (await tool.execute!(args, mockToolCallOptions)) as FileReadToolResult;\n\n    // Assert\n    expect(result.success).toBe(true);\n    if (result.success) {\n      expect(result.lines_read).toBe(3);\n      expect(result.content).toBe(\"1\\tline one\\n2\\tline two\\n3\\tline three\");\n      expect(result.file_size).toBeGreaterThan(0);\n    }\n  });\n\n  it(\"should read file with offset\", async () => {\n    // Setup\n    const content = \"line1\\nline2\\nline3\\nline4\\nline5\";\n    await fs.writeFile(testFilePath, content);\n\n    using testEnv = createTestFileReadTool({ cwd: testDir });\n    const tool = testEnv.tool;\n    const args: FileReadToolArgs = {\n      file_path: \"test.txt\", // Use relative path\n      offset: 3, // Start from line 3\n    };\n\n    // Execute\n    const result = (await tool.execute!(args, mockToolCallOptions)) as FileReadToolResult;\n\n    // Assert\n    expect(result.success).toBe(true);\n    if (result.success) {\n      expect(result.lines_read).toBe(3);\n      expect(result.content).toBe(\"3\\tline3\\n4\\tline4\\n5\\tline5\");\n    }\n  });\n\n  it(\"should read file with limit\", async () => {\n    // Setup\n    const content = \"line1\\nline2\\nline3\\nline4\\nline5\";\n    await fs.writeFile(testFilePath, content);\n\n    using testEnv = createTestFileReadTool({ cwd: testDir });\n    const tool = testEnv.tool;\n    const args: FileReadToolArgs = {\n      file_path: \"test.txt\", // Use relative path\n      limit: 2, // Read only first 2 lines\n    };\n\n    // Execute\n    const result = (await tool.execute!(args, mockToolCallOptions)) as FileReadToolResult;\n\n    // Assert\n    expect(result.success).toBe(true);\n    if (result.success) {\n      expect(result.lines_read).toBe(2);\n      expect(result.content).toBe(\"1\\tline1\\n2\\tline2\");\n    }\n  });\n\n  it(\"should read file with offset and limit\", async () => {\n    // Setup\n    const content = \"line1\\nline2\\nline3\\nline4\\nline5\";\n    await fs.writeFile(testFilePath, content);\n\n    using testEnv = createTestFileReadTool({ cwd: testDir });\n    const tool = testEnv.tool;\n    const args: FileReadToolArgs = {\n      file_path: \"test.txt\", // Use relative path\n      offset: 2, // Start from line 2\n      limit: 2, // Read 2 lines\n    };\n\n    // Execute\n    const result = (await tool.execute!(args, mockToolCallOptions)) as FileReadToolResult;\n\n    // Assert\n    expect(result.success).toBe(true);\n    if (result.success) {\n      expect(result.lines_read).toBe(2);\n      expect(result.content).toBe(\"2\\tline2\\n3\\tline3\");\n    }\n  });\n\n  it(\"should handle single line file\", async () => {\n    // Setup\n    const content = \"single line\";\n    await fs.writeFile(testFilePath, content);\n\n    using testEnv = createTestFileReadTool({ cwd: testDir });\n    const tool = testEnv.tool;\n    const args: FileReadToolArgs = {\n      file_path: \"test.txt\", // Use relative path\n    };\n\n    // Execute\n    const result = (await tool.execute!(args, mockToolCallOptions)) as FileReadToolResult;\n\n    // Assert\n    expect(result.success).toBe(true);\n    if (result.success) {\n      expect(result.lines_read).toBe(1);\n      expect(result.content).toBe(\"1\\tsingle line\");\n    }\n  });\n\n  it(\"should handle empty file\", async () => {\n    // Setup\n    await fs.writeFile(testFilePath, \"\");\n\n    using testEnv = createTestFileReadTool({ cwd: testDir });\n    const tool = testEnv.tool;\n    const args: FileReadToolArgs = {\n      file_path: \"test.txt\", // Use relative path\n    };\n\n    // Execute\n    const result = (await tool.execute!(args, mockToolCallOptions)) as FileReadToolResult;\n\n    // Assert\n    expect(result.success).toBe(true);\n    if (result.success) {\n      expect(result.lines_read).toBe(0);\n      expect(result.content).toBe(\"\");\n    }\n  });\n\n  it(\"should fail when file does not exist\", async () => {\n    // Setup\n    using testEnv = createTestFileReadTool({ cwd: testDir });\n    const tool = testEnv.tool;\n    const args: FileReadToolArgs = {\n      file_path: \"nonexistent.txt\", // Use relative path\n    };\n\n    // Execute\n    const result = (await tool.execute!(args, mockToolCallOptions)) as FileReadToolResult;\n\n    // Assert\n    expect(result.success).toBe(false);\n    if (!result.success) {\n      expect(result.error).toMatch(/File not found|Failed to stat.*ENOENT/);\n    }\n  });\n\n  it(\"should fail when offset is invalid\", async () => {\n    // Setup\n    const content = \"line1\\nline2\";\n    await fs.writeFile(testFilePath, content);\n\n    using testEnv = createTestFileReadTool({ cwd: testDir });\n    const tool = testEnv.tool;\n    const args: FileReadToolArgs = {\n      file_path: \"test.txt\", // Use relative path\n      offset: 10, // Beyond file length\n    };\n\n    // Execute\n    const result = (await tool.execute!(args, mockToolCallOptions)) as FileReadToolResult;\n\n    // Assert\n    expect(result.success).toBe(false);\n    if (!result.success) {\n      expect(result.error).toContain(\"beyond file length\");\n    }\n  });\n\n  it(\"should truncate lines longer than 1024 bytes\", async () => {\n    // Setup - create a line with more than 1024 bytes\n    const longLine = \"x\".repeat(2000);\n    const content = `short line\\n${longLine}\\nanother short line`;\n    await fs.writeFile(testFilePath, content);\n\n    using testEnv = createTestFileReadTool({ cwd: testDir });\n    const tool = testEnv.tool;\n    const args: FileReadToolArgs = {\n      file_path: \"test.txt\", // Use relative path\n    };\n\n    // Execute\n    const result = (await tool.execute!(args, mockToolCallOptions)) as FileReadToolResult;\n\n    // Assert\n    expect(result.success).toBe(true);\n    if (result.success) {\n      expect(result.lines_read).toBe(3);\n      const lines = result.content.split(\"\\n\");\n      expect(lines[0]).toBe(\"1\\tshort line\");\n      expect(lines[1]).toContain(\"... [truncated]\");\n      expect(Buffer.byteLength(lines[1], \"utf-8\")).toBeLessThan(1100); // Should be around 1024 + prefix + truncation marker\n      expect(lines[2]).toBe(\"3\\tanother short line\");\n    }\n  });\n\n  it(\"should fail when reading more than 1000 lines\", async () => {\n    // Setup - create a file with 1001 lines\n    const lines = Array.from({ length: 1001 }, (_, i) => `line${i + 1}`);\n    const content = lines.join(\"\\n\");\n    await fs.writeFile(testFilePath, content);\n\n    using testEnv = createTestFileReadTool({ cwd: testDir });\n    const tool = testEnv.tool;\n    const args: FileReadToolArgs = {\n      file_path: \"test.txt\", // Use relative path\n    };\n\n    // Execute\n    const result = (await tool.execute!(args, mockToolCallOptions)) as FileReadToolResult;\n\n    // Assert\n    expect(result.success).toBe(false);\n    if (!result.success) {\n      expect(result.error).toContain(\"1000 lines\");\n      expect(result.error).toContain(\"read less at a time\");\n    }\n  });\n\n  it(\"should fail when total output exceeds 16KB\", async () => {\n    // Setup - create lines that together exceed 16KB\n    // Each line is about 200 bytes, so 100 lines will exceed 16KB\n    const lines = Array.from({ length: 100 }, (_, i) => `line${i + 1}:${\"x\".repeat(200)}`);\n    const content = lines.join(\"\\n\");\n    await fs.writeFile(testFilePath, content);\n\n    using testEnv = createTestFileReadTool({ cwd: testDir });\n    const tool = testEnv.tool;\n    const args: FileReadToolArgs = {\n      file_path: \"test.txt\", // Use relative path\n    };\n\n    // Execute\n    const result = (await tool.execute!(args, mockToolCallOptions)) as FileReadToolResult;\n\n    // Assert\n    expect(result.success).toBe(false);\n    if (!result.success) {\n      expect(result.error).toContain(\"16384 bytes\");\n      expect(result.error).toContain(\"read less at a time\");\n    }\n  });\n\n  it(\"should allow reading with limit to stay under 1000 lines\", async () => {\n    // Setup - create a file with 1001 lines\n    const lines = Array.from({ length: 1001 }, (_, i) => `line${i + 1}`);\n    const content = lines.join(\"\\n\");\n    await fs.writeFile(testFilePath, content);\n\n    using testEnv = createTestFileReadTool({ cwd: testDir });\n    const tool = testEnv.tool;\n    const args: FileReadToolArgs = {\n      file_path: \"test.txt\", // Use relative path\n      limit: 500, // Read only 500 lines\n    };\n\n    // Execute\n    const result = (await tool.execute!(args, mockToolCallOptions)) as FileReadToolResult;\n\n    // Assert\n    expect(result.success).toBe(true);\n    if (result.success) {\n      expect(result.lines_read).toBe(500);\n    }\n  });\n\n  it(\"should auto-correct absolute paths containing the workspace directory\", async () => {\n    // Setup\n    const content = \"test content\";\n    await fs.writeFile(testFilePath, content);\n\n    using testEnv = createTestFileReadTool({ cwd: testDir });\n    const tool = testEnv.tool;\n    const args: FileReadToolArgs = {\n      file_path: testFilePath, // Absolute path containing cwd prefix\n    };\n\n    // Execute\n    const result = (await tool.execute!(args, mockToolCallOptions)) as FileReadToolResult;\n\n    // Assert - Should succeed with auto-correction warning\n    expect(result.success).toBe(true);\n    if (result.success) {\n      expect(result.warning).toContain(\"auto-corrected\");\n      expect(result.warning).toContain(\"test.txt\"); // Should mention the relative path\n      expect(result.content).toContain(\"test content\");\n    }\n  });\n\n  it(\"should allow reading files with relative paths within cwd\", async () => {\n    // Setup - create a subdirectory and file\n    const subDir = path.join(testDir, \"subdir\");\n    await fs.mkdir(subDir);\n    const subFilePath = path.join(subDir, \"test.txt\");\n    const content = \"content in subdir\";\n    await fs.writeFile(subFilePath, content);\n\n    // Read using relative path from cwd\n    using testEnv = createTestFileReadTool({ cwd: testDir });\n    const tool = testEnv.tool;\n    const args: FileReadToolArgs = {\n      file_path: \"subdir/test.txt\",\n    };\n\n    // Execute\n    const result = (await tool.execute!(args, mockToolCallOptions)) as FileReadToolResult;\n\n    // Assert\n    expect(result.success).toBe(true);\n    if (result.success) {\n      expect(result.content).toContain(\"content in subdir\");\n    }\n  });\n\n  it(\"should allow reading the configured plan file outside cwd in exec mode\", async () => {\n    const planDir = await fs.mkdtemp(path.join(os.tmpdir(), \"planFile-exec-read-\"));\n    const planPath = path.join(planDir, \"plan.md\");\n\n    try {\n      const planContent = \"# Plan\\n\\n- Step 1\";\n      await fs.writeFile(planPath, planContent);\n\n      const tool = createFileReadTool({\n        ...getTestDeps(),\n        cwd: testDir,\n        runtime: new LocalRuntime(testDir),\n        runtimeTempDir: testDir,\n        planFilePath: planPath,\n      });\n\n      const result = (await tool.execute!(\n        { file_path: planPath },\n        mockToolCallOptions\n      )) as FileReadToolResult;\n\n      expect(result.success).toBe(true);\n      if (result.success) {\n        expect(result.content).toContain(\"# Plan\");\n      }\n    } finally {\n      await fs.rm(planDir, { recursive: true, force: true });\n    }\n  });\n});\n"]}