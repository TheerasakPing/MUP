{"version":3,"file":"file_read.test.js","sourceRoot":"","sources":["../../../../src/node/services/tools/file_read.test.ts"],"names":[],"mappings":"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","sourcesContent":["import { describe, it, expect, beforeEach, afterEach } from \"bun:test\";\r\nimport { LocalRuntime } from \"@/node/runtime/LocalRuntime\";\r\nimport * as fs from \"fs/promises\";\r\nimport * as path from \"path\";\r\nimport * as os from \"os\";\r\nimport { createFileReadTool } from \"./file_read\";\r\nimport type { FileReadToolArgs, FileReadToolResult } from \"@/common/types/tools\";\r\nimport type { ToolExecutionOptions } from \"ai\";\r\nimport { TestTempDir, createTestToolConfig, getTestDeps } from \"./testHelpers\";\r\n\r\n// Mock ToolCallOptions for testing\r\nconst mockToolCallOptions: ToolExecutionOptions = {\r\n  toolCallId: \"test-call-id\",\r\n  messages: [],\r\n};\r\n\r\n// Helper to create file_read tool with test configuration\r\n// Returns both tool and disposable temp directory\r\nfunction createTestFileReadTool(options?: { cwd?: string }) {\r\n  const tempDir = new TestTempDir(\"test-file-read\");\r\n  const config = createTestToolConfig(options?.cwd ?? process.cwd());\r\n  config.runtimeTempDir = tempDir.path; // Override runtimeTempDir to use test's disposable temp dir\r\n  const tool = createFileReadTool(config);\r\n\r\n  return {\r\n    tool,\r\n    runtimeTempDir: tempDir.path,\r\n    [Symbol.dispose]() {\r\n      tempDir[Symbol.dispose]();\r\n    },\r\n  };\r\n}\r\n\r\ndescribe(\"file_read tool\", () => {\r\n  let testDir: string;\r\n  let testFilePath: string;\r\n\r\n  beforeEach(async () => {\r\n    // Create a temporary directory for test files\r\n    testDir = await fs.mkdtemp(path.join(os.tmpdir(), \"fileRead-test-\"));\r\n    testFilePath = path.join(testDir, \"test.txt\");\r\n  });\r\n\r\n  afterEach(async () => {\r\n    // Clean up test directory\r\n    await fs.rm(testDir, { recursive: true, force: true });\r\n  });\r\n\r\n  it(\"should read entire file with line numbers\", async () => {\r\n    // Setup\r\n    const content = \"line one\\nline two\\nline three\";\r\n    await fs.writeFile(testFilePath, content);\r\n\r\n    using testEnv = createTestFileReadTool({ cwd: testDir });\r\n    const tool = testEnv.tool;\r\n    const args: FileReadToolArgs = {\r\n      file_path: \"test.txt\", // Use relative path\r\n    };\r\n\r\n    // Execute\r\n    const result = (await tool.execute!(args, mockToolCallOptions)) as FileReadToolResult;\r\n\r\n    // Assert\r\n    expect(result.success).toBe(true);\r\n    if (result.success) {\r\n      expect(result.lines_read).toBe(3);\r\n      expect(result.content).toBe(\"1\\tline one\\n2\\tline two\\n3\\tline three\");\r\n      expect(result.file_size).toBeGreaterThan(0);\r\n    }\r\n  });\r\n\r\n  it(\"should read file with offset\", async () => {\r\n    // Setup\r\n    const content = \"line1\\nline2\\nline3\\nline4\\nline5\";\r\n    await fs.writeFile(testFilePath, content);\r\n\r\n    using testEnv = createTestFileReadTool({ cwd: testDir });\r\n    const tool = testEnv.tool;\r\n    const args: FileReadToolArgs = {\r\n      file_path: \"test.txt\", // Use relative path\r\n      offset: 3, // Start from line 3\r\n    };\r\n\r\n    // Execute\r\n    const result = (await tool.execute!(args, mockToolCallOptions)) as FileReadToolResult;\r\n\r\n    // Assert\r\n    expect(result.success).toBe(true);\r\n    if (result.success) {\r\n      expect(result.lines_read).toBe(3);\r\n      expect(result.content).toBe(\"3\\tline3\\n4\\tline4\\n5\\tline5\");\r\n    }\r\n  });\r\n\r\n  it(\"should read file with limit\", async () => {\r\n    // Setup\r\n    const content = \"line1\\nline2\\nline3\\nline4\\nline5\";\r\n    await fs.writeFile(testFilePath, content);\r\n\r\n    using testEnv = createTestFileReadTool({ cwd: testDir });\r\n    const tool = testEnv.tool;\r\n    const args: FileReadToolArgs = {\r\n      file_path: \"test.txt\", // Use relative path\r\n      limit: 2, // Read only first 2 lines\r\n    };\r\n\r\n    // Execute\r\n    const result = (await tool.execute!(args, mockToolCallOptions)) as FileReadToolResult;\r\n\r\n    // Assert\r\n    expect(result.success).toBe(true);\r\n    if (result.success) {\r\n      expect(result.lines_read).toBe(2);\r\n      expect(result.content).toBe(\"1\\tline1\\n2\\tline2\");\r\n    }\r\n  });\r\n\r\n  it(\"should read file with offset and limit\", async () => {\r\n    // Setup\r\n    const content = \"line1\\nline2\\nline3\\nline4\\nline5\";\r\n    await fs.writeFile(testFilePath, content);\r\n\r\n    using testEnv = createTestFileReadTool({ cwd: testDir });\r\n    const tool = testEnv.tool;\r\n    const args: FileReadToolArgs = {\r\n      file_path: \"test.txt\", // Use relative path\r\n      offset: 2, // Start from line 2\r\n      limit: 2, // Read 2 lines\r\n    };\r\n\r\n    // Execute\r\n    const result = (await tool.execute!(args, mockToolCallOptions)) as FileReadToolResult;\r\n\r\n    // Assert\r\n    expect(result.success).toBe(true);\r\n    if (result.success) {\r\n      expect(result.lines_read).toBe(2);\r\n      expect(result.content).toBe(\"2\\tline2\\n3\\tline3\");\r\n    }\r\n  });\r\n\r\n  it(\"should handle single line file\", async () => {\r\n    // Setup\r\n    const content = \"single line\";\r\n    await fs.writeFile(testFilePath, content);\r\n\r\n    using testEnv = createTestFileReadTool({ cwd: testDir });\r\n    const tool = testEnv.tool;\r\n    const args: FileReadToolArgs = {\r\n      file_path: \"test.txt\", // Use relative path\r\n    };\r\n\r\n    // Execute\r\n    const result = (await tool.execute!(args, mockToolCallOptions)) as FileReadToolResult;\r\n\r\n    // Assert\r\n    expect(result.success).toBe(true);\r\n    if (result.success) {\r\n      expect(result.lines_read).toBe(1);\r\n      expect(result.content).toBe(\"1\\tsingle line\");\r\n    }\r\n  });\r\n\r\n  it(\"should handle empty file\", async () => {\r\n    // Setup\r\n    await fs.writeFile(testFilePath, \"\");\r\n\r\n    using testEnv = createTestFileReadTool({ cwd: testDir });\r\n    const tool = testEnv.tool;\r\n    const args: FileReadToolArgs = {\r\n      file_path: \"test.txt\", // Use relative path\r\n    };\r\n\r\n    // Execute\r\n    const result = (await tool.execute!(args, mockToolCallOptions)) as FileReadToolResult;\r\n\r\n    // Assert\r\n    expect(result.success).toBe(true);\r\n    if (result.success) {\r\n      expect(result.lines_read).toBe(0);\r\n      expect(result.content).toBe(\"\");\r\n    }\r\n  });\r\n\r\n  it(\"should fail when file does not exist\", async () => {\r\n    // Setup\r\n    using testEnv = createTestFileReadTool({ cwd: testDir });\r\n    const tool = testEnv.tool;\r\n    const args: FileReadToolArgs = {\r\n      file_path: \"nonexistent.txt\", // Use relative path\r\n    };\r\n\r\n    // Execute\r\n    const result = (await tool.execute!(args, mockToolCallOptions)) as FileReadToolResult;\r\n\r\n    // Assert\r\n    expect(result.success).toBe(false);\r\n    if (!result.success) {\r\n      expect(result.error).toMatch(/File not found|Failed to stat.*ENOENT/);\r\n    }\r\n  });\r\n\r\n  it(\"should fail when offset is invalid\", async () => {\r\n    // Setup\r\n    const content = \"line1\\nline2\";\r\n    await fs.writeFile(testFilePath, content);\r\n\r\n    using testEnv = createTestFileReadTool({ cwd: testDir });\r\n    const tool = testEnv.tool;\r\n    const args: FileReadToolArgs = {\r\n      file_path: \"test.txt\", // Use relative path\r\n      offset: 10, // Beyond file length\r\n    };\r\n\r\n    // Execute\r\n    const result = (await tool.execute!(args, mockToolCallOptions)) as FileReadToolResult;\r\n\r\n    // Assert\r\n    expect(result.success).toBe(false);\r\n    if (!result.success) {\r\n      expect(result.error).toContain(\"beyond file length\");\r\n    }\r\n  });\r\n\r\n  it(\"should truncate lines longer than 1024 bytes\", async () => {\r\n    // Setup - create a line with more than 1024 bytes\r\n    const longLine = \"x\".repeat(2000);\r\n    const content = `short line\\n${longLine}\\nanother short line`;\r\n    await fs.writeFile(testFilePath, content);\r\n\r\n    using testEnv = createTestFileReadTool({ cwd: testDir });\r\n    const tool = testEnv.tool;\r\n    const args: FileReadToolArgs = {\r\n      file_path: \"test.txt\", // Use relative path\r\n    };\r\n\r\n    // Execute\r\n    const result = (await tool.execute!(args, mockToolCallOptions)) as FileReadToolResult;\r\n\r\n    // Assert\r\n    expect(result.success).toBe(true);\r\n    if (result.success) {\r\n      expect(result.lines_read).toBe(3);\r\n      const lines = result.content.split(\"\\n\");\r\n      expect(lines[0]).toBe(\"1\\tshort line\");\r\n      expect(lines[1]).toContain(\"... [truncated]\");\r\n      expect(Buffer.byteLength(lines[1], \"utf-8\")).toBeLessThan(1100); // Should be around 1024 + prefix + truncation marker\r\n      expect(lines[2]).toBe(\"3\\tanother short line\");\r\n    }\r\n  });\r\n\r\n  it(\"should fail when reading more than 1000 lines\", async () => {\r\n    // Setup - create a file with 1001 lines\r\n    const lines = Array.from({ length: 1001 }, (_, i) => `line${i + 1}`);\r\n    const content = lines.join(\"\\n\");\r\n    await fs.writeFile(testFilePath, content);\r\n\r\n    using testEnv = createTestFileReadTool({ cwd: testDir });\r\n    const tool = testEnv.tool;\r\n    const args: FileReadToolArgs = {\r\n      file_path: \"test.txt\", // Use relative path\r\n    };\r\n\r\n    // Execute\r\n    const result = (await tool.execute!(args, mockToolCallOptions)) as FileReadToolResult;\r\n\r\n    // Assert\r\n    expect(result.success).toBe(false);\r\n    if (!result.success) {\r\n      expect(result.error).toContain(\"1000 lines\");\r\n      expect(result.error).toContain(\"read less at a time\");\r\n    }\r\n  });\r\n\r\n  it(\"should fail when total output exceeds 16KB\", async () => {\r\n    // Setup - create lines that together exceed 16KB\r\n    // Each line is about 200 bytes, so 100 lines will exceed 16KB\r\n    const lines = Array.from({ length: 100 }, (_, i) => `line${i + 1}:${\"x\".repeat(200)}`);\r\n    const content = lines.join(\"\\n\");\r\n    await fs.writeFile(testFilePath, content);\r\n\r\n    using testEnv = createTestFileReadTool({ cwd: testDir });\r\n    const tool = testEnv.tool;\r\n    const args: FileReadToolArgs = {\r\n      file_path: \"test.txt\", // Use relative path\r\n    };\r\n\r\n    // Execute\r\n    const result = (await tool.execute!(args, mockToolCallOptions)) as FileReadToolResult;\r\n\r\n    // Assert\r\n    expect(result.success).toBe(false);\r\n    if (!result.success) {\r\n      expect(result.error).toContain(\"16384 bytes\");\r\n      expect(result.error).toContain(\"read less at a time\");\r\n    }\r\n  });\r\n\r\n  it(\"should allow reading with limit to stay under 1000 lines\", async () => {\r\n    // Setup - create a file with 1001 lines\r\n    const lines = Array.from({ length: 1001 }, (_, i) => `line${i + 1}`);\r\n    const content = lines.join(\"\\n\");\r\n    await fs.writeFile(testFilePath, content);\r\n\r\n    using testEnv = createTestFileReadTool({ cwd: testDir });\r\n    const tool = testEnv.tool;\r\n    const args: FileReadToolArgs = {\r\n      file_path: \"test.txt\", // Use relative path\r\n      limit: 500, // Read only 500 lines\r\n    };\r\n\r\n    // Execute\r\n    const result = (await tool.execute!(args, mockToolCallOptions)) as FileReadToolResult;\r\n\r\n    // Assert\r\n    expect(result.success).toBe(true);\r\n    if (result.success) {\r\n      expect(result.lines_read).toBe(500);\r\n    }\r\n  });\r\n\r\n  it(\"should auto-correct absolute paths containing the workspace directory\", async () => {\r\n    // Setup\r\n    const content = \"test content\";\r\n    await fs.writeFile(testFilePath, content);\r\n\r\n    using testEnv = createTestFileReadTool({ cwd: testDir });\r\n    const tool = testEnv.tool;\r\n    const args: FileReadToolArgs = {\r\n      file_path: testFilePath, // Absolute path containing cwd prefix\r\n    };\r\n\r\n    // Execute\r\n    const result = (await tool.execute!(args, mockToolCallOptions)) as FileReadToolResult;\r\n\r\n    // Assert - Should succeed with auto-correction warning\r\n    expect(result.success).toBe(true);\r\n    if (result.success) {\r\n      expect(result.warning).toContain(\"auto-corrected\");\r\n      expect(result.warning).toContain(\"test.txt\"); // Should mention the relative path\r\n      expect(result.content).toContain(\"test content\");\r\n    }\r\n  });\r\n\r\n  it(\"should allow reading files with relative paths within cwd\", async () => {\r\n    // Setup - create a subdirectory and file\r\n    const subDir = path.join(testDir, \"subdir\");\r\n    await fs.mkdir(subDir);\r\n    const subFilePath = path.join(subDir, \"test.txt\");\r\n    const content = \"content in subdir\";\r\n    await fs.writeFile(subFilePath, content);\r\n\r\n    // Read using relative path from cwd\r\n    using testEnv = createTestFileReadTool({ cwd: testDir });\r\n    const tool = testEnv.tool;\r\n    const args: FileReadToolArgs = {\r\n      file_path: \"subdir/test.txt\",\r\n    };\r\n\r\n    // Execute\r\n    const result = (await tool.execute!(args, mockToolCallOptions)) as FileReadToolResult;\r\n\r\n    // Assert\r\n    expect(result.success).toBe(true);\r\n    if (result.success) {\r\n      expect(result.content).toContain(\"content in subdir\");\r\n    }\r\n  });\r\n\r\n  it(\"should allow reading the configured plan file outside cwd in exec mode\", async () => {\r\n    const planDir = await fs.mkdtemp(path.join(os.tmpdir(), \"planFile-exec-read-\"));\r\n    const planPath = path.join(planDir, \"plan.md\");\r\n\r\n    try {\r\n      const planContent = \"# Plan\\n\\n- Step 1\";\r\n      await fs.writeFile(planPath, planContent);\r\n\r\n      const tool = createFileReadTool({\r\n        ...getTestDeps(),\r\n        cwd: testDir,\r\n        runtime: new LocalRuntime(testDir),\r\n        runtimeTempDir: testDir,\r\n        planFilePath: planPath,\r\n      });\r\n\r\n      const result = (await tool.execute!(\r\n        { file_path: planPath },\r\n        mockToolCallOptions\r\n      )) as FileReadToolResult;\r\n\r\n      expect(result.success).toBe(true);\r\n      if (result.success) {\r\n        expect(result.content).toContain(\"# Plan\");\r\n      }\r\n    } finally {\r\n      await fs.rm(planDir, { recursive: true, force: true });\r\n    }\r\n  });\r\n});\r\n"]}