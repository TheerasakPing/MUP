{"version":3,"file":"SSHTransport.js","sourceRoot":"","sources":["../../../../src/node/runtime/transports/SSHTransport.ts"],"names":[],"mappings":"","sourcesContent":["import type { SpawnResult } from \"../RemoteRuntime\";\r\nimport type { SSHConnectionConfig } from \"../sshConnectionPool\";\r\n\r\nexport type SSHTransportConfig = SSHConnectionConfig;\r\n\r\nexport interface PtyHandle {\r\n  write(data: string): void;\r\n  resize(cols: number, rows: number): void;\r\n  kill(): void;\r\n  onData(handler: (data: string) => void): { dispose: () => void };\r\n  onExit(handler: (event: { exitCode: number; signal?: number }) => void): { dispose: () => void };\r\n}\r\n\r\nexport interface SpawnOptions {\r\n  forcePTY?: boolean;\r\n  timeout?: number;\r\n  abortSignal?: AbortSignal;\r\n}\r\n\r\nexport interface PtySessionParams {\r\n  workspacePath: string;\r\n  cols: number;\r\n  rows: number;\r\n}\r\n\r\nexport interface SSHTransport {\r\n  /** Spawn a command on the remote host, returning a ChildProcess-compatible object. */\r\n  spawnRemoteProcess(command: string, options: SpawnOptions): Promise<SpawnResult>;\r\n\r\n  /** Determine if an exit code represents a connection-level failure for this transport. */\r\n  isConnectionFailure(exitCode: number, stderr: string): boolean;\r\n\r\n  /** Mark connection as healthy (after successful command). */\r\n  markHealthy(): void;\r\n\r\n  /** Report connection failure (triggers backoff). */\r\n  reportFailure(error: string): void;\r\n\r\n  /** Pre-flight connection check with backoff enforcement. */\r\n  acquireConnection(options?: {\r\n    abortSignal?: AbortSignal;\r\n    timeoutMs?: number;\r\n    onWait?: (waitMs: number) => void;\r\n  }): Promise<void>;\r\n\r\n  /** Get underlying config (for PTY terminal spawning). */\r\n  getConfig(): SSHTransportConfig;\r\n\r\n  /** Create interactive PTY session for the transport. */\r\n  createPtySession(params: PtySessionParams): Promise<PtyHandle>;\r\n}\r\n"]}