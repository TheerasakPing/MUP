{"version":3,"file":"LocalBaseRuntime.test.js","sourceRoot":"","sources":["../../../src/node/runtime/LocalBaseRuntime.test.ts"],"names":[],"mappings":"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","sourcesContent":["import { describe, expect, it } from \"bun:test\";\r\nimport * as os from \"os\";\r\nimport * as path from \"path\";\r\nimport { LocalBaseRuntime } from \"./LocalBaseRuntime\";\r\nimport type {\r\n  WorkspaceCreationParams,\r\n  WorkspaceCreationResult,\r\n  WorkspaceInitParams,\r\n  WorkspaceInitResult,\r\n  WorkspaceForkParams,\r\n  WorkspaceForkResult,\r\n} from \"./Runtime\";\r\n\r\nclass TestLocalRuntime extends LocalBaseRuntime {\r\n  getWorkspacePath(_projectPath: string, _workspaceName: string): string {\r\n    return \"/tmp/workspace\";\r\n  }\r\n\r\n  createWorkspace(_params: WorkspaceCreationParams): Promise<WorkspaceCreationResult> {\r\n    return Promise.resolve({ success: true, workspacePath: \"/tmp/workspace\" });\r\n  }\r\n\r\n  initWorkspace(_params: WorkspaceInitParams): Promise<WorkspaceInitResult> {\r\n    return Promise.resolve({ success: true });\r\n  }\r\n\r\n  renameWorkspace(\r\n    _projectPath: string,\r\n    _oldName: string,\r\n    _newName: string\r\n  ): Promise<\r\n    { success: true; oldPath: string; newPath: string } | { success: false; error: string }\r\n  > {\r\n    return Promise.resolve({ success: true, oldPath: \"/tmp/workspace\", newPath: \"/tmp/workspace\" });\r\n  }\r\n\r\n  deleteWorkspace(\r\n    _projectPath: string,\r\n    _workspaceName: string,\r\n    _force: boolean\r\n  ): Promise<{ success: true; deletedPath: string } | { success: false; error: string }> {\r\n    return Promise.resolve({ success: true, deletedPath: \"/tmp/workspace\" });\r\n  }\r\n\r\n  forkWorkspace(_params: WorkspaceForkParams): Promise<WorkspaceForkResult> {\r\n    return Promise.resolve({\r\n      success: true,\r\n      workspacePath: \"/tmp/workspace\",\r\n      sourceBranch: \"main\",\r\n    });\r\n  }\r\n}\r\n\r\ndescribe(\"LocalBaseRuntime.resolvePath\", () => {\r\n  it(\"should expand tilde to home directory\", async () => {\r\n    const runtime = new TestLocalRuntime();\r\n    const resolved = await runtime.resolvePath(\"~\");\r\n    expect(resolved).toBe(os.homedir());\r\n  });\r\n\r\n  it(\"should expand tilde with path\", async () => {\r\n    const runtime = new TestLocalRuntime();\r\n    const resolved = await runtime.resolvePath(\"~/..\");\r\n    const expected = path.dirname(os.homedir());\r\n    expect(resolved).toBe(expected);\r\n  });\r\n\r\n  it(\"should resolve absolute paths\", async () => {\r\n    const runtime = new TestLocalRuntime();\r\n    const resolved = await runtime.resolvePath(\"/tmp\");\r\n    expect(resolved).toBe(\"/tmp\");\r\n  });\r\n\r\n  it(\"should resolve non-existent paths without checking existence\", async () => {\r\n    const runtime = new TestLocalRuntime();\r\n    const resolved = await runtime.resolvePath(\"/this/path/does/not/exist/12345\");\r\n    // Should resolve to absolute path without checking if it exists\r\n    expect(resolved).toBe(\"/this/path/does/not/exist/12345\");\r\n  });\r\n\r\n  it(\"should resolve relative paths from cwd\", async () => {\r\n    const runtime = new TestLocalRuntime();\r\n    const resolved = await runtime.resolvePath(\".\");\r\n    // Should resolve to absolute path\r\n    expect(path.isAbsolute(resolved)).toBe(true);\r\n  });\r\n});\r\n"]}