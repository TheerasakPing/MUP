{"version":3,"file":"LocalBaseRuntime.test.js","sourceRoot":"","sources":["../../../src/node/runtime/LocalBaseRuntime.test.ts"],"names":[],"mappings":"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","sourcesContent":["import { describe, expect, it } from \"bun:test\";\nimport * as os from \"os\";\nimport * as path from \"path\";\nimport { LocalBaseRuntime } from \"./LocalBaseRuntime\";\nimport type {\n  WorkspaceCreationParams,\n  WorkspaceCreationResult,\n  WorkspaceInitParams,\n  WorkspaceInitResult,\n  WorkspaceForkParams,\n  WorkspaceForkResult,\n} from \"./Runtime\";\n\nclass TestLocalRuntime extends LocalBaseRuntime {\n  getWorkspacePath(_projectPath: string, _workspaceName: string): string {\n    return \"/tmp/workspace\";\n  }\n\n  createWorkspace(_params: WorkspaceCreationParams): Promise<WorkspaceCreationResult> {\n    return Promise.resolve({ success: true, workspacePath: \"/tmp/workspace\" });\n  }\n\n  initWorkspace(_params: WorkspaceInitParams): Promise<WorkspaceInitResult> {\n    return Promise.resolve({ success: true });\n  }\n\n  renameWorkspace(\n    _projectPath: string,\n    _oldName: string,\n    _newName: string\n  ): Promise<\n    { success: true; oldPath: string; newPath: string } | { success: false; error: string }\n  > {\n    return Promise.resolve({ success: true, oldPath: \"/tmp/workspace\", newPath: \"/tmp/workspace\" });\n  }\n\n  deleteWorkspace(\n    _projectPath: string,\n    _workspaceName: string,\n    _force: boolean\n  ): Promise<{ success: true; deletedPath: string } | { success: false; error: string }> {\n    return Promise.resolve({ success: true, deletedPath: \"/tmp/workspace\" });\n  }\n\n  forkWorkspace(_params: WorkspaceForkParams): Promise<WorkspaceForkResult> {\n    return Promise.resolve({\n      success: true,\n      workspacePath: \"/tmp/workspace\",\n      sourceBranch: \"main\",\n    });\n  }\n}\n\ndescribe(\"LocalBaseRuntime.resolvePath\", () => {\n  it(\"should expand tilde to home directory\", async () => {\n    const runtime = new TestLocalRuntime();\n    const resolved = await runtime.resolvePath(\"~\");\n    expect(resolved).toBe(os.homedir());\n  });\n\n  it(\"should expand tilde with path\", async () => {\n    const runtime = new TestLocalRuntime();\n    const resolved = await runtime.resolvePath(\"~/..\");\n    const expected = path.dirname(os.homedir());\n    expect(resolved).toBe(expected);\n  });\n\n  it(\"should resolve absolute paths\", async () => {\n    const runtime = new TestLocalRuntime();\n    const resolved = await runtime.resolvePath(\"/tmp\");\n    expect(resolved).toBe(\"/tmp\");\n  });\n\n  it(\"should resolve non-existent paths without checking existence\", async () => {\n    const runtime = new TestLocalRuntime();\n    const resolved = await runtime.resolvePath(\"/this/path/does/not/exist/12345\");\n    // Should resolve to absolute path without checking if it exists\n    expect(resolved).toBe(\"/this/path/does/not/exist/12345\");\n  });\n\n  it(\"should resolve relative paths from cwd\", async () => {\n    const runtime = new TestLocalRuntime();\n    const resolved = await runtime.resolvePath(\".\");\n    // Should resolve to absolute path\n    expect(path.isAbsolute(resolved)).toBe(true);\n  });\n});\n"]}