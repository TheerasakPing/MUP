{"version":3,"file":"devcontainerConfigs.js","sourceRoot":"","sources":["../../../src/node/runtime/devcontainerConfigs.ts"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA,MAAY,EAAE,wCAAoB;AAClC,MAAY,IAAI,iCAAa;AAG7B,iCAAwC,UAAkB,EAAU;IAClE,IAAI,UAAU,KAAK,oBAAoB,EAAE,CAAC;QACxC,OAAO,8BAA8B,CAAC;IACxC,CAAC;IAED,IAAI,UAAU,KAAK,iCAAiC,EAAE,CAAC;QACrD,OAAO,2CAA2C,CAAC;IACrD,CAAC;IAED,MAAM,UAAU,GAAG,UAAU,CAAC,OAAO,CAAC,KAAK,EAAE,GAAG,CAAC,CAAC;IAClD,MAAM,KAAK,GAAG,+CAA+C,CAAC,IAAI,CAAC,UAAU,CAAC,CAAC;IAC/E,IAAI,KAAK,EAAE,CAAC,CAAC,CAAC,EAAE,CAAC;QACf,OAAO,GAAG,KAAK,CAAC,CAAC,CAAC,KAAK,UAAU,GAAG,CAAC;IACvC,CAAC;IAED,OAAO,UAAU,CAAC;AAAA,CACnB;AAED,qCAA4C,OAAiB,EAA4B;IACvF,OAAO,OAAO,CAAC,GAAG,CAAC,CAAC,UAAU,EAAE,EAAE,CAAC,CAAC;QAClC,IAAI,EAAE,UAAU;QAChB,KAAK,EAAE,uBAAuB,CAAC,UAAU,CAAC;KAC3C,CAAC,CAAC,CAAC;AAAA,CACL;AAED;;;GAGG;AACI,KAAK,kCAAkC,WAAmB,EAAqB;IACpF,MAAM,OAAO,GAAa,EAAE,CAAC;IAE7B,2BAA2B;IAC3B,MAAM,SAAS,GAAG,CAAC,oBAAoB,EAAE,iCAAiC,CAAC,CAAC;IAE5E,KAAK,MAAM,GAAG,IAAI,SAAS,EAAE,CAAC;QAC5B,IAAI,CAAC;YACH,MAAM,EAAE,CAAC,MAAM,CAAC,IAAI,CAAC,IAAI,CAAC,WAAW,EAAE,GAAG,CAAC,CAAC,CAAC;YAC7C,OAAO,CAAC,IAAI,CAAC,GAAG,CAAC,CAAC;QACpB,CAAC;QAAC,MAAM,CAAC;YACP,qBAAqB;QACvB,CAAC;IACH,CAAC;IAED,wEAAwE;IACxE,IAAI,CAAC;QACH,MAAM,eAAe,GAAG,IAAI,CAAC,IAAI,CAAC,WAAW,EAAE,eAAe,CAAC,CAAC;QAChE,MAAM,OAAO,GAAG,MAAM,EAAE,CAAC,OAAO,CAAC,eAAe,EAAE,EAAE,aAAa,EAAE,IAAI,EAAE,CAAC,CAAC;QAC3E,KAAK,MAAM,KAAK,IAAI,OAAO,EAAE,CAAC;YAC5B,IAAI,KAAK,CAAC,WAAW,EAAE,EAAE,CAAC;gBACxB,MAAM,UAAU,GAAG,IAAI,CAAC,IAAI,CAAC,eAAe,EAAE,KAAK,CAAC,IAAI,EAAE,mBAAmB,CAAC,CAAC;gBAC/E,IAAI,CAAC;oBACH,MAAM,EAAE,CAAC,MAAM,CAAC,IAAI,CAAC,IAAI,CAAC,WAAW,EAAE,UAAU,CAAC,CAAC,CAAC;oBACpD,OAAO,CAAC,IAAI,CAAC,UAAU,CAAC,CAAC;gBAC3B,CAAC;gBAAC,MAAM,CAAC;oBACP,qBAAqB;gBACvB,CAAC;YACH,CAAC;QACH,CAAC;IACH,CAAC;IAAC,MAAM,CAAC;QACP,wCAAwC;IAC1C,CAAC;IAED,OAAO,OAAO,CAAC;AAAA,CAChB","sourcesContent":["import * as fs from \"fs/promises\";\r\nimport * as path from \"path\";\r\nimport type { DevcontainerConfigInfo } from \"@/common/types/runtime\";\r\n\r\nexport function formatDevcontainerLabel(configPath: string): string {\r\n  if (configPath === \".devcontainer.json\") {\r\n    return \"Default (.devcontainer.json)\";\r\n  }\r\n\r\n  if (configPath === \".devcontainer/devcontainer.json\") {\r\n    return \"Default (.devcontainer/devcontainer.json)\";\r\n  }\r\n\r\n  const normalized = configPath.replace(/\\\\/g, \"/\");\r\n  const match = /^\\.devcontainer\\/([^/]+)\\/devcontainer\\.json$/.exec(normalized);\r\n  if (match?.[1]) {\r\n    return `${match[1]} (${normalized})`;\r\n  }\r\n\r\n  return normalized;\r\n}\r\n\r\nexport function buildDevcontainerConfigInfo(configs: string[]): DevcontainerConfigInfo[] {\r\n  return configs.map((configPath) => ({\r\n    path: configPath,\r\n    label: formatDevcontainerLabel(configPath),\r\n  }));\r\n}\r\n\r\n/**\r\n * Scan for devcontainer.json files in a project.\r\n * Returns paths relative to project root.\r\n */\r\nexport async function scanDevcontainerConfigs(projectPath: string): Promise<string[]> {\r\n  const configs: string[] = [];\r\n\r\n  // Check standard locations\r\n  const locations = [\".devcontainer.json\", \".devcontainer/devcontainer.json\"];\r\n\r\n  for (const loc of locations) {\r\n    try {\r\n      await fs.access(path.join(projectPath, loc));\r\n      configs.push(loc);\r\n    } catch {\r\n      // File doesn't exist\r\n    }\r\n  }\r\n\r\n  // Also scan .devcontainer/*/devcontainer.json for multi-config projects\r\n  try {\r\n    const devcontainerDir = path.join(projectPath, \".devcontainer\");\r\n    const entries = await fs.readdir(devcontainerDir, { withFileTypes: true });\r\n    for (const entry of entries) {\r\n      if (entry.isDirectory()) {\r\n        const configPath = path.join(\".devcontainer\", entry.name, \"devcontainer.json\");\r\n        try {\r\n          await fs.access(path.join(projectPath, configPath));\r\n          configs.push(configPath);\r\n        } catch {\r\n          // File doesn't exist\r\n        }\r\n      }\r\n    }\r\n  } catch {\r\n    // .devcontainer directory doesn't exist\r\n  }\r\n\r\n  return configs;\r\n}\r\n"]}