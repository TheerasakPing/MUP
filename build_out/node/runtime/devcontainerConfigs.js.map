{"version":3,"file":"devcontainerConfigs.js","sourceRoot":"","sources":["../../../src/node/runtime/devcontainerConfigs.ts"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA,MAAY,EAAE,wCAAoB;AAClC,MAAY,IAAI,iCAAa;AAG7B,iCAAwC,UAAkB,EAAU;IAClE,IAAI,UAAU,KAAK,oBAAoB,EAAE,CAAC;QACxC,OAAO,8BAA8B,CAAC;IACxC,CAAC;IAED,IAAI,UAAU,KAAK,iCAAiC,EAAE,CAAC;QACrD,OAAO,2CAA2C,CAAC;IACrD,CAAC;IAED,MAAM,UAAU,GAAG,UAAU,CAAC,OAAO,CAAC,KAAK,EAAE,GAAG,CAAC,CAAC;IAClD,MAAM,KAAK,GAAG,+CAA+C,CAAC,IAAI,CAAC,UAAU,CAAC,CAAC;IAC/E,IAAI,KAAK,EAAE,CAAC,CAAC,CAAC,EAAE,CAAC;QACf,OAAO,GAAG,KAAK,CAAC,CAAC,CAAC,KAAK,UAAU,GAAG,CAAC;IACvC,CAAC;IAED,OAAO,UAAU,CAAC;AAAA,CACnB;AAED,qCAA4C,OAAiB,EAA4B;IACvF,OAAO,OAAO,CAAC,GAAG,CAAC,CAAC,UAAU,EAAE,EAAE,CAAC,CAAC;QAClC,IAAI,EAAE,UAAU;QAChB,KAAK,EAAE,uBAAuB,CAAC,UAAU,CAAC;KAC3C,CAAC,CAAC,CAAC;AAAA,CACL;AAED;;;GAGG;AACI,KAAK,kCAAkC,WAAmB,EAAqB;IACpF,MAAM,OAAO,GAAa,EAAE,CAAC;IAE7B,2BAA2B;IAC3B,MAAM,SAAS,GAAG,CAAC,oBAAoB,EAAE,iCAAiC,CAAC,CAAC;IAE5E,KAAK,MAAM,GAAG,IAAI,SAAS,EAAE,CAAC;QAC5B,IAAI,CAAC;YACH,MAAM,EAAE,CAAC,MAAM,CAAC,IAAI,CAAC,IAAI,CAAC,WAAW,EAAE,GAAG,CAAC,CAAC,CAAC;YAC7C,OAAO,CAAC,IAAI,CAAC,GAAG,CAAC,CAAC;QACpB,CAAC;QAAC,MAAM,CAAC;YACP,qBAAqB;QACvB,CAAC;IACH,CAAC;IAED,wEAAwE;IACxE,IAAI,CAAC;QACH,MAAM,eAAe,GAAG,IAAI,CAAC,IAAI,CAAC,WAAW,EAAE,eAAe,CAAC,CAAC;QAChE,MAAM,OAAO,GAAG,MAAM,EAAE,CAAC,OAAO,CAAC,eAAe,EAAE,EAAE,aAAa,EAAE,IAAI,EAAE,CAAC,CAAC;QAC3E,KAAK,MAAM,KAAK,IAAI,OAAO,EAAE,CAAC;YAC5B,IAAI,KAAK,CAAC,WAAW,EAAE,EAAE,CAAC;gBACxB,MAAM,UAAU,GAAG,IAAI,CAAC,IAAI,CAAC,eAAe,EAAE,KAAK,CAAC,IAAI,EAAE,mBAAmB,CAAC,CAAC;gBAC/E,IAAI,CAAC;oBACH,MAAM,EAAE,CAAC,MAAM,CAAC,IAAI,CAAC,IAAI,CAAC,WAAW,EAAE,UAAU,CAAC,CAAC,CAAC;oBACpD,OAAO,CAAC,IAAI,CAAC,UAAU,CAAC,CAAC;gBAC3B,CAAC;gBAAC,MAAM,CAAC;oBACP,qBAAqB;gBACvB,CAAC;YACH,CAAC;QACH,CAAC;IACH,CAAC;IAAC,MAAM,CAAC;QACP,wCAAwC;IAC1C,CAAC;IAED,OAAO,OAAO,CAAC;AAAA,CAChB","sourcesContent":["import * as fs from \"fs/promises\";\nimport * as path from \"path\";\nimport type { DevcontainerConfigInfo } from \"@/common/types/runtime\";\n\nexport function formatDevcontainerLabel(configPath: string): string {\n  if (configPath === \".devcontainer.json\") {\n    return \"Default (.devcontainer.json)\";\n  }\n\n  if (configPath === \".devcontainer/devcontainer.json\") {\n    return \"Default (.devcontainer/devcontainer.json)\";\n  }\n\n  const normalized = configPath.replace(/\\\\/g, \"/\");\n  const match = /^\\.devcontainer\\/([^/]+)\\/devcontainer\\.json$/.exec(normalized);\n  if (match?.[1]) {\n    return `${match[1]} (${normalized})`;\n  }\n\n  return normalized;\n}\n\nexport function buildDevcontainerConfigInfo(configs: string[]): DevcontainerConfigInfo[] {\n  return configs.map((configPath) => ({\n    path: configPath,\n    label: formatDevcontainerLabel(configPath),\n  }));\n}\n\n/**\n * Scan for devcontainer.json files in a project.\n * Returns paths relative to project root.\n */\nexport async function scanDevcontainerConfigs(projectPath: string): Promise<string[]> {\n  const configs: string[] = [];\n\n  // Check standard locations\n  const locations = [\".devcontainer.json\", \".devcontainer/devcontainer.json\"];\n\n  for (const loc of locations) {\n    try {\n      await fs.access(path.join(projectPath, loc));\n      configs.push(loc);\n    } catch {\n      // File doesn't exist\n    }\n  }\n\n  // Also scan .devcontainer/*/devcontainer.json for multi-config projects\n  try {\n    const devcontainerDir = path.join(projectPath, \".devcontainer\");\n    const entries = await fs.readdir(devcontainerDir, { withFileTypes: true });\n    for (const entry of entries) {\n      if (entry.isDirectory()) {\n        const configPath = path.join(\".devcontainer\", entry.name, \"devcontainer.json\");\n        try {\n          await fs.access(path.join(projectPath, configPath));\n          configs.push(configPath);\n        } catch {\n          // File doesn't exist\n        }\n      }\n    }\n  } catch {\n    // .devcontainer directory doesn't exist\n  }\n\n  return configs;\n}\n"]}