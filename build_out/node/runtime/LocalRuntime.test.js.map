{"version":3,"file":"LocalRuntime.test.js","sourceRoot":"","sources":["../../../src/node/runtime/LocalRuntime.test.ts"],"names":[],"mappings":"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","sourcesContent":["import { describe, expect, it, beforeAll, afterAll } from \"bun:test\";\nimport * as os from \"os\";\nimport * as path from \"path\";\nimport * as fs from \"fs/promises\";\nimport { LocalRuntime } from \"./LocalRuntime\";\nimport type { InitLogger, RuntimeStatusEvent } from \"./Runtime\";\n\n// Minimal mock logger - matches pattern in initHook.test.ts\nfunction createMockLogger(): InitLogger & { steps: string[] } {\n  const steps: string[] = [];\n  return {\n    steps,\n    logStep: (msg: string) => steps.push(msg),\n    logStdout: () => {\n      /* no-op for test */\n    },\n    logStderr: () => {\n      /* no-op for test */\n    },\n    logComplete: () => {\n      /* no-op for test */\n    },\n  };\n}\n\ndescribe(\"LocalRuntime\", () => {\n  // Use a temp directory for tests\n  let testDir: string;\n\n  beforeAll(async () => {\n    // Resolve real path to handle macOS symlinks (/var -> /private/var)\n    testDir = await fs.realpath(await fs.mkdtemp(path.join(os.tmpdir(), \"localruntime-test-\")));\n  });\n\n  afterAll(async () => {\n    await fs.rm(testDir, { recursive: true, force: true });\n  });\n\n  describe(\"constructor and getWorkspacePath\", () => {\n    it(\"stores projectPath and returns it regardless of arguments\", () => {\n      const runtime = new LocalRuntime(\"/home/user/my-project\");\n      // Both arguments are ignored - always returns the project path\n      expect(runtime.getWorkspacePath(\"/other/path\", \"some-branch\")).toBe(\"/home/user/my-project\");\n      expect(runtime.getWorkspacePath(\"\", \"\")).toBe(\"/home/user/my-project\");\n    });\n\n    it(\"does not expand tilde (unlike WorktreeRuntime)\", () => {\n      // LocalRuntime stores the path as-is; callers must pass expanded paths\n      const runtime = new LocalRuntime(\"~/my-project\");\n      expect(runtime.getWorkspacePath(\"\", \"\")).toBe(\"~/my-project\");\n    });\n  });\n\n  describe(\"ensureReady\", () => {\n    it(\"allows non-git project directories to be ready\", async () => {\n      const runtime = new LocalRuntime(testDir);\n      const events: RuntimeStatusEvent[] = [];\n\n      const result = await runtime.ensureReady({\n        statusSink: (event) => events.push(event),\n      });\n\n      expect(result).toEqual({ ready: true });\n      expect(events[0]).toMatchObject({ phase: \"checking\", runtimeType: \"local\" });\n      expect(events[events.length - 1]).toMatchObject({ phase: \"ready\", runtimeType: \"local\" });\n    });\n  });\n\n  describe(\"createWorkspace\", () => {\n    it(\"succeeds when directory exists\", async () => {\n      const runtime = new LocalRuntime(testDir);\n      const logger = createMockLogger();\n\n      const result = await runtime.createWorkspace({\n        projectPath: testDir,\n        branchName: \"main\",\n        trunkBranch: \"main\",\n        directoryName: \"main\",\n        initLogger: logger,\n      });\n\n      expect(result.success).toBe(true);\n      expect(result.workspacePath).toBe(testDir);\n      expect(logger.steps.length).toBeGreaterThan(0);\n      expect(logger.steps.some((s) => s.includes(\"project directory\"))).toBe(true);\n    });\n\n    it(\"fails when directory does not exist\", async () => {\n      const nonExistentPath = path.join(testDir, \"does-not-exist\");\n      const runtime = new LocalRuntime(nonExistentPath);\n      const logger = createMockLogger();\n\n      const result = await runtime.createWorkspace({\n        projectPath: nonExistentPath,\n        branchName: \"main\",\n        trunkBranch: \"main\",\n        directoryName: \"main\",\n        initLogger: logger,\n      });\n\n      expect(result.success).toBe(false);\n      expect(result.error).toContain(\"does not exist\");\n    });\n  });\n\n  describe(\"initWorkspace\", () => {\n    it(\"runs init hook by default, but skips when skipInitHook=true\", async () => {\n      const runtime = new LocalRuntime(testDir);\n\n      const muxDir = path.join(testDir, \".mux\");\n      await fs.mkdir(muxDir, { recursive: true });\n\n      const markerPath = path.join(testDir, \".init-marker\");\n      await fs.rm(markerPath, { force: true });\n\n      const hookPath = path.join(muxDir, \"init\");\n      await fs.writeFile(hookPath, \"#!/usr/bin/env bash\\n\\necho ran > .init-marker\\n\");\n      await fs.chmod(hookPath, 0o755);\n\n      {\n        const logger = createMockLogger();\n        const result = await runtime.initWorkspace({\n          projectPath: testDir,\n          branchName: \"main\",\n          trunkBranch: \"main\",\n          workspacePath: testDir,\n          initLogger: logger,\n        });\n        expect(result.success).toBe(true);\n      }\n\n      const ranMarkerExists = await fs.access(markerPath).then(\n        () => true,\n        () => false\n      );\n      expect(ranMarkerExists).toBe(true);\n\n      // Remove marker and re-run init with skip flag.\n      await fs.rm(markerPath, { force: true });\n\n      {\n        const logger = createMockLogger();\n        const result = await runtime.initWorkspace({\n          projectPath: testDir,\n          branchName: \"main\",\n          trunkBranch: \"main\",\n          workspacePath: testDir,\n          initLogger: logger,\n          skipInitHook: true,\n        });\n        expect(result.success).toBe(true);\n        expect(logger.steps).toContain(\"Skipping .mux/init hook (disabled for this task)\");\n      }\n\n      const skippedMarkerExists = await fs.access(markerPath).then(\n        () => true,\n        () => false\n      );\n      expect(skippedMarkerExists).toBe(false);\n    });\n  });\n\n  describe(\"deleteWorkspace\", () => {\n    it(\"returns success without deleting anything\", async () => {\n      const runtime = new LocalRuntime(testDir);\n\n      // Create a test file to verify it isn't deleted\n      const testFile = path.join(testDir, \"delete-test.txt\");\n      await fs.writeFile(testFile, \"should not be deleted\");\n\n      const result = await runtime.deleteWorkspace(testDir, \"main\", false);\n\n      expect(result.success).toBe(true);\n      if (result.success) {\n        expect(result.deletedPath).toBe(testDir);\n      }\n\n      // Verify file still exists\n      const fileStillExists = await fs.access(testFile).then(\n        () => true,\n        () => false\n      );\n      expect(fileStillExists).toBe(true);\n\n      // Cleanup\n      await fs.unlink(testFile);\n    });\n\n    it(\"returns success even with force=true (still no-op)\", async () => {\n      const runtime = new LocalRuntime(testDir);\n\n      const result = await runtime.deleteWorkspace(testDir, \"main\", true);\n\n      expect(result.success).toBe(true);\n      if (result.success) {\n        expect(result.deletedPath).toBe(testDir);\n      }\n      // Directory should still exist\n      const dirExists = await fs.access(testDir).then(\n        () => true,\n        () => false\n      );\n      expect(dirExists).toBe(true);\n    });\n  });\n\n  describe(\"renameWorkspace\", () => {\n    it(\"is a no-op that returns success with same path\", async () => {\n      const runtime = new LocalRuntime(testDir);\n\n      const result = await runtime.renameWorkspace(testDir, \"old\", \"new\");\n\n      expect(result.success).toBe(true);\n      if (result.success) {\n        expect(result.oldPath).toBe(testDir);\n        expect(result.newPath).toBe(testDir);\n      }\n    });\n  });\n\n  describe(\"forkWorkspace\", () => {\n    it(\"succeeds and returns project path (no worktree isolation)\", async () => {\n      const runtime = new LocalRuntime(testDir);\n      const logger = createMockLogger();\n\n      const result = await runtime.forkWorkspace({\n        projectPath: testDir,\n        sourceWorkspaceName: \"main\",\n        newWorkspaceName: \"feature\",\n        initLogger: logger,\n      });\n\n      expect(result.success).toBe(true);\n      expect(result.workspacePath).toBe(testDir);\n      // sourceBranch is undefined for LocalRuntime (no git operations)\n      expect(result.sourceBranch).toBeUndefined();\n      // Should have logged steps\n      expect(logger.steps.some((s) => s.includes(\"fork\"))).toBe(true);\n      expect(logger.steps.some((s) => s.includes(\"verified\"))).toBe(true);\n    });\n\n    it(\"fails when project directory does not exist\", async () => {\n      const nonExistentPath = path.join(testDir, \"does-not-exist\");\n      const runtime = new LocalRuntime(nonExistentPath);\n      const logger = createMockLogger();\n\n      const result = await runtime.forkWorkspace({\n        projectPath: nonExistentPath,\n        sourceWorkspaceName: \"main\",\n        newWorkspaceName: \"feature\",\n        initLogger: logger,\n      });\n\n      expect(result.success).toBe(false);\n      expect(result.error).toContain(\"does not exist\");\n    });\n  });\n\n  // Note: exec, stat, resolvePath, normalizePath are tested in the shared Runtime\n  // interface tests (tests/runtime/runtime.test.ts matrix)\n\n  describe(\"ensureDir\", () => {\n    it(\"creates directories recursively\", async () => {\n      const runtime = new LocalRuntime(testDir);\n\n      const dirPath = path.join(testDir, \"ensure-dir\", \"a\", \"b\", \"c\");\n      await runtime.ensureDir(dirPath);\n\n      const stat = await fs.stat(dirPath);\n      expect(stat.isDirectory()).toBe(true);\n\n      // Should be idempotent\n      await runtime.ensureDir(dirPath);\n    });\n  });\n\n  describe(\"tilde expansion in file operations\", () => {\n    it(\"stat expands tilde paths\", async () => {\n      const runtime = new LocalRuntime(testDir);\n\n      // Create a file in home directory's .mux folder\n      const muxDir = path.join(os.homedir(), \".mux\", \"test-tilde\");\n      await fs.mkdir(muxDir, { recursive: true });\n      const testFile = path.join(muxDir, \"test.txt\");\n      await fs.writeFile(testFile, \"test content\");\n\n      try {\n        // Use tilde path - should work\n        const stat = await runtime.stat(\"~/.mux/test-tilde/test.txt\");\n        expect(stat.size).toBeGreaterThan(0);\n        expect(stat.isDirectory).toBe(false);\n      } finally {\n        await fs.rm(muxDir, { recursive: true, force: true });\n      }\n    });\n\n    it(\"readFile expands tilde paths\", async () => {\n      const runtime = new LocalRuntime(testDir);\n\n      // Create a file in home directory's .mux folder\n      const muxDir = path.join(os.homedir(), \".mux\", \"test-tilde\");\n      await fs.mkdir(muxDir, { recursive: true });\n      const testFile = path.join(muxDir, \"read-test.txt\");\n      const content = \"hello from tilde path\";\n      await fs.writeFile(testFile, content);\n\n      try {\n        // Use tilde path - should work\n        const stream = runtime.readFile(\"~/.mux/test-tilde/read-test.txt\");\n        const reader = stream.getReader();\n        let result = \"\";\n        while (true) {\n          const { done, value } = await reader.read();\n          if (done) break;\n          result += new TextDecoder().decode(value);\n        }\n        expect(result).toBe(content);\n      } finally {\n        await fs.rm(muxDir, { recursive: true, force: true });\n      }\n    });\n\n    it(\"writeFile expands tilde paths\", async () => {\n      const runtime = new LocalRuntime(testDir);\n\n      // Create parent directory in home\n      const muxDir = path.join(os.homedir(), \".mux\", \"test-tilde-write\");\n      await fs.mkdir(muxDir, { recursive: true });\n\n      try {\n        // Use tilde path - should work\n        const content = \"written via tilde path\";\n        const stream = runtime.writeFile(\"~/.mux/test-tilde-write/write-test.txt\");\n        const writer = stream.getWriter();\n        await writer.write(new TextEncoder().encode(content));\n        await writer.close();\n\n        // Verify file was written to correct location\n        const written = await fs.readFile(path.join(muxDir, \"write-test.txt\"), \"utf-8\");\n        expect(written).toBe(content);\n      } finally {\n        await fs.rm(muxDir, { recursive: true, force: true });\n      }\n    });\n  });\n});\n"]}