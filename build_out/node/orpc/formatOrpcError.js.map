{"version":3,"file":"formatOrpcError.js","sourceRoot":"","sources":["../../../src/node/orpc/formatOrpcError.ts"],"names":[],"mappings":"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","sourcesContent":["import { ORPCError, ValidationError } from \"@orpc/server\";\nimport type { StandardSchemaV1 } from \"@standard-schema/spec\";\nimport { inspect } from \"node:util\";\n\nexport interface FormattedOrpcError {\n  /**\n   * Human-readable error message suitable for console output.\n   *\n   * Keep this as a string so we don't lose nested details to Node's `[Object]` / `[Array]` printing.\n   */\n  message: string;\n  /**\n   * JSON-serializable debug payload for log.debug_obj().\n   *\n   * This is intentionally best-effort and must never throw.\n   */\n  debugDump: Record<string, unknown>;\n}\n\ninterface RequestContext {\n  method?: string;\n  /** Full URL string (if available). */\n  url?: string;\n  /** URL pathname + search (if available). */\n  path?: string;\n  prefix?: string;\n  headers?: Record<string, unknown>;\n}\n\nfunction isRecord(value: unknown): value is Record<string, unknown> {\n  return !!value && typeof value === \"object\" && !Array.isArray(value);\n}\n\nfunction isUnknownArray(value: unknown): value is readonly unknown[] {\n  return Array.isArray(value);\n}\n\nfunction isPlainObject(value: unknown): value is Record<string, unknown> {\n  if (!isRecord(value)) {\n    return false;\n  }\n\n  const proto = Object.getPrototypeOf(value) as object | null;\n  return proto === Object.prototype || proto === null;\n}\n\nfunction redactHeaders(headers: unknown): Record<string, unknown> | undefined {\n  if (!isRecord(headers)) {\n    return undefined;\n  }\n\n  const result: Record<string, unknown> = {};\n\n  for (const [key, value] of Object.entries(headers)) {\n    const lower = key.toLowerCase();\n    if (lower === \"authorization\" || lower === \"cookie\" || lower === \"set-cookie\") {\n      result[key] = \"<redacted>\";\n      continue;\n    }\n\n    result[key] = value;\n  }\n\n  return result;\n}\n\nfunction extractRequestContext(interceptorOptions: unknown): RequestContext {\n  if (!isRecord(interceptorOptions)) {\n    return {};\n  }\n\n  const prefix =\n    typeof interceptorOptions.prefix === \"string\" ? interceptorOptions.prefix : undefined;\n  const request = isRecord(interceptorOptions.request) ? interceptorOptions.request : undefined;\n\n  const method = request && typeof request.method === \"string\" ? request.method : undefined;\n\n  const urlRaw = request ? request.url : undefined;\n  const url =\n    urlRaw instanceof URL ? urlRaw.toString() : typeof urlRaw === \"string\" ? urlRaw : undefined;\n\n  const path = urlRaw instanceof URL ? `${urlRaw.pathname}${urlRaw.search}` : undefined;\n\n  const headers = request ? redactHeaders(request.headers) : undefined;\n\n  return {\n    method,\n    url,\n    path,\n    prefix,\n    headers,\n  };\n}\n\ninterface JsonSafeOptions {\n  depth: number;\n  seen: WeakSet<object>;\n}\n\nfunction toJsonSafe(value: unknown, options: JsonSafeOptions): unknown {\n  if (value === undefined) {\n    return null;\n  }\n\n  if (value === null) {\n    return null;\n  }\n\n  if (typeof value === \"bigint\") {\n    return value.toString();\n  }\n\n  if (typeof value === \"function\") {\n    return `[Function${value.name ? ` ${value.name}` : \"\"}]`;\n  }\n\n  if (typeof value === \"symbol\") {\n    return value.toString();\n  }\n\n  if (value instanceof URL) {\n    return value.toString();\n  }\n\n  if (value instanceof Date) {\n    return value.toISOString();\n  }\n\n  if (value instanceof Error) {\n    return {\n      name: value.name,\n      message: value.message,\n      stack: value.stack,\n      cause:\n        options.depth > 0\n          ? toJsonSafe(value.cause, { ...options, depth: options.depth - 1 })\n          : undefined,\n    };\n  }\n\n  if (Array.isArray(value)) {\n    if (options.depth <= 0) {\n      return `Array(${value.length})`;\n    }\n\n    return value\n      .slice(0, 100)\n      .map((entry) => toJsonSafe(entry, { ...options, depth: options.depth - 1 }));\n  }\n\n  if (isPlainObject(value)) {\n    if (options.seen.has(value)) {\n      return \"[Circular]\";\n    }\n\n    if (options.depth <= 0) {\n      return `Object(${Object.keys(value).length})`;\n    }\n\n    options.seen.add(value);\n\n    const out: Record<string, unknown> = {};\n    const entries = Object.entries(value);\n\n    for (const [key, entry] of entries.slice(0, 200)) {\n      out[key] = toJsonSafe(entry, { ...options, depth: options.depth - 1 });\n    }\n\n    if (entries.length > 200) {\n      out.__truncated__ = `+${entries.length - 200} keys`;\n    }\n\n    return out;\n  }\n\n  return value;\n}\n\nfunction summarizeForLogs(value: unknown, depth = 1): string {\n  if (value === undefined) {\n    return \"undefined\";\n  }\n\n  if (value === null) {\n    return \"null\";\n  }\n\n  if (typeof value === \"string\") {\n    const trimmed = value.length > 300 ? `${value.slice(0, 300)}…` : value;\n    return JSON.stringify(trimmed);\n  }\n\n  if (typeof value === \"number\" || typeof value === \"boolean\" || typeof value === \"bigint\") {\n    return String(value);\n  }\n\n  if (value instanceof URL) {\n    return value.toString();\n  }\n\n  if (value instanceof Date) {\n    return value.toISOString();\n  }\n\n  if (Array.isArray(value)) {\n    return `Array(${value.length})`;\n  }\n\n  if (isPlainObject(value)) {\n    const keys = Object.keys(value);\n\n    if (depth <= 0) {\n      return `Object(${keys.length})`;\n    }\n\n    const preview = keys.slice(0, 10).map((key) => {\n      const entry = value[key];\n      return `${key}: ${summarizeForLogs(entry, depth - 1)}`;\n    });\n\n    const suffix = keys.length > 10 ? \", …\" : \"\";\n    return `{ ${preview.join(\", \")}${suffix} }`;\n  }\n\n  // Fallback for non-plain objects.\n  return inspect(value, { depth: 3, maxArrayLength: 50, breakLength: 120 });\n}\n\nfunction isIssue(value: unknown): value is StandardSchemaV1.Issue {\n  return isRecord(value) && typeof value.message === \"string\";\n}\n\nfunction formatIssuePath(path: StandardSchemaV1.Issue[\"path\"]): string {\n  if (!path || path.length === 0) {\n    return \"<root>\";\n  }\n\n  const parts: string[] = [];\n\n  for (const segment of path) {\n    const key =\n      typeof segment === \"object\" && segment !== null && \"key\" in segment\n        ? (segment as { key: PropertyKey }).key\n        : segment;\n\n    if (typeof key === \"number\") {\n      parts.push(`[${key}]`);\n      continue;\n    }\n\n    if (typeof key === \"string\") {\n      const isIdentifier = /^[A-Za-z_$][A-Za-z0-9_$]*$/.test(key);\n      if (parts.length === 0) {\n        parts.push(isIdentifier ? key : `[${JSON.stringify(key)}]`);\n      } else {\n        parts.push(isIdentifier ? `.${key}` : `[${JSON.stringify(key)}]`);\n      }\n      continue;\n    }\n\n    const rendered = typeof key === \"symbol\" ? key.toString() : String(key);\n    parts.push(parts.length === 0 ? `[${rendered}]` : `[${rendered}]`);\n  }\n\n  return parts.join(\"\");\n}\n\nfunction getValidationErrorInfo(\n  cause: unknown\n): { message?: string; issues: readonly StandardSchemaV1.Issue[]; data: unknown } | null {\n  if (cause instanceof ValidationError) {\n    return {\n      message: cause.message,\n      issues: cause.issues,\n      data: cause.data,\n    };\n  }\n\n  if (!isRecord(cause) || !isUnknownArray(cause.issues)) {\n    return null;\n  }\n\n  const issues = cause.issues.filter(isIssue);\n\n  return {\n    message: typeof cause.message === \"string\" ? cause.message : undefined,\n    issues,\n    data: \"data\" in cause ? cause.data : undefined,\n  };\n}\n\nfunction formatUnknown(value: unknown): string {\n  if (value instanceof Error) {\n    return value.stack ?? `${value.name}: ${value.message}`;\n  }\n\n  return inspect(value, { depth: 5, maxArrayLength: 50, breakLength: 120 });\n}\n\nexport function formatOrpcError(error: unknown, interceptorOptions?: unknown): FormattedOrpcError {\n  try {\n    const requestContext = extractRequestContext(interceptorOptions);\n    const where =\n      requestContext.method && requestContext.path\n        ? `${requestContext.method} ${requestContext.path}`\n        : (requestContext.path ?? requestContext.url);\n\n    const whereSuffix = where ? ` ${where}` : \"\";\n\n    const debugDump: Record<string, unknown> = {\n      request: requestContext,\n    };\n\n    if (error instanceof ORPCError) {\n      const code = typeof error.code === \"string\" ? error.code : String(error.code);\n      const status = typeof error.status === \"number\" ? error.status : undefined;\n\n      debugDump.error = {\n        type: \"ORPCError\",\n        code,\n        status,\n        message: error.message,\n        data: toJsonSafe(error.data, { depth: 6, seen: new WeakSet() }),\n        stack: error.stack,\n      };\n\n      const validation = getValidationErrorInfo(error.cause);\n      if (validation) {\n        debugDump.cause = {\n          type: \"ValidationError\",\n          message: validation.message,\n          issues: toJsonSafe(validation.issues, { depth: 6, seen: new WeakSet() }),\n          data: toJsonSafe(validation.data, { depth: 6, seen: new WeakSet() }),\n        };\n\n        const lines: string[] = [];\n        lines.push(\n          `ORPC${whereSuffix}: ${code} ${error.message}${\n            status !== undefined ? ` (status ${status})` : \"\"\n          }`\n        );\n\n        if (validation.issues.length > 0) {\n          const maxIssues = 5;\n          lines.push(`Validation issues (${validation.issues.length}):`);\n\n          for (const issue of validation.issues.slice(0, maxIssues)) {\n            const path = formatIssuePath(issue.path);\n            lines.push(`  - ${path}: ${issue.message}`);\n          }\n\n          if (validation.issues.length > maxIssues) {\n            lines.push(`  (+${validation.issues.length - maxIssues} more)`);\n          }\n        }\n\n        lines.push(`Data: ${summarizeForLogs(validation.data, 1)}`);\n\n        return {\n          message: lines.join(\"\\n\"),\n          debugDump,\n        };\n      }\n\n      // Non-validation ORPC error.\n      debugDump.cause = toJsonSafe(error.cause, { depth: 6, seen: new WeakSet() });\n\n      return {\n        message: `ORPC${whereSuffix}: ${code} ${error.message}${\n          status !== undefined ? ` (status ${status})` : \"\"\n        }`,\n        debugDump,\n      };\n    }\n\n    // Unknown error shape.\n    debugDump.error = toJsonSafe(error, { depth: 6, seen: new WeakSet() });\n\n    return {\n      message: `ORPC${whereSuffix}: ${formatUnknown(error)}`,\n      debugDump,\n    };\n  } catch (formatError) {\n    // Best-effort: formatting should never crash the server.\n    const fallback = `ORPC: Failed to format error: ${formatUnknown(formatError)}\\nOriginal error: ${formatUnknown(error)}`;\n\n    return {\n      message: fallback,\n      debugDump: {\n        formatError: toJsonSafe(formatError, { depth: 4, seen: new WeakSet() }),\n        originalError: toJsonSafe(error, { depth: 4, seen: new WeakSet() }),\n      },\n    };\n  }\n}\n"]}