{"version":3,"file":"project.js","sourceRoot":"","sources":["../../../../src/common/orpc/schemas/project.ts"],"names":[],"mappings":"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","sourcesContent":["import { z } from \"zod\";\r\nimport { RuntimeConfigSchema } from \"./runtime\";\r\nimport { WorkspaceMCPOverridesSchema } from \"./mcp\";\r\nimport { WorkspaceAISettingsByAgentSchema, WorkspaceAISettingsSchema } from \"./workspaceAiSettings\";\r\n\r\nconst ThinkingLevelSchema = z.enum([\"off\", \"low\", \"medium\", \"high\", \"xhigh\", \"max\"]);\r\n\r\n/**\r\n * Section schema for organizing workspaces within a project.\r\n * Sections are project-scoped and persist to config.json.\r\n */\r\nexport const SectionConfigSchema = z.object({\r\n  id: z.string().meta({\r\n    description: \"Unique section ID (8 hex chars)\",\r\n  }),\r\n  name: z.string().meta({\r\n    description: \"Display name for the section\",\r\n  }),\r\n  color: z.string().optional().meta({\r\n    description: \"Accent color (hex value like #ff6b6b or preset name)\",\r\n  }),\r\n  nextId: z.string().nullable().optional().meta({\r\n    description: \"ID of the next section in display order (null = last, undefined treated as null)\",\r\n  }),\r\n});\r\n\r\nexport const WorkspaceConfigSchema = z.object({\r\n  path: z.string().meta({\r\n    description: \"Absolute path to workspace directory - REQUIRED for backward compatibility\",\r\n  }),\r\n  id: z.string().optional().meta({\r\n    description: \"Stable workspace ID (10 hex chars for new workspaces) - optional for legacy\",\r\n  }),\r\n  name: z.string().optional().meta({\r\n    description: 'Git branch / directory name (e.g., \"plan-a1b2\") - optional for legacy',\r\n  }),\r\n  title: z.string().optional().meta({\r\n    description:\r\n      'Human-readable workspace title (e.g., \"Fix plan mode over SSH\") - optional for legacy',\r\n  }),\r\n  createdAt: z\r\n    .string()\r\n    .optional()\r\n    .meta({ description: \"ISO 8601 creation timestamp - optional for legacy\" }),\r\n  aiSettingsByAgent: WorkspaceAISettingsByAgentSchema.optional().meta({\r\n    description: \"Per-agent workspace-scoped AI settings\",\r\n  }),\r\n  runtimeConfig: RuntimeConfigSchema.optional().meta({\r\n    description: \"Runtime configuration (local vs SSH) - optional, defaults to local\",\r\n  }),\r\n  aiSettings: WorkspaceAISettingsSchema.optional().meta({\r\n    description: \"Workspace-scoped AI settings (model + thinking level)\",\r\n  }),\r\n  parentWorkspaceId: z.string().optional().meta({\r\n    description:\r\n      \"If set, this workspace is a child workspace spawned from the parent workspaceId (enables nesting in UI and backend orchestration).\",\r\n  }),\r\n  agentType: z.string().optional().meta({\r\n    description: 'If set, selects an agent preset for this workspace (e.g., \"explore\" or \"exec\").',\r\n  }),\r\n  agentId: z.string().optional().meta({\r\n    description:\r\n      'If set, selects an agent definition for this workspace (e.g., \"explore\" or \"exec\").',\r\n  }),\r\n  taskStatus: z.enum([\"queued\", \"running\", \"awaiting_report\", \"reported\"]).optional().meta({\r\n    description:\r\n      \"Agent task lifecycle status for child workspaces (queued|running|awaiting_report|reported).\",\r\n  }),\r\n  reportedAt: z.string().optional().meta({\r\n    description: \"ISO 8601 timestamp for when an agent task reported completion (optional).\",\r\n  }),\r\n  taskModelString: z.string().optional().meta({\r\n    description: \"Model string used to run this agent task (used for restart-safe resumptions).\",\r\n  }),\r\n  taskThinkingLevel: ThinkingLevelSchema.optional().meta({\r\n    description: \"Thinking level used for this agent task (used for restart-safe resumptions).\",\r\n  }),\r\n  taskPrompt: z.string().optional().meta({\r\n    description:\r\n      \"Initial prompt for a queued agent task (persisted only until the task actually starts).\",\r\n  }),\r\n  taskExperiments: z\r\n    .object({\r\n      programmaticToolCalling: z.boolean().optional(),\r\n      programmaticToolCallingExclusive: z.boolean().optional(),\r\n      execSubagentHardRestart: z.boolean().optional(),\r\n    })\r\n    .optional()\r\n    .meta({\r\n      description: \"Experiments inherited from parent for restart-safe resumptions.\",\r\n    }),\r\n  taskBaseCommitSha: z.string().optional().meta({\r\n    description:\r\n      \"Git commit SHA this agent task workspace started from (used for generating git-format-patch artifacts).\",\r\n  }),\r\n  taskTrunkBranch: z.string().optional().meta({\r\n    description:\r\n      \"Trunk branch used to create/init this agent task workspace (used for restart-safe init on queued tasks).\",\r\n  }),\r\n  mcp: WorkspaceMCPOverridesSchema.optional().meta({\r\n    description:\r\n      \"LEGACY: Per-workspace MCP overrides (migrated to <workspace>/.mux/mcp.local.jsonc)\",\r\n  }),\r\n  archivedAt: z.string().optional().meta({\r\n    description:\r\n      \"ISO 8601 timestamp when workspace was last archived. Workspace is considered archived if archivedAt > unarchivedAt (or unarchivedAt is absent).\",\r\n  }),\r\n  unarchivedAt: z.string().optional().meta({\r\n    description:\r\n      \"ISO 8601 timestamp when workspace was last unarchived. Used for recency calculation to bump restored workspaces to top.\",\r\n  }),\r\n  sectionId: z.string().optional().meta({\r\n    description: \"ID of the section this workspace belongs to (optional, unsectioned if absent)\",\r\n  }),\r\n});\r\n\r\nexport const ProjectConfigSchema = z.object({\r\n  workspaces: z.array(WorkspaceConfigSchema),\r\n  sections: z.array(SectionConfigSchema).optional().meta({\r\n    description: \"Sections for organizing workspaces within this project\",\r\n  }),\r\n  idleCompactionHours: z.number().min(1).nullable().optional().meta({\r\n    description:\r\n      \"Hours of inactivity before auto-compacting workspaces. null/undefined = disabled.\",\r\n  }),\r\n});\r\n"]}