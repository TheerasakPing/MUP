{"version":3,"file":"runtime.test.js","sourceRoot":"","sources":["../../../../src/common/orpc/schemas/runtime.test.ts"],"names":[],"mappings":"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","sourcesContent":["import { describe, expect, test } from \"bun:test\";\r\nimport { RuntimeAvailabilityStatusSchema } from \"./runtime\";\r\nimport { getDevcontainerConfigs, type RuntimeAvailabilityStatus } from \"@/common/types/runtime\";\r\n\r\ndescribe(\"RuntimeAvailabilityStatusSchema\", () => {\r\n  test(\"preserves configs field when parsing devcontainer availability\", () => {\r\n    const input = {\r\n      available: true,\r\n      configs: [\r\n        { path: \".devcontainer/devcontainer.json\", label: \"Default\" },\r\n        { path: \".devcontainer/backend/devcontainer.json\", label: \"Backend\" },\r\n      ],\r\n      cliVersion: \"0.81.1\",\r\n    };\r\n\r\n    const result = RuntimeAvailabilityStatusSchema.parse(input);\r\n\r\n    expect(result.available).toBe(true);\r\n    expect(\"configs\" in result).toBe(true);\r\n    if (\"configs\" in result) {\r\n      expect(result.configs).toHaveLength(2);\r\n      expect(result.configs[0].path).toBe(\".devcontainer/devcontainer.json\");\r\n      expect(result.configs[1].path).toBe(\".devcontainer/backend/devcontainer.json\");\r\n    }\r\n    expect(\"cliVersion\" in result && result.cliVersion).toBe(\"0.81.1\");\r\n  });\r\n\r\n  test(\"parses plain available status without configs\", () => {\r\n    const input = { available: true };\r\n\r\n    const result = RuntimeAvailabilityStatusSchema.parse(input);\r\n\r\n    expect(result.available).toBe(true);\r\n    expect(\"configs\" in result).toBe(false);\r\n  });\r\n\r\n  test(\"parses unavailable status with reason\", () => {\r\n    const input = { available: false, reason: \"Docker daemon not running\" };\r\n\r\n    const result = RuntimeAvailabilityStatusSchema.parse(input);\r\n\r\n    expect(result.available).toBe(false);\r\n    if (!result.available) {\r\n      expect(result.reason).toBe(\"Docker daemon not running\");\r\n    }\r\n  });\r\n});\r\n\r\ndescribe(\"getDevcontainerConfigs\", () => {\r\n  test(\"extracts configs from availability status with configs\", () => {\r\n    const status: RuntimeAvailabilityStatus = {\r\n      available: true,\r\n      configs: [\r\n        { path: \".devcontainer/devcontainer.json\", label: \"Default\" },\r\n        { path: \".devcontainer/backend/devcontainer.json\", label: \"Backend\" },\r\n      ],\r\n      cliVersion: \"0.81.1\",\r\n    };\r\n\r\n    const configs = getDevcontainerConfigs(status);\r\n\r\n    expect(configs).toHaveLength(2);\r\n    expect(configs[0].path).toBe(\".devcontainer/devcontainer.json\");\r\n  });\r\n\r\n  test(\"returns empty array for plain available status\", () => {\r\n    const status: RuntimeAvailabilityStatus = { available: true };\r\n\r\n    const configs = getDevcontainerConfigs(status);\r\n\r\n    expect(configs).toEqual([]);\r\n  });\r\n\r\n  test(\"returns empty array for unavailable status\", () => {\r\n    const status: RuntimeAvailabilityStatus = {\r\n      available: false,\r\n      reason: \"No devcontainer.json found\",\r\n    };\r\n\r\n    const configs = getDevcontainerConfigs(status);\r\n\r\n    expect(configs).toEqual([]);\r\n  });\r\n});\r\n"]}