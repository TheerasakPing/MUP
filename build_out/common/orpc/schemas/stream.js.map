{"version":3,"file":"stream.js","sourceRoot":"","sources":["../../../../src/common/orpc/schemas/stream.ts"],"names":[],"mappings":";;;AAAA,6BAAwB;AACxB,uDAAkD;AAClD,2CAAmD;AACnD,mDAAuD;AACvD,2CAAqD;uGAA5C,kCAAsB;AAC/B,qCAAiD;AACjD,uCAMmB;AACnB,uDAA6D;AAC7D,uCAA8C;AAE9C,cAAc;AAEd,0EAA0E;AAC7D,QAAA,oBAAoB,GAAG,OAAC,CAAC,MAAM,CAAC;IAC3C,IAAI,EAAE,OAAC,CAAC,OAAO,CAAC,WAAW,CAAC;CAC7B,CAAC,CAAC;AACU,QAAA,qBAAqB,GAAG,OAAC,CAAC,MAAM,CAAC;IAC5C,IAAI,EAAE,OAAC,CAAC,OAAO,CAAC,WAAW,CAAC;CAC7B,CAAC,CAAC;AAEH,iFAAiF;AAEjF;;;;GAIG;AACU,QAAA,wBAAwB,GAAG,OAAC,CAAC,MAAM,CAAC;IAC/C,IAAI,EAAE,OAAC,CAAC,OAAO,CAAC,gBAAgB,CAAC;IACjC,WAAW,EAAE,OAAC,CAAC,MAAM,EAAE;IACvB,KAAK,EAAE,OAAC,CAAC,IAAI,CAAC,CAAC,UAAU,EAAE,UAAU,EAAE,SAAS,EAAE,OAAO,EAAE,OAAO,CAAC,CAAC;IACpE,WAAW,EAAE,2BAAiB;IAC9B,MAAM,EAAE,OAAC,CAAC,MAAM,EAAE,CAAC,QAAQ,EAAE,EAAE,2DAA2D;CAC3F,CAAC,CAAC;AAEU,QAAA,+BAA+B,GAAG,OAAC,CAAC,MAAM,CAAC;IACtD,IAAI,EAAE,OAAC,CAAC,OAAO,CAAC,wBAAwB,CAAC;CAC1C,CAAC,CAAC;AAEU,QAAA,wBAAwB,GAAG,OAAC,CAAC,MAAM,CAAC;IAC/C,IAAI,EAAE,OAAC,CAAC,OAAO,CAAC,cAAc,CAAC;IAC/B,SAAS,EAAE,OAAC,CAAC,MAAM,EAAE;IACrB,KAAK,EAAE,OAAC,CAAC,MAAM,EAAE;IACjB,SAAS,EAAE,8BAAqB;CACjC,CAAC,CAAC;AAEU,QAAA,mBAAmB,GAAG,OAAC,CAAC,MAAM,CAAC;IAC1C,IAAI,EAAE,OAAC,CAAC,OAAO,CAAC,QAAQ,CAAC;IACzB,gBAAgB,EAAE,OAAC,CAAC,KAAK,CAAC,OAAC,CAAC,MAAM,EAAE,CAAC;CACtC,CAAC,CAAC;AAEH,MAAM,mBAAmB,GAAG,OAAC,CAAC,IAAI,CAAC,0BAAe,CAAC,CAAC;AAEvC,QAAA,sBAAsB,GAAG,OAAC,CAAC,MAAM,CAAC;IAC7C,IAAI,EAAE,OAAC,CAAC,OAAO,CAAC,cAAc,CAAC;IAC/B,WAAW,EAAE,OAAC,CAAC,MAAM,EAAE;IACvB,SAAS,EAAE,OAAC,CAAC,MAAM,EAAE;IACrB,MAAM,EAAE,OAAC;SACN,OAAO,EAAE;SACT,QAAQ,EAAE;SACV,IAAI,CAAC,EAAE,WAAW,EAAE,sDAAsD,EAAE,CAAC;IAChF,KAAK,EAAE,OAAC,CAAC,MAAM,EAAE;IACjB,oBAAoB,EAAE,OAAC,CAAC,OAAO,EAAE,CAAC,QAAQ,EAAE;IAC5C,eAAe,EAAE,OAAC,CAAC,MAAM,EAAE,CAAC,IAAI,CAAC;QAC/B,WAAW,EAAE,yCAAyC;KACvD,CAAC;IACF,SAAS,EAAE,OAAC,CAAC,MAAM,EAAE,CAAC,IAAI,CAAC;QACzB,WAAW,EAAE,oDAAoD;KAClE,CAAC;IACF,IAAI,EAAE,sBAAe,CAAC,QAAQ,EAAE,CAAC,KAAK,CAAC,SAAS,CAAC,CAAC,IAAI,CAAC;QACrD,WAAW,EAAE,yDAAyD;KACvE,CAAC;IACF,OAAO,EAAE,+BAAa,CAAC,QAAQ,EAAE,CAAC,KAAK,CAAC,SAAS,CAAC,CAAC,IAAI,CAAC;QACtD,WAAW,EAAE,0BAA0B;KACxC,CAAC;IACF,aAAa,EAAE,mBAAmB,CAAC,QAAQ,EAAE,CAAC,IAAI,CAAC;QACjD,WAAW,EAAE,sDAAsD;KACpE,CAAC;CACH,CAAC,CAAC;AAEU,QAAA,sBAAsB,GAAG,OAAC,CAAC,MAAM,CAAC;IAC7C,IAAI,EAAE,OAAC,CAAC,OAAO,CAAC,cAAc,CAAC;IAC/B,WAAW,EAAE,OAAC,CAAC,MAAM,EAAE;IACvB,SAAS,EAAE,OAAC,CAAC,MAAM,EAAE;IACrB,MAAM,EAAE,OAAC;SACN,OAAO,EAAE;SACT,QAAQ,EAAE;SACV,IAAI,CAAC,EAAE,WAAW,EAAE,sDAAsD,EAAE,CAAC;IAChF,KAAK,EAAE,OAAC,CAAC,MAAM,EAAE;IACjB,MAAM,EAAE,OAAC,CAAC,MAAM,EAAE,CAAC,IAAI,CAAC;QACtB,WAAW,EAAE,4BAA4B;KAC1C,CAAC;IACF,SAAS,EAAE,OAAC,CAAC,MAAM,EAAE,CAAC,IAAI,CAAC;QACzB,WAAW,EAAE,sCAAsC;KACpD,CAAC;CACH,CAAC,CAAC;AAEU,QAAA,0BAA0B,GAAG,OAAC,CAAC,kBAAkB,CAAC,MAAM,EAAE;IACrE,gCAAsB;IACtB,2BAAiB;IACjB,2BAAiB;CAClB,CAAC,CAAC;AAEH,2DAA2D;AAC3D,6GAA6G;AAC7G,qFAAqF;AACxE,QAAA,0BAA0B,GAAG,OAAC,CAAC,MAAM,CAAC;IACjD,WAAW,EAAE,OAAC;SACX,KAAK,CAAC,CAAC,OAAC,CAAC,MAAM,EAAE,EAAE,OAAC,CAAC,SAAS,EAAE,CAAC,CAAC;SAClC,IAAI,CAAC,EAAE,WAAW,EAAE,iCAAiC,EAAE,CAAC;IAC3D,YAAY,EAAE,OAAC;SACZ,KAAK,CAAC,CAAC,OAAC,CAAC,MAAM,EAAE,EAAE,OAAC,CAAC,SAAS,EAAE,CAAC,CAAC;SAClC,IAAI,CAAC,EAAE,WAAW,EAAE,kCAAkC,EAAE,CAAC;IAC5D,WAAW,EAAE,OAAC,CAAC,KAAK,CAAC,CAAC,OAAC,CAAC,MAAM,EAAE,EAAE,OAAC,CAAC,SAAS,EAAE,CAAC,CAAC,CAAC,IAAI,CAAC;QACrD,WAAW,EACT,6GAA6G;KAChH,CAAC;IACF,eAAe,EAAE,OAAC;SACf,MAAM,EAAE;SACR,QAAQ,EAAE;SACV,IAAI,CAAC,EAAE,WAAW,EAAE,qCAAqC,EAAE,CAAC;IAC/D,iBAAiB,EAAE,OAAC;SACjB,MAAM,EAAE;SACR,QAAQ,EAAE;SACV,IAAI,CAAC,EAAE,WAAW,EAAE,mCAAmC,EAAE,CAAC;CAC9D,CAAC,CAAC;AAEU,QAAA,oBAAoB,GAAG,OAAC,CAAC,MAAM,CAAC;IAC3C,IAAI,EAAE,OAAC,CAAC,OAAO,CAAC,YAAY,CAAC;IAC7B,WAAW,EAAE,OAAC,CAAC,MAAM,EAAE;IACvB,SAAS,EAAE,OAAC,CAAC,MAAM,EAAE;IACrB,QAAQ,EAAE,OAAC;SACR,MAAM,CAAC;QACN,KAAK,EAAE,OAAC,CAAC,MAAM,EAAE;QACjB,aAAa,EAAE,mBAAmB,CAAC,QAAQ,EAAE;QAC7C,oBAAoB,EAAE,OAAC,CAAC,OAAO,EAAE,CAAC,QAAQ,EAAE;QAC5C,sDAAsD;QACtD,KAAK,EAAE,QAAA,0BAA0B,CAAC,QAAQ,EAAE;QAC5C,2FAA2F;QAC3F,YAAY,EAAE,QAAA,0BAA0B,CAAC,QAAQ,EAAE;QACnD,uEAAuE;QACvE,gBAAgB,EAAE,OAAC,CAAC,MAAM,CAAC,OAAC,CAAC,MAAM,EAAE,EAAE,OAAC,CAAC,OAAO,EAAE,CAAC,CAAC,QAAQ,EAAE;QAC9D,mEAAmE;QACnE,uBAAuB,EAAE,OAAC,CAAC,MAAM,CAAC,OAAC,CAAC,MAAM,EAAE,EAAE,OAAC,CAAC,OAAO,EAAE,CAAC,CAAC,QAAQ,EAAE;QACrE,QAAQ,EAAE,OAAC,CAAC,MAAM,EAAE,CAAC,QAAQ,EAAE;QAC/B,mBAAmB,EAAE,OAAC,CAAC,MAAM,EAAE,CAAC,QAAQ,EAAE;QAC1C,eAAe,EAAE,OAAC,CAAC,MAAM,EAAE,CAAC,QAAQ,EAAE,CAAC,IAAI,CAAC;YAC1C,WAAW,EAAE,mCAAmC;SACjD,CAAC;QACF,SAAS,EAAE,OAAC,CAAC,MAAM,EAAE,CAAC,QAAQ,EAAE,CAAC,IAAI,CAAC;YACpC,WAAW,EAAE,mCAAmC;SACjD,CAAC;KACH,CAAC;SACD,IAAI,CAAC;QACJ,WAAW,EAAE,wEAAwE;KACtF,CAAC;IACJ,KAAK,EAAE,OAAC,CAAC,KAAK,CAAC,QAAA,0BAA0B,CAAC,CAAC,IAAI,CAAC;QAC9C,WAAW,EAAE,4EAA4E;KAC1F,CAAC;CACH,CAAC,CAAC;AAEU,QAAA,uBAAuB,GAAG,OAAC,CAAC,IAAI,CAAC,CAAC,MAAM,EAAE,SAAS,EAAE,QAAQ,CAAC,CAAC,CAAC;AAEhE,QAAA,sBAAsB,GAAG,OAAC,CAAC,MAAM,CAAC;IAC7C,IAAI,EAAE,OAAC,CAAC,OAAO,CAAC,cAAc,CAAC;IAC/B,WAAW,EAAE,OAAC,CAAC,MAAM,EAAE;IACvB,SAAS,EAAE,OAAC,CAAC,MAAM,EAAE;IACrB,WAAW,EAAE,QAAA,uBAAuB,CAAC,QAAQ,EAAE;IAC/C,QAAQ,EAAE,OAAC;SACR,MAAM,CAAC;QACN,sDAAsD;QACtD,KAAK,EAAE,QAAA,0BAA0B,CAAC,QAAQ,EAAE;QAC5C,sFAAsF;QACtF,YAAY,EAAE,QAAA,0BAA0B,CAAC,QAAQ,EAAE;QACnD,8DAA8D;QAC9D,gBAAgB,EAAE,OAAC,CAAC,MAAM,CAAC,OAAC,CAAC,MAAM,EAAE,EAAE,OAAC,CAAC,OAAO,EAAE,CAAC,CAAC,QAAQ,EAAE;QAC9D,mEAAmE;QACnE,uBAAuB,EAAE,OAAC,CAAC,MAAM,CAAC,OAAC,CAAC,MAAM,EAAE,EAAE,OAAC,CAAC,OAAO,EAAE,CAAC,CAAC,QAAQ,EAAE;QACrE,QAAQ,EAAE,OAAC,CAAC,MAAM,EAAE,CAAC,QAAQ,EAAE;KAChC,CAAC;SACD,QAAQ,EAAE;SACV,IAAI,CAAC;QACJ,WAAW,EAAE,gFAAgF;KAC9F,CAAC;IACJ,cAAc,EAAE,OAAC,CAAC,OAAO,EAAE,CAAC,QAAQ,EAAE;CACvC,CAAC,CAAC;AAEU,QAAA,wBAAwB,GAAG,OAAC,CAAC,MAAM,CAAC;IAC/C,IAAI,EAAE,OAAC,CAAC,OAAO,CAAC,iBAAiB,CAAC;IAClC,WAAW,EAAE,OAAC,CAAC,MAAM,EAAE;IACvB,SAAS,EAAE,OAAC,CAAC,MAAM,EAAE;IACrB,MAAM,EAAE,OAAC;SACN,OAAO,EAAE;SACT,QAAQ,EAAE;SACV,IAAI,CAAC,EAAE,WAAW,EAAE,sDAAsD,EAAE,CAAC;IAChF,UAAU,EAAE,OAAC,CAAC,MAAM,EAAE;IACtB,QAAQ,EAAE,OAAC,CAAC,MAAM,EAAE;IACpB,IAAI,EAAE,OAAC,CAAC,OAAO,EAAE;IACjB,MAAM,EAAE,OAAC,CAAC,MAAM,EAAE,CAAC,IAAI,CAAC,EAAE,WAAW,EAAE,4BAA4B,EAAE,CAAC;IACtE,SAAS,EAAE,OAAC,CAAC,MAAM,EAAE,CAAC,IAAI,CAAC,EAAE,WAAW,EAAE,qCAAqC,EAAE,CAAC;IAClF,gBAAgB,EAAE,OAAC,CAAC,MAAM,EAAE,CAAC,QAAQ,EAAE,CAAC,IAAI,CAAC,EAAE,WAAW,EAAE,0BAA0B,EAAE,CAAC;CAC1F,CAAC,CAAC;AAEU,QAAA,wBAAwB,GAAG,OAAC,CAAC,MAAM,CAAC;IAC/C,IAAI,EAAE,OAAC,CAAC,OAAO,CAAC,iBAAiB,CAAC;IAClC,WAAW,EAAE,OAAC,CAAC,MAAM,EAAE;IACvB,SAAS,EAAE,OAAC,CAAC,MAAM,EAAE;IACrB,MAAM,EAAE,OAAC;SACN,OAAO,EAAE;SACT,QAAQ,EAAE;SACV,IAAI,CAAC,EAAE,WAAW,EAAE,sDAAsD,EAAE,CAAC;IAChF,UAAU,EAAE,OAAC,CAAC,MAAM,EAAE;IACtB,QAAQ,EAAE,OAAC,CAAC,MAAM,EAAE;IACpB,KAAK,EAAE,OAAC,CAAC,OAAO,EAAE;IAClB,MAAM,EAAE,OAAC,CAAC,MAAM,EAAE,CAAC,IAAI,CAAC,EAAE,WAAW,EAAE,4BAA4B,EAAE,CAAC;IACtE,SAAS,EAAE,OAAC,CAAC,MAAM,EAAE,CAAC,IAAI,CAAC,EAAE,WAAW,EAAE,sCAAsC,EAAE,CAAC;CACpF,CAAC,CAAC;AAEH;;;;;GAKG;AACU,QAAA,qBAAqB,GAAG,OAAC,CAAC,MAAM,CAAC;IAC5C,IAAI,EAAE,OAAC,CAAC,OAAO,CAAC,aAAa,CAAC;IAC9B,WAAW,EAAE,OAAC,CAAC,MAAM,EAAE;IACvB,UAAU,EAAE,OAAC,CAAC,MAAM,EAAE;IACtB,KAAK,EAAE,OAAC;SACL,IAAI,CAAC,CAAC,QAAQ,EAAE,WAAW,CAAC,CAAC;SAC7B,QAAQ,EAAE;SACV,IAAI,CAAC,EAAE,WAAW,EAAE,+BAA+B,EAAE,CAAC;IACzD,IAAI,EAAE,OAAC,CAAC,MAAM,EAAE;IAChB,OAAO,EAAE,OAAC,CAAC,OAAO,EAAE,CAAC,IAAI,CAAC,EAAE,WAAW,EAAE,mCAAmC,EAAE,CAAC;IAC/E,SAAS,EAAE,OAAC,CAAC,MAAM,EAAE,CAAC,IAAI,CAAC,EAAE,WAAW,EAAE,sCAAsC,EAAE,CAAC;CACpF,CAAC,CAAC;AAEH;;;;;;GAMG;AACU,QAAA,sBAAsB,GAAG,OAAC,CAAC,MAAM,CAAC;IAC7C,IAAI,EAAE,OAAC,CAAC,OAAO,CAAC,cAAc,CAAC;IAC/B,WAAW,EAAE,OAAC,CAAC,MAAM,EAAE;IACvB,UAAU,EAAE,OAAC,CAAC,MAAM,EAAE;IACtB,MAAM,EAAE,OAAC,CAAC,MAAM,EAAE;IAClB,SAAS,EAAE,OAAC,CAAC,MAAM,EAAE,CAAC,IAAI,CAAC,EAAE,WAAW,EAAE,wCAAwC,EAAE,CAAC;CACtF,CAAC,CAAC;AAEU,QAAA,sBAAsB,GAAG,OAAC,CAAC,MAAM,CAAC;IAC7C,IAAI,EAAE,OAAC,CAAC,OAAO,CAAC,eAAe,CAAC;IAChC,WAAW,EAAE,OAAC,CAAC,MAAM,EAAE;IACvB,SAAS,EAAE,OAAC,CAAC,MAAM,EAAE;IACrB,MAAM,EAAE,OAAC;SACN,OAAO,EAAE;SACT,QAAQ,EAAE;SACV,IAAI,CAAC,EAAE,WAAW,EAAE,sDAAsD,EAAE,CAAC;IAChF,UAAU,EAAE,OAAC,CAAC,MAAM,EAAE;IACtB,QAAQ,EAAE,OAAC,CAAC,MAAM,EAAE;IACpB,MAAM,EAAE,OAAC,CAAC,OAAO,EAAE;IACnB,SAAS,EAAE,OAAC,CAAC,MAAM,EAAE,CAAC,IAAI,CAAC,EAAE,WAAW,EAAE,uCAAuC,EAAE,CAAC;IACpF,gBAAgB,EAAE,OAAC,CAAC,MAAM,EAAE,CAAC,QAAQ,EAAE,CAAC,IAAI,CAAC,EAAE,WAAW,EAAE,0BAA0B,EAAE,CAAC;CAC1F,CAAC,CAAC;AAEU,QAAA,yBAAyB,GAAG,OAAC,CAAC,MAAM,CAAC;IAChD,IAAI,EAAE,OAAC,CAAC,OAAO,CAAC,iBAAiB,CAAC;IAClC,WAAW,EAAE,OAAC,CAAC,MAAM,EAAE;IACvB,SAAS,EAAE,OAAC,CAAC,MAAM,EAAE;IACrB,MAAM,EAAE,OAAC;SACN,OAAO,EAAE;SACT,QAAQ,EAAE;SACV,IAAI,CAAC,EAAE,WAAW,EAAE,sDAAsD,EAAE,CAAC;IAChF,KAAK,EAAE,OAAC,CAAC,MAAM,EAAE;IACjB,MAAM,EAAE,OAAC,CAAC,MAAM,EAAE,CAAC,IAAI,CAAC,EAAE,WAAW,EAAE,4BAA4B,EAAE,CAAC;IACtE,SAAS,EAAE,OAAC,CAAC,MAAM,EAAE,CAAC,IAAI,CAAC,EAAE,WAAW,EAAE,sCAAsC,EAAE,CAAC;IACnF,SAAS,EAAE,OAAC;SACT,MAAM,EAAE;SACR,QAAQ,EAAE;SACV,IAAI,CAAC,EAAE,WAAW,EAAE,+CAA+C,EAAE,CAAC;CAC1E,CAAC,CAAC;AAEU,QAAA,uBAAuB,GAAG,OAAC,CAAC,MAAM,CAAC;IAC9C,IAAI,EAAE,OAAC,CAAC,OAAO,CAAC,eAAe,CAAC;IAChC,WAAW,EAAE,OAAC,CAAC,MAAM,EAAE;IACvB,SAAS,EAAE,OAAC,CAAC,MAAM,EAAE;IACrB,MAAM,EAAE,OAAC;SACN,OAAO,EAAE;SACT,QAAQ,EAAE;SACV,IAAI,CAAC,EAAE,WAAW,EAAE,sDAAsD,EAAE,CAAC;CACjF,CAAC,CAAC;AAEU,QAAA,gBAAgB,GAAG,OAAC,CAAC,MAAM,CAAC;IACvC,IAAI,EAAE,OAAC,CAAC,OAAO,CAAC,OAAO,CAAC;IACxB,WAAW,EAAE,OAAC,CAAC,MAAM,EAAE;IACvB,SAAS,EAAE,OAAC,CAAC,MAAM,EAAE;IACrB,KAAK,EAAE,OAAC,CAAC,MAAM,EAAE;IACjB,SAAS,EAAE,8BAAqB,CAAC,QAAQ,EAAE;CAC5C,CAAC,CAAC;AAEH;;;GAGG;AACU,QAAA,4BAA4B,GAAG,OAAC,CAAC,MAAM,CAAC;IACnD,IAAI,EAAE,OAAC,CAAC,OAAO,CAAC,qBAAqB,CAAC;IACtC,WAAW,EAAE,OAAC,CAAC,MAAM,EAAE,CAAC,IAAI,CAAC,EAAE,WAAW,EAAE,qBAAqB,EAAE,CAAC;IACpE,iBAAiB,EAAE,OAAC,CAAC,MAAM,EAAE,CAAC,IAAI,CAAC,EAAE,WAAW,EAAE,4BAA4B,EAAE,CAAC;IACjF,YAAY,EAAE,OAAC,CAAC,MAAM,CAAC,OAAC,CAAC,MAAM,EAAE,EAAE,kCAAsB,CAAC;IAC1D,SAAS,EAAE,OAAC,CAAC,MAAM,EAAE;CACtB,CAAC,CAAC;AACU,QAAA,qBAAqB,GAAG,OAAC,CAAC,MAAM,CAAC;IAC5C,IAAI,EAAE,OAAC,CAAC,OAAO,CAAC,aAAa,CAAC;IAC9B,WAAW,EAAE,OAAC,CAAC,MAAM,EAAE;IACvB,SAAS,EAAE,OAAC,CAAC,MAAM,EAAE;IAErB,0DAA0D;IAC1D,KAAK,EAAE,QAAA,0BAA0B;IACjC,gBAAgB,EAAE,OAAC,CAAC,MAAM,CAAC,OAAC,CAAC,MAAM,EAAE,EAAE,OAAC,CAAC,OAAO,EAAE,CAAC,CAAC,QAAQ,EAAE;IAE9D,2DAA2D;IAC3D,eAAe,EAAE,QAAA,0BAA0B;IAC3C,0BAA0B,EAAE,OAAC,CAAC,MAAM,CAAC,OAAC,CAAC,MAAM,EAAE,EAAE,OAAC,CAAC,OAAO,EAAE,CAAC,CAAC,QAAQ,EAAE;CACzE,CAAC,CAAC;AAEH,6DAA6D;AAChD,QAAA,oBAAoB,GAAG,OAAC,CAAC,MAAM,CAAC;IAC3C,IAAI,EAAE,OAAC,CAAC,OAAO,CAAC,YAAY,CAAC;IAC7B,QAAQ,EAAE,OAAC,CAAC,MAAM,EAAE;IACpB,SAAS,EAAE,OAAC,CAAC,MAAM,EAAE;CACtB,CAAC,CAAC;AAEU,QAAA,qBAAqB,GAAG,OAAC,CAAC,MAAM,CAAC;IAC5C,IAAI,EAAE,OAAC,CAAC,OAAO,CAAC,aAAa,CAAC;IAC9B,IAAI,EAAE,OAAC,CAAC,MAAM,EAAE;IAChB,SAAS,EAAE,OAAC,CAAC,MAAM,EAAE;IACrB,OAAO,EAAE,OAAC,CAAC,OAAO,EAAE,CAAC,QAAQ,EAAE;CAChC,CAAC,CAAC;AAEU,QAAA,kBAAkB,GAAG,OAAC,CAAC,MAAM,CAAC;IACzC,IAAI,EAAE,OAAC,CAAC,OAAO,CAAC,UAAU,CAAC;IAC3B,QAAQ,EAAE,OAAC,CAAC,MAAM,EAAE;IACpB,SAAS,EAAE,OAAC,CAAC,MAAM,EAAE;IACrB,oFAAoF;IACpF,cAAc,EAAE,OAAC,CAAC,MAAM,EAAE,CAAC,QAAQ,EAAE;CACtC,CAAC,CAAC;AAEH,+CAA+C;AAClC,QAAA,wBAAwB,GAAG,OAAC,CAAC,kBAAkB,CAAC,MAAM,EAAE;IACnE,QAAA,oBAAoB;IACpB,QAAA,qBAAqB;IACrB,QAAA,kBAAkB;CACnB,CAAC,CAAC;AAEH,oEAAoE;AACpE,4FAA4F;AAC5F,yEAAyE;AAC5D,QAAA,oBAAoB,GAAG,0BAAgB,CAAC,MAAM,CAAC;IAC1D,IAAI,EAAE,OAAC,CAAC,OAAO,CAAC,SAAS,CAAC;CAC3B,CAAC,CAAC;AAEH,gDAAgD;AACnC,QAAA,oBAAoB,GAAG,OAAC,CAAC,MAAM,CAAC;IAC3C,QAAQ,EAAE,OAAC,CAAC,MAAM,EAAE;IACpB,SAAS,EAAE,OAAC,CAAC,MAAM,EAAE;IACrB,YAAY,EAAE,OAAC,CAAC,MAAM,EAAE;IACxB,YAAY,EAAE,OAAC,CAAC,MAAM,EAAE,CAAC,QAAQ,EAAE;IACnC,QAAQ,EAAE,OAAC,CAAC,MAAM,EAAE,CAAC,QAAQ,EAAE;IAC/B,QAAQ,EAAE,OAAC,CAAC,MAAM,EAAE,CAAC,QAAQ,EAAE;IAC/B,QAAQ,EAAE,OAAC,CAAC,MAAM,EAAE;CACrB,CAAC,CAAC;AAEU,QAAA,+BAA+B,GAAG,OAAC,CAAC,MAAM,CAAC;IACtD,IAAI,EAAE,OAAC,CAAC,OAAO,CAAC,wBAAwB,CAAC;IACzC,WAAW,EAAE,OAAC,CAAC,MAAM,EAAE;IACvB,cAAc,EAAE,OAAC,CAAC,KAAK,CAAC,OAAC,CAAC,MAAM,EAAE,CAAC;IACnC,WAAW,EAAE,OAAC,CAAC,MAAM,EAAE;IACvB,SAAS,EAAE,OAAC,CAAC,KAAK,CAAC,wBAAc,CAAC,CAAC,QAAQ,EAAE;IAC7C,OAAO,EAAE,OAAC,CAAC,KAAK,CAAC,QAAA,oBAAoB,CAAC,CAAC,QAAQ,EAAE;IACjD,sEAAsE;IACtE,oBAAoB,EAAE,OAAC,CAAC,OAAO,EAAE,CAAC,QAAQ,EAAE;CAC7C,CAAC,CAAC;AAEU,QAAA,yBAAyB,GAAG,OAAC,CAAC,MAAM,CAAC;IAChD,IAAI,EAAE,OAAC,CAAC,OAAO,CAAC,kBAAkB,CAAC;IACnC,WAAW,EAAE,OAAC,CAAC,MAAM,EAAE;IACvB,IAAI,EAAE,OAAC,CAAC,MAAM,EAAE;IAChB,SAAS,EAAE,OAAC,CAAC,KAAK,CAAC,wBAAc,CAAC,CAAC,QAAQ,EAAE;IAC7C,OAAO,EAAE,OAAC,CAAC,KAAK,CAAC,QAAA,oBAAoB,CAAC,CAAC,QAAQ,EAAE;CAClD,CAAC,CAAC;AAEH,oFAAoF;AACpF,8EAA8E;AAC9E,qDAAqD;AACxC,QAAA,0BAA0B,GAAG,OAAC,CAAC,kBAAkB,CAAC,MAAM,EAAE;IACrE,0BAA0B;IAC1B,QAAA,oBAAoB;IACpB,QAAA,qBAAqB;IACrB,QAAA,wBAAwB;IACxB,QAAA,mBAAmB;IACnB,QAAA,sBAAsB;IACtB,QAAA,sBAAsB;IACtB,QAAA,oBAAoB;IACpB,QAAA,sBAAsB;IACtB,cAAc;IACd,QAAA,wBAAwB;IACxB,QAAA,wBAAwB;IACxB,QAAA,sBAAsB;IACtB,QAAA,qBAAqB;IACrB,QAAA,sBAAsB;IACtB,mBAAmB;IACnB,QAAA,yBAAyB;IACzB,QAAA,uBAAuB;IACvB,eAAe;IACf,QAAA,gBAAgB;IAChB,yBAAyB;IACzB,QAAA,qBAAqB;IACrB,QAAA,4BAA4B;IAC5B,QAAA,+BAA+B;IAC/B,QAAA,yBAAyB;IACzB,+BAA+B;IAC/B,QAAA,+BAA+B;IAC/B,wBAAwB;IACxB,QAAA,wBAAwB;IACxB,cAAc;IACd,GAAG,QAAA,wBAAwB,CAAC,GAAG,CAAC,OAAO;IACvC,wCAAwC;IACxC,QAAA,oBAAoB;CACrB,CAAC,CAAC;AAEH,gBAAgB;AACH,QAAA,kBAAkB,GAAG,OAAC,CAAC,kBAAkB,CAAC,MAAM,EAAE;IAC7D,OAAC,CAAC,MAAM,CAAC,EAAE,IAAI,EAAE,OAAC,CAAC,OAAO,CAAC,MAAM,CAAC,EAAE,CAAC;IACrC,OAAC,CAAC,MAAM,CAAC,EAAE,IAAI,EAAE,OAAC,CAAC,OAAO,CAAC,UAAU,CAAC,EAAE,CAAC;IACzC,OAAC,CAAC,MAAM,CAAC,EAAE,IAAI,EAAE,OAAC,CAAC,OAAO,CAAC,WAAW,CAAC,EAAE,IAAI,EAAE,OAAC,CAAC,MAAM,CAAC,EAAE,OAAO,EAAE,OAAC,CAAC,MAAM,EAAE,EAAE,CAAC,EAAE,CAAC;IACnF,OAAC,CAAC,MAAM,CAAC,EAAE,IAAI,EAAE,OAAC,CAAC,OAAO,CAAC,YAAY,CAAC,EAAE,CAAC;IAC3C,OAAC,CAAC,MAAM,CAAC,EAAE,IAAI,EAAE,OAAC,CAAC,OAAO,CAAC,aAAa,CAAC,EAAE,OAAO,EAAE,OAAC,CAAC,MAAM,EAAE,EAAE,CAAC;IACjE,OAAC,CAAC,MAAM,CAAC,EAAE,IAAI,EAAE,OAAC,CAAC,OAAO,CAAC,YAAY,CAAC,EAAE,IAAI,EAAE,OAAC,CAAC,MAAM,CAAC,EAAE,OAAO,EAAE,OAAC,CAAC,MAAM,EAAE,EAAE,CAAC,EAAE,CAAC;IACpF,OAAC,CAAC,MAAM,CAAC,EAAE,IAAI,EAAE,OAAC,CAAC,OAAO,CAAC,OAAO,CAAC,EAAE,OAAO,EAAE,OAAC,CAAC,MAAM,EAAE,EAAE,CAAC;CAC5D,CAAC,CAAC;AAEH,sBAAsB;AACT,QAAA,sBAAsB,GAAG,OAAC,CAAC,MAAM,CAAC;IAC7C,WAAW,EAAE,OAAC,CAAC,MAAM,EAAE,CAAC,IAAI,CAAC;QAC3B,WAAW,EAAE,wEAAwE;KACtF,CAAC;IACF,MAAM,EAAE,OAAC,CAAC,IAAI,CAAC,CAAC,QAAQ,EAAE,SAAS,EAAE,SAAS,CAAC,CAAC,CAAC,IAAI,CAAC;QACpD,WAAW,EAAE,qCAAqC;KACnD,CAAC;CACH,CAAC,CAAC;AAEU,QAAA,gBAAgB,GAAG,OAAC,CAAC,KAAK,CAAC,QAAA,sBAAsB,CAAC,CAAC,IAAI,CAAC;IACnE,WAAW,EACT,uFAAuF;CAC1F,CAAC,CAAC;AAEH,wCAAwC;AAC3B,QAAA,iBAAiB,GAAG,OAAC,CAAC,MAAM,CAAC;IACxC,uBAAuB,EAAE,OAAC,CAAC,OAAO,EAAE,CAAC,QAAQ,EAAE;IAC/C,gCAAgC,EAAE,OAAC,CAAC,OAAO,EAAE,CAAC,QAAQ,EAAE;IACxD,OAAO,EAAE,OAAC,CAAC,OAAO,EAAE,CAAC,QAAQ,EAAE;IAC/B,uBAAuB,EAAE,OAAC,CAAC,OAAO,EAAE,CAAC,QAAQ,EAAE;CAChD,CAAC,CAAC;AAEH,sBAAsB;AACT,QAAA,wBAAwB,GAAG,OAAC,CAAC,MAAM,CAAC;IAC/C,aAAa,EAAE,OAAC,CAAC,MAAM,EAAE,CAAC,QAAQ,EAAE;IACpC,aAAa,EAAE,OAAC,CAAC,IAAI,CAAC,CAAC,KAAK,EAAE,KAAK,EAAE,QAAQ,EAAE,MAAM,EAAE,OAAO,EAAE,KAAK,CAAC,CAAC,CAAC,QAAQ,EAAE;IAClF,KAAK,EAAE,OAAC,CAAC,MAAM,CAAC,oBAAoB,CAAC;IACrC,oBAAoB,EAAE,OAAC,CAAC,IAAI,CAAC,CAAC,KAAK,EAAE,KAAK,EAAE,QAAQ,EAAE,MAAM,EAAE,OAAO,EAAE,KAAK,CAAC,CAAC,CAAC,QAAQ,EAAE;IACzF,YAAY,EAAE,OAAC,CAAC,MAAM,EAAE,CAAC,QAAQ,EAAE;IACnC,UAAU,EAAE,QAAA,gBAAgB,CAAC,QAAQ,EAAE;IACvC,4BAA4B,EAAE,OAAC,CAAC,MAAM,EAAE,CAAC,QAAQ,EAAE;IACnD,eAAe,EAAE,OAAC,CAAC,MAAM,EAAE,CAAC,QAAQ,EAAE;IACtC,OAAO,EAAE,+BAAa,CAAC,IAAI,CAAC;QAC1B,WAAW,EAAE,2BAA2B;KACzC,CAAC;IACF,IAAI,EAAE,sBAAe,CAAC,QAAQ,EAAE,CAAC,KAAK,CAAC,SAAS,CAAC,CAAC,IAAI,CAAC;QACrD,WAAW,EAAE,2DAA2D;KACzE,CAAC;IACF,eAAe,EAAE,0CAAwB,CAAC,QAAQ,EAAE;IACpD,WAAW,EAAE,OAAC,CAAC,GAAG,EAAE,CAAC,QAAQ,EAAE,EAAE,YAAY;IAC7C;;OAEG;IACH,yBAAyB,EAAE,OAAC,CAAC,OAAO,EAAE,CAAC,QAAQ,EAAE;IACjD,WAAW,EAAE,QAAA,iBAAiB,CAAC,QAAQ,EAAE;IACzC;;;;OAIG;IACH,sBAAsB,EAAE,OAAC,CAAC,OAAO,EAAE,CAAC,QAAQ,EAAE;CAC/C,CAAC,CAAC","sourcesContent":["import { z } from \"zod\";\nimport { AgentIdSchema } from \"./agentDefinition\";\nimport { AgentModeSchema } from \"../../types/mode\";\nimport { THINKING_LEVELS } from \"../../types/thinking\";\nimport { ChatUsageDisplaySchema } from \"./chatStats\";\nimport { StreamErrorTypeSchema } from \"./errors\";\nimport {\n  FilePartSchema,\n  MuxMessageSchema,\n  MuxReasoningPartSchema,\n  MuxTextPartSchema,\n  MuxToolPartSchema,\n} from \"./message\";\nimport { MuxProviderOptionsSchema } from \"./providerOptions\";\nimport { RuntimeModeSchema } from \"./runtime\";\n\n// Chat Events\n\n/** Heartbeat event to keep the connection alive during long operations */\nexport const HeartbeatEventSchema = z.object({\n  type: z.literal(\"heartbeat\"),\n});\nexport const CaughtUpMessageSchema = z.object({\n  type: z.literal(\"caught-up\"),\n});\n\n/** Sent when a workspace becomes eligible for idle compaction while connected */\n\n/**\n * Progress event for runtime readiness checks.\n * Used by Coder workspaces to show \"Starting Coder workspace...\" while ensureReady() blocks.\n * Not used by Docker (start is near-instant) or local runtimes.\n */\nexport const RuntimeStatusEventSchema = z.object({\n  type: z.literal(\"runtime-status\"),\n  workspaceId: z.string(),\n  phase: z.enum([\"checking\", \"starting\", \"waiting\", \"ready\", \"error\"]),\n  runtimeType: RuntimeModeSchema,\n  detail: z.string().optional(), // Human-readable status like \"Starting Coder workspace...\"\n});\n\nexport const IdleCompactionNeededEventSchema = z.object({\n  type: z.literal(\"idle-compaction-needed\"),\n});\n\nexport const StreamErrorMessageSchema = z.object({\n  type: z.literal(\"stream-error\"),\n  messageId: z.string(),\n  error: z.string(),\n  errorType: StreamErrorTypeSchema,\n});\n\nexport const DeleteMessageSchema = z.object({\n  type: z.literal(\"delete\"),\n  historySequences: z.array(z.number()),\n});\n\nconst ThinkingLevelSchema = z.enum(THINKING_LEVELS);\n\nexport const StreamStartEventSchema = z.object({\n  type: z.literal(\"stream-start\"),\n  workspaceId: z.string(),\n  messageId: z.string(),\n  replay: z\n    .boolean()\n    .optional()\n    .meta({ description: \"True when this event is emitted during stream replay\" }),\n  model: z.string(),\n  routedThroughGateway: z.boolean().optional(),\n  historySequence: z.number().meta({\n    description: \"Backend assigns global message ordering\",\n  }),\n  startTime: z.number().meta({\n    description: \"Backend timestamp when stream started (Date.now())\",\n  }),\n  mode: AgentModeSchema.optional().catch(undefined).meta({\n    description: \"Legacy base mode (plan/exec/compact) derived from agent\",\n  }),\n  agentId: AgentIdSchema.optional().catch(undefined).meta({\n    description: \"Agent id for this stream\",\n  }),\n  thinkingLevel: ThinkingLevelSchema.optional().meta({\n    description: \"Effective thinking level after model policy clamping\",\n  }),\n});\n\nexport const StreamDeltaEventSchema = z.object({\n  type: z.literal(\"stream-delta\"),\n  workspaceId: z.string(),\n  messageId: z.string(),\n  replay: z\n    .boolean()\n    .optional()\n    .meta({ description: \"True when this event is emitted during stream replay\" }),\n  delta: z.string(),\n  tokens: z.number().meta({\n    description: \"Token count for this delta\",\n  }),\n  timestamp: z.number().meta({\n    description: \"When delta was received (Date.now())\",\n  }),\n});\n\nexport const CompletedMessagePartSchema = z.discriminatedUnion(\"type\", [\n  MuxReasoningPartSchema,\n  MuxTextPartSchema,\n  MuxToolPartSchema,\n]);\n\n// Match LanguageModelV2Usage from @ai-sdk/provider exactly\n// Note: inputTokens/outputTokens/totalTokens use `number | undefined` (required key, value can be undefined)\n// while reasoningTokens/cachedInputTokens use `?: number | undefined` (optional key)\nexport const LanguageModelV2UsageSchema = z.object({\n  inputTokens: z\n    .union([z.number(), z.undefined()])\n    .meta({ description: \"The number of input tokens used\" }),\n  outputTokens: z\n    .union([z.number(), z.undefined()])\n    .meta({ description: \"The number of output tokens used\" }),\n  totalTokens: z.union([z.number(), z.undefined()]).meta({\n    description:\n      \"Total tokens used - may differ from sum of inputTokens and outputTokens (e.g. reasoning tokens or overhead)\",\n  }),\n  reasoningTokens: z\n    .number()\n    .optional()\n    .meta({ description: \"The number of reasoning tokens used\" }),\n  cachedInputTokens: z\n    .number()\n    .optional()\n    .meta({ description: \"The number of cached input tokens\" }),\n});\n\nexport const StreamEndEventSchema = z.object({\n  type: z.literal(\"stream-end\"),\n  workspaceId: z.string(),\n  messageId: z.string(),\n  metadata: z\n    .object({\n      model: z.string(),\n      thinkingLevel: ThinkingLevelSchema.optional(),\n      routedThroughGateway: z.boolean().optional(),\n      // Total usage across all steps (for cost calculation)\n      usage: LanguageModelV2UsageSchema.optional(),\n      // Last step's usage only (for context window display - inputTokens = current context size)\n      contextUsage: LanguageModelV2UsageSchema.optional(),\n      // Aggregated provider metadata across all steps (for cost calculation)\n      providerMetadata: z.record(z.string(), z.unknown()).optional(),\n      // Last step's provider metadata (for context window cache display)\n      contextProviderMetadata: z.record(z.string(), z.unknown()).optional(),\n      duration: z.number().optional(),\n      systemMessageTokens: z.number().optional(),\n      historySequence: z.number().optional().meta({\n        description: \"Present when loading from history\",\n      }),\n      timestamp: z.number().optional().meta({\n        description: \"Present when loading from history\",\n      }),\n    })\n    .meta({\n      description: \"Structured metadata from backend - directly mergeable with MuxMetadata\",\n    }),\n  parts: z.array(CompletedMessagePartSchema).meta({\n    description: \"Parts array preserves temporal ordering of reasoning, text, and tool calls\",\n  }),\n});\n\nexport const StreamAbortReasonSchema = z.enum([\"user\", \"startup\", \"system\"]);\n\nexport const StreamAbortEventSchema = z.object({\n  type: z.literal(\"stream-abort\"),\n  workspaceId: z.string(),\n  messageId: z.string(),\n  abortReason: StreamAbortReasonSchema.optional(),\n  metadata: z\n    .object({\n      // Total usage across all steps (for cost calculation)\n      usage: LanguageModelV2UsageSchema.optional(),\n      // Last step's usage (for context window display - inputTokens = current context size)\n      contextUsage: LanguageModelV2UsageSchema.optional(),\n      // Provider metadata for cost calculation (cache tokens, etc.)\n      providerMetadata: z.record(z.string(), z.unknown()).optional(),\n      // Last step's provider metadata (for context window cache display)\n      contextProviderMetadata: z.record(z.string(), z.unknown()).optional(),\n      duration: z.number().optional(),\n    })\n    .optional()\n    .meta({\n      description: \"Metadata may contain usage if abort occurred after stream completed processing\",\n    }),\n  abandonPartial: z.boolean().optional(),\n});\n\nexport const ToolCallStartEventSchema = z.object({\n  type: z.literal(\"tool-call-start\"),\n  workspaceId: z.string(),\n  messageId: z.string(),\n  replay: z\n    .boolean()\n    .optional()\n    .meta({ description: \"True when this event is emitted during stream replay\" }),\n  toolCallId: z.string(),\n  toolName: z.string(),\n  args: z.unknown(),\n  tokens: z.number().meta({ description: \"Token count for tool input\" }),\n  timestamp: z.number().meta({ description: \"When tool call started (Date.now())\" }),\n  parentToolCallId: z.string().optional().meta({ description: \"Set for nested PTC calls\" }),\n});\n\nexport const ToolCallDeltaEventSchema = z.object({\n  type: z.literal(\"tool-call-delta\"),\n  workspaceId: z.string(),\n  messageId: z.string(),\n  replay: z\n    .boolean()\n    .optional()\n    .meta({ description: \"True when this event is emitted during stream replay\" }),\n  toolCallId: z.string(),\n  toolName: z.string(),\n  delta: z.unknown(),\n  tokens: z.number().meta({ description: \"Token count for this delta\" }),\n  timestamp: z.number().meta({ description: \"When delta was received (Date.now())\" }),\n});\n\n/**\n * UI-only incremental output from the bash tool.\n *\n * This is intentionally NOT part of the tool result returned to the model.\n * It is streamed over workspace.onChat so users can \"peek\" while the tool is running.\n */\nexport const BashOutputEventSchema = z.object({\n  type: z.literal(\"bash-output\"),\n  workspaceId: z.string(),\n  toolCallId: z.string(),\n  phase: z\n    .enum([\"output\", \"filtering\"])\n    .optional()\n    .meta({ description: \"UI hint for bash output state\" }),\n  text: z.string(),\n  isError: z.boolean().meta({ description: \"True if this chunk is from stderr\" }),\n  timestamp: z.number().meta({ description: \"When output was flushed (Date.now())\" }),\n});\n\n/**\n * UI-only notification that a task tool call has created a child workspace.\n *\n * This is intentionally NOT part of the tool result returned to the model.\n * It is streamed over workspace.onChat so the UI can show the spawned taskId\n * immediately, even when the task tool runs in foreground (run_in_background=false).\n */\nexport const TaskCreatedEventSchema = z.object({\n  type: z.literal(\"task-created\"),\n  workspaceId: z.string(),\n  toolCallId: z.string(),\n  taskId: z.string(),\n  timestamp: z.number().meta({ description: \"When the task was created (Date.now())\" }),\n});\n\nexport const ToolCallEndEventSchema = z.object({\n  type: z.literal(\"tool-call-end\"),\n  workspaceId: z.string(),\n  messageId: z.string(),\n  replay: z\n    .boolean()\n    .optional()\n    .meta({ description: \"True when this event is emitted during stream replay\" }),\n  toolCallId: z.string(),\n  toolName: z.string(),\n  result: z.unknown(),\n  timestamp: z.number().meta({ description: \"When tool call completed (Date.now())\" }),\n  parentToolCallId: z.string().optional().meta({ description: \"Set for nested PTC calls\" }),\n});\n\nexport const ReasoningDeltaEventSchema = z.object({\n  type: z.literal(\"reasoning-delta\"),\n  workspaceId: z.string(),\n  messageId: z.string(),\n  replay: z\n    .boolean()\n    .optional()\n    .meta({ description: \"True when this event is emitted during stream replay\" }),\n  delta: z.string(),\n  tokens: z.number().meta({ description: \"Token count for this delta\" }),\n  timestamp: z.number().meta({ description: \"When delta was received (Date.now())\" }),\n  signature: z\n    .string()\n    .optional()\n    .meta({ description: \"Anthropic thinking block signature for replay\" }),\n});\n\nexport const ReasoningEndEventSchema = z.object({\n  type: z.literal(\"reasoning-end\"),\n  workspaceId: z.string(),\n  messageId: z.string(),\n  replay: z\n    .boolean()\n    .optional()\n    .meta({ description: \"True when this event is emitted during stream replay\" }),\n});\n\nexport const ErrorEventSchema = z.object({\n  type: z.literal(\"error\"),\n  workspaceId: z.string(),\n  messageId: z.string(),\n  error: z.string(),\n  errorType: StreamErrorTypeSchema.optional(),\n});\n\n/**\n * Emitted when a child workspace is deleted and its accumulated session usage has been\n * rolled up into the parent workspace.\n */\nexport const SessionUsageDeltaEventSchema = z.object({\n  type: z.literal(\"session-usage-delta\"),\n  workspaceId: z.string().meta({ description: \"Parent workspace ID\" }),\n  sourceWorkspaceId: z.string().meta({ description: \"Deleted child workspace ID\" }),\n  byModelDelta: z.record(z.string(), ChatUsageDisplaySchema),\n  timestamp: z.number(),\n});\nexport const UsageDeltaEventSchema = z.object({\n  type: z.literal(\"usage-delta\"),\n  workspaceId: z.string(),\n  messageId: z.string(),\n\n  // Step-level: this step only (for context window display)\n  usage: LanguageModelV2UsageSchema,\n  providerMetadata: z.record(z.string(), z.unknown()).optional(),\n\n  // Cumulative: sum across all steps (for live cost display)\n  cumulativeUsage: LanguageModelV2UsageSchema,\n  cumulativeProviderMetadata: z.record(z.string(), z.unknown()).optional(),\n});\n\n// Individual init event schemas for flat discriminated union\nexport const InitStartEventSchema = z.object({\n  type: z.literal(\"init-start\"),\n  hookPath: z.string(),\n  timestamp: z.number(),\n});\n\nexport const InitOutputEventSchema = z.object({\n  type: z.literal(\"init-output\"),\n  line: z.string(),\n  timestamp: z.number(),\n  isError: z.boolean().optional(),\n});\n\nexport const InitEndEventSchema = z.object({\n  type: z.literal(\"init-end\"),\n  exitCode: z.number(),\n  timestamp: z.number(),\n  /** Number of lines dropped from middle when output exceeded limit (omitted if 0) */\n  truncatedLines: z.number().optional(),\n});\n\n// Composite schema for backwards compatibility\nexport const WorkspaceInitEventSchema = z.discriminatedUnion(\"type\", [\n  InitStartEventSchema,\n  InitOutputEventSchema,\n  InitEndEventSchema,\n]);\n\n// Chat message wrapper with type discriminator for streaming events\n// MuxMessageSchema is used for persisted data (chat.jsonl) which doesn't have a type field.\n// This wrapper adds a type discriminator for real-time streaming events.\nexport const ChatMuxMessageSchema = MuxMessageSchema.extend({\n  type: z.literal(\"message\"),\n});\n\n// Review data schema for queued message display\nexport const ReviewNoteDataSchema = z.object({\n  filePath: z.string(),\n  lineRange: z.string(),\n  selectedCode: z.string(),\n  selectedDiff: z.string().optional(),\n  oldStart: z.number().optional(),\n  newStart: z.number().optional(),\n  userNote: z.string(),\n});\n\nexport const QueuedMessageChangedEventSchema = z.object({\n  type: z.literal(\"queued-message-changed\"),\n  workspaceId: z.string(),\n  queuedMessages: z.array(z.string()),\n  displayText: z.string(),\n  fileParts: z.array(FilePartSchema).optional(),\n  reviews: z.array(ReviewNoteDataSchema).optional(),\n  /** True when the queued message is a compaction request (/compact) */\n  hasCompactionRequest: z.boolean().optional(),\n});\n\nexport const RestoreToInputEventSchema = z.object({\n  type: z.literal(\"restore-to-input\"),\n  workspaceId: z.string(),\n  text: z.string(),\n  fileParts: z.array(FilePartSchema).optional(),\n  reviews: z.array(ReviewNoteDataSchema).optional(),\n});\n\n// All streaming events now have a `type` field for O(1) discriminated union lookup.\n// MuxMessages (user/assistant chat messages) are emitted with type: \"message\"\n// when loading from history or sending new messages.\nexport const WorkspaceChatMessageSchema = z.discriminatedUnion(\"type\", [\n  // Stream lifecycle events\n  HeartbeatEventSchema,\n  CaughtUpMessageSchema,\n  StreamErrorMessageSchema,\n  DeleteMessageSchema,\n  StreamStartEventSchema,\n  StreamDeltaEventSchema,\n  StreamEndEventSchema,\n  StreamAbortEventSchema,\n  // Tool events\n  ToolCallStartEventSchema,\n  ToolCallDeltaEventSchema,\n  ToolCallEndEventSchema,\n  BashOutputEventSchema,\n  TaskCreatedEventSchema,\n  // Reasoning events\n  ReasoningDeltaEventSchema,\n  ReasoningEndEventSchema,\n  // Error events\n  ErrorEventSchema,\n  // Usage and queue events\n  UsageDeltaEventSchema,\n  SessionUsageDeltaEventSchema,\n  QueuedMessageChangedEventSchema,\n  RestoreToInputEventSchema,\n  // Idle compaction notification\n  IdleCompactionNeededEventSchema,\n  // Runtime status events\n  RuntimeStatusEventSchema,\n  // Init events\n  ...WorkspaceInitEventSchema.def.options,\n  // Chat messages with type discriminator\n  ChatMuxMessageSchema,\n]);\n\n// Update Status\nexport const UpdateStatusSchema = z.discriminatedUnion(\"type\", [\n  z.object({ type: z.literal(\"idle\") }),\n  z.object({ type: z.literal(\"checking\") }),\n  z.object({ type: z.literal(\"available\"), info: z.object({ version: z.string() }) }),\n  z.object({ type: z.literal(\"up-to-date\") }),\n  z.object({ type: z.literal(\"downloading\"), percent: z.number() }),\n  z.object({ type: z.literal(\"downloaded\"), info: z.object({ version: z.string() }) }),\n  z.object({ type: z.literal(\"error\"), message: z.string() }),\n]);\n\n// Tool policy schemas\nexport const ToolPolicyFilterSchema = z.object({\n  regex_match: z.string().meta({\n    description: 'Regex pattern to match tool names (e.g., \"bash\", \"file_edit_.*\", \".*\")',\n  }),\n  action: z.enum([\"enable\", \"disable\", \"require\"]).meta({\n    description: \"Action to take when pattern matches\",\n  }),\n});\n\nexport const ToolPolicySchema = z.array(ToolPolicyFilterSchema).meta({\n  description:\n    \"Tool policy - array of filters applied in order. Default behavior is allow all tools.\",\n});\n\n// Experiments schema for feature gating\nexport const ExperimentsSchema = z.object({\n  programmaticToolCalling: z.boolean().optional(),\n  programmaticToolCallingExclusive: z.boolean().optional(),\n  system1: z.boolean().optional(),\n  execSubagentHardRestart: z.boolean().optional(),\n});\n\n// SendMessage options\nexport const SendMessageOptionsSchema = z.object({\n  editMessageId: z.string().optional(),\n  thinkingLevel: z.enum([\"off\", \"low\", \"medium\", \"high\", \"xhigh\", \"max\"]).optional(),\n  model: z.string(\"No model specified\"),\n  system1ThinkingLevel: z.enum([\"off\", \"low\", \"medium\", \"high\", \"xhigh\", \"max\"]).optional(),\n  system1Model: z.string().optional(),\n  toolPolicy: ToolPolicySchema.optional(),\n  additionalSystemInstructions: z.string().optional(),\n  maxOutputTokens: z.number().optional(),\n  agentId: AgentIdSchema.meta({\n    description: \"Agent id for this request\",\n  }),\n  mode: AgentModeSchema.optional().catch(undefined).meta({\n    description: \"Legacy base mode (plan/exec/compact) for backend fallback\",\n  }),\n  providerOptions: MuxProviderOptionsSchema.optional(),\n  muxMetadata: z.any().optional(), // Black box\n  /**\n   * When true, skip persisting AI settings (e.g., for one-shot or compaction sends).\n   */\n  skipAiSettingsPersistence: z.boolean().optional(),\n  experiments: ExperimentsSchema.optional(),\n  /**\n   * When true, workspace-specific agent definitions are disabled.\n   * Only built-in and global agents are loaded. Useful for \"unbricking\" when\n   * iterating on agent files - a broken agent in the worktree won't affect message sending.\n   */\n  disableWorkspaceAgents: z.boolean().optional(),\n});\n\n// Re-export ChatUsageDisplaySchema for convenience\nexport { ChatUsageDisplaySchema };\n"]}