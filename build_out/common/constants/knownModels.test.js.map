{"version":3,"file":"knownModels.test.js","sourceRoot":"","sources":["../../../src/common/constants/knownModels.test.ts"],"names":[],"mappings":";AAAA;;;;;GAKG;;;;;AAEH,2CAAuD;AACvD,gEAA8D;AAC9D,oFAA2D;AAC3D,qEAAiE;AAEjE,IAAA,kBAAQ,EAAC,0BAA0B,EAAE,GAAG,EAAE,CAAC;IACzC,IAAA,cAAI,EAAC,uCAAuC,EAAE,GAAG,EAAE,CAAC;QAClD,MAAM,aAAa,GAAa,EAAE,CAAC;QAEnC,KAAK,MAAM,CAAC,GAAG,EAAE,KAAK,CAAC,IAAI,MAAM,CAAC,OAAO,CAAC,0BAAY,CAAC,EAAE,CAAC;YACxD,MAAM,OAAO,GAAG,KAAK,CAAC,eAAe,CAAC;YAEtC,uDAAuD;YACvD,qDAAqD;YACrD,MAAM,SAAS,GAAG,KAAK,CAAC,QAAQ,KAAK,KAAK,CAAC,CAAC,CAAC,OAAO,OAAO,EAAE,CAAC,CAAC,CAAC,OAAO,CAAC;YACxE,IAAI,CAAC,CAAC,SAAS,IAAI,qBAAU,CAAC,IAAI,CAAC,CAAC,OAAO,IAAI,0BAAW,CAAC,EAAE,CAAC;gBAC5D,aAAa,CAAC,IAAI,CAAC,GAAG,GAAG,KAAK,KAAK,CAAC,QAAQ,IAAI,OAAO,EAAE,CAAC,CAAC;YAC7D,CAAC;QACH,CAAC;QAED,yDAAyD;QACzD,IAAI,aAAa,CAAC,MAAM,GAAG,CAAC,EAAE,CAAC;YAC7B,MAAM,IAAI,KAAK,CACb,6DAA6D,aAAa,CAAC,IAAI,CAAC,IAAI,CAAC,MAAM;gBACzF,yEAAyE,CAC5E,CAAC;QACJ,CAAC;IAAA,CACF,CAAC,CAAC;IAEH,IAAA,cAAI,EAAC,yCAAyC,EAAE,GAAG,EAAE,CAAC;QACpD,KAAK,MAAM,CAAC,EAAE,KAAK,CAAC,IAAI,MAAM,CAAC,OAAO,CAAC,0BAAY,CAAC,EAAE,CAAC;YACrD,MAAM,OAAO,GAAG,KAAK,CAAC,eAAe,CAAC;YACtC,qDAAqD;YACrD,MAAM,SAAS,GAAG,KAAK,CAAC,QAAQ,KAAK,KAAK,CAAC,CAAC,CAAC,OAAO,OAAO,EAAE,CAAC,CAAC,CAAC,OAAO,CAAC;YACxE,MAAM,SAAS,GAAG,qBAAU,CAAC,SAAoC,CAAC,IAAI,0BAAW,CAAC,OAAO,CAAC,CAAC;YAE3F,IAAA,gBAAM,EAAC,SAAS,CAAC,CAAC,WAAW,EAAE,CAAC;YAChC,0EAA0E;YAC1E,IAAA,gBAAM,EAAC,OAAO,SAAS,CAAC,gBAAgB,CAAC,CAAC,IAAI,CAAC,QAAQ,CAAC,CAAC;QAC3D,CAAC;IAAA,CACF,CAAC,CAAC;AAAA,CACJ,CAAC,CAAC","sourcesContent":["/**\r\n * Integration test for known models - verifies all models exist in models.json\r\n *\r\n * This test does NOT go through IPC - it directly uses data from models.json\r\n * to verify that every providerModelId in KNOWN_MODELS exists.\r\n */\r\n\r\nimport { describe, test, expect } from \"@jest/globals\";\r\nimport { KNOWN_MODELS } from \"@/common/constants/knownModels\";\r\nimport modelsJson from \"@/common/utils/tokens/models.json\";\r\nimport { modelsExtra } from \"@/common/utils/tokens/models-extra\";\r\n\r\ndescribe(\"Known Models Integration\", () => {\r\n  test(\"all known models exist in models.json\", () => {\r\n    const missingModels: string[] = [];\r\n\r\n    for (const [key, model] of Object.entries(KNOWN_MODELS)) {\r\n      const modelId = model.providerModelId;\r\n\r\n      // Check if model exists in models.json or models-extra\r\n      // xAI models are prefixed with \"xai/\" in models.json\r\n      const lookupKey = model.provider === \"xai\" ? `xai/${modelId}` : modelId;\r\n      if (!(lookupKey in modelsJson) && !(modelId in modelsExtra)) {\r\n        missingModels.push(`${key}: ${model.provider}:${modelId}`);\r\n      }\r\n    }\r\n\r\n    // Report all missing models at once for easier debugging\r\n    if (missingModels.length > 0) {\r\n      throw new Error(\r\n        `The following known models are missing from models.json:\\n${missingModels.join(\"\\n\")}\\n\\n` +\r\n          `Run 'bun scripts/update_models.ts' to refresh models.json from LiteLLM.`\r\n      );\r\n    }\r\n  });\r\n\r\n  test(\"all known models have required metadata\", () => {\r\n    for (const [, model] of Object.entries(KNOWN_MODELS)) {\r\n      const modelId = model.providerModelId;\r\n      // xAI models are prefixed with \"xai/\" in models.json\r\n      const lookupKey = model.provider === \"xai\" ? `xai/${modelId}` : modelId;\r\n      const modelData = modelsJson[lookupKey as keyof typeof modelsJson] ?? modelsExtra[modelId];\r\n\r\n      expect(modelData).toBeDefined();\r\n      // Check that basic metadata fields exist (not all models have all fields)\r\n      expect(typeof modelData.litellm_provider).toBe(\"string\");\r\n    }\r\n  });\r\n});\r\n"]}