{"version":3,"file":"storage.js","sourceRoot":"","sources":["../../../src/common/constants/storage.ts"],"names":[],"mappings":"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","sourcesContent":["/**\n * LocalStorage Key Constants and Helpers\n * These keys are used for persisting state in localStorage\n */\n\n/**\n * Scope ID Helpers\n * These create consistent scope identifiers for storage keys\n */\n\n/**\n * Get project-scoped ID for storage keys (e.g., model preference before workspace creation)\n * Format: \"__project__/{projectPath}\"\n * Uses \"/\" delimiter to safely handle projectPath values containing special characters\n */\nexport function getProjectScopeId(projectPath: string): string {\n  return `__project__/${projectPath}`;\n}\n\n/**\n * Get pending workspace scope ID for storage keys (e.g., input text during workspace creation)\n * Format: \"__pending__{projectPath}\"\n */\nexport function getPendingScopeId(projectPath: string): string {\n  return `__pending__${projectPath}`;\n}\n\n/**\n * Get draft workspace scope ID for storage keys.\n *\n * This is used for UI-only workspace creation drafts so multiple pending drafts can\n * exist per project without colliding.\n *\n * Format: \"__draft__/{projectPath}/{draftId}\"\n */\nexport function getDraftScopeId(projectPath: string, draftId: string): string {\n  return `__draft__/${projectPath}/${draftId}`;\n}\n\n/**\n * Global scope ID for workspace-independent preferences\n */\nexport const GLOBAL_SCOPE_ID = \"__global__\";\n\n/**\n * Get the localStorage key for the UI theme preference (global)\n * Format: \"uiTheme\"\n */\nexport const UI_THEME_KEY = \"uiTheme\";\n\n/**\n * LocalStorage key for the hidden Power Mode UI easter egg (global).\n */\nexport const POWER_MODE_ENABLED_KEY = \"powerModeEnabled\";\n\n/**\n * Get the localStorage key for the last selected provider when adding custom models (global)\n * Format: \"lastCustomModelProvider\"\n */\nexport const LAST_CUSTOM_MODEL_PROVIDER_KEY = \"lastCustomModelProvider\";\n\n/**\n * Get the localStorage key for the currently selected workspace (global)\n * Format: \"selectedWorkspace\"\n */\nexport const SELECTED_WORKSPACE_KEY = \"selectedWorkspace\";\n\n/**\n * Get the localStorage key for expanded projects in sidebar (global)\n * Format: \"expandedProjects\"\n */\nexport const EXPANDED_PROJECTS_KEY = \"expandedProjects\";\n\n/**\n * LocalStorage key for UI-only workspace creation drafts.\n *\n * Value: Record<string, Array<{ draftId: string; sectionId: string | null; createdAt: number }>>\n * Keyed by projectPath.\n */\nexport const WORKSPACE_DRAFTS_BY_PROJECT_KEY = \"workspaceDraftsByProject\";\n\n/**\n * LocalStorage keys for Mux Gateway routing preferences (global).\n *\n * Note: localStorage is origin-scoped (includes port), so these values are also\n * mirrored into ~/.mux/config.json for portability across server ports.\n */\nexport const GATEWAY_MODELS_KEY = \"gateway-models\"; // enabled model IDs (canonical)\nexport const GATEWAY_CONFIGURED_KEY = \"gateway-available\"; // synced from provider config\nexport const GATEWAY_ENABLED_KEY = \"gateway-enabled\"; // global on/off toggle\n\n/**\n * Get the localStorage key for cached MCP server test results (per project)\n * Format: \"mcpTestResults:{projectPath}\"\n * Stores: Record<serverName, CachedMCPTestResult>\n */\nexport function getMCPTestResultsKey(projectPath: string): string {\n  return `mcpTestResults:${projectPath}`;\n}\n\n/**\n * Get the localStorage key for cached archived workspaces per project\n * Format: \"archivedWorkspaces:{projectPath}\"\n * Stores: Array of workspace metadata objects (optimistic cache)\n */\nexport function getArchivedWorkspacesKey(projectPath: string): string {\n  return `archivedWorkspaces:${projectPath}`;\n}\n\n/**\n * Get the localStorage key for cached MCP servers per project\n * Format: \"mcpServers:{projectPath}\"\n * Stores: Record<serverName, MCPServerInfo> (optimistic cache)\n */\nexport function getMCPServersKey(projectPath: string): string {\n  return `mcpServers:${projectPath}`;\n}\n\n/**\n * Get the localStorage key for thinking level preference per scope (workspace/project).\n * Format: \"thinkingLevel:{scopeId}\"\n */\nexport function getThinkingLevelKey(scopeId: string): string {\n  return `thinkingLevel:${scopeId}`;\n}\n\n/**\n * Get the localStorage key for per-agent workspace AI overrides cache.\n * Format: \"workspaceAiSettingsByAgent:{workspaceId}\"\n */\nexport function getWorkspaceAISettingsByAgentKey(workspaceId: string): string {\n  return `workspaceAiSettingsByAgent:${workspaceId}`;\n}\n\n/**\n * LEGACY: Get the localStorage key for thinking level preference per model (global).\n * Format: \"thinkingLevel:model:{modelName}\"\n *\n * Kept for one-time migration to per-workspace thinking.\n */\nexport function getThinkingLevelByModelKey(modelName: string): string {\n  return `thinkingLevel:model:${modelName}`;\n}\n\n/**\n * Get the localStorage key for the user's preferred model for a workspace\n */\nexport function getModelKey(workspaceId: string): string {\n  return `model:${workspaceId}`;\n}\n\n/**\n * Get the localStorage key for the input text for a workspace\n */\nexport function getInputKey(workspaceId: string): string {\n  return `input:${workspaceId}`;\n}\n\n/**\n * Get the localStorage key for persisted workspace name-generation state.\n *\n * This is used by the workspace creation flow so drafts can preserve their\n * auto-generated (or manually edited) workspace name independently.\n *\n * Format: \"workspaceNameState:{scopeId}\"\n */\nexport function getWorkspaceNameStateKey(scopeId: string): string {\n  return `workspaceNameState:${scopeId}`;\n}\n\n/**\n * Get the localStorage key for the input attachments for a scope.\n * Format: \"inputAttachments:{scopeId}\"\n *\n * Note: The input key functions accept any string scope ID. For normal workspaces\n * this is the workspaceId; for creation mode it's a pending scope ID.\n */\nexport function getInputAttachmentsKey(scopeId: string): string {\n  return `inputAttachments:${scopeId}`;\n}\n\n/**\n * Get the localStorage key for pending initial send errors after workspace creation.\n * Stored so the workspace view can surface a toast after navigation.\n * Format: \"pendingSendError:{workspaceId}\"\n */\nexport function getPendingWorkspaceSendErrorKey(workspaceId: string): string {\n  return `pendingSendError:${workspaceId}`;\n}\n\n/**\n * Get the localStorage key for auto-retry preference for a workspace\n */\nexport function getAutoRetryKey(workspaceId: string): string {\n  return `${workspaceId}-autoRetry`;\n}\n\n/**\n * Get the localStorage key for retry state for a workspace\n * Stores: { attempt, totalRetryTime, retryStartTime }\n */\nexport function getRetryStateKey(workspaceId: string): string {\n  return `${workspaceId}-retryState`;\n}\n\n/**\n * Get storage key for cancelled compaction tracking.\n * Stores compaction-request user message ID to verify freshness across reloads.\n */\nexport function getCancelledCompactionKey(workspaceId: string): string {\n  return `workspace:${workspaceId}:cancelled-compaction`;\n}\n\n/**\n * Get the localStorage key for the selected agent definition id for a scope.\n * Format: \"agentId:{scopeId}\"\n */\nexport function getAgentIdKey(scopeId: string): string {\n  return `agentId:${scopeId}`;\n}\n\n/**\n * Get the localStorage key for the pinned third agent id for a scope.\n * Format: \"pinnedAgentId:{scopeId}\"\n */\nexport function getPinnedAgentIdKey(scopeId: string): string {\n  return `pinnedAgentId:${scopeId}`;\n}\n/**\n * Get the localStorage key for \"disable workspace agents\" toggle per scope.\n * When true, workspace-specific agents are disabled - only built-in and global agents are loaded.\n * Useful for \"unbricking\" when iterating on agent files in a workspace worktree.\n * Format: \"disableWorkspaceAgents:{scopeId}\"\n */\nexport function getDisableWorkspaceAgentsKey(scopeId: string): string {\n  return `disableWorkspaceAgents:${scopeId}`;\n}\n/**\n * Get the localStorage key for the default runtime for a project\n * Defaults to worktree if not set; can only be changed via the \"Default for project\" checkbox.\n * Format: \"runtime:{projectPath}\"\n */\nexport function getRuntimeKey(projectPath: string): string {\n  return `runtime:${projectPath}`;\n}\n\n/**\n * Get the localStorage key for trunk branch preference for a project\n * Stores the last used trunk branch when creating a workspace\n * Format: \"trunkBranch:{projectPath}\"\n */\nexport function getTrunkBranchKey(projectPath: string): string {\n  return `trunkBranch:${projectPath}`;\n}\n\n/**\n * Get the localStorage key for whether to show the \"Initialize with AGENTS.md\" nudge for a project.\n * Set to true when a project is first added; cleared when user dismisses or runs /init.\n * Format: \"agentsInitNudge:{projectPath}\"\n */\nexport function getAgentsInitNudgeKey(projectPath: string): string {\n  return `agentsInitNudge:${projectPath}`;\n}\n\n/**\n * Get the localStorage key for the last runtime config used per provider for a project.\n *\n * Value shape is a provider-keyed object (e.g. { ssh: { host }, docker: { image } }) so we can\n * add new options without adding more storage keys.\n *\n * Format: \"lastRuntimeConfig:{projectPath}\"\n */\nexport function getLastRuntimeConfigKey(projectPath: string): string {\n  return `lastRuntimeConfig:${projectPath}`;\n}\n\n/**\n * Get the localStorage key for the default model (global).\n *\n * Note: This is used as a fallback when creating new workspaces.\n * Format: \"model-default\"\n */\nexport const DEFAULT_MODEL_KEY = \"model-default\";\n\n/**\n * Get the localStorage key for the hidden models list (global).\n * Format: \"hidden-models\"\n */\nexport const HIDDEN_MODELS_KEY = \"hidden-models\";\n\n/**\n * Get the localStorage key for the preferred compaction model (global)\n * Format: \"preferredCompactionModel\"\n */\nexport const PREFERRED_COMPACTION_MODEL_KEY = \"preferredCompactionModel\";\n\n/**\n * Get the localStorage key for diff view mode preference (global)\n * Format: \"diffViewMode\"\n */\nexport const DIFF_VIEW_MODE_KEY = \"diffViewMode\";\n\n/**\n * Code snippets library storage key (global)\n * Format: \"codeSnippets:list\"\n */\nexport const CODE_SNIPPETS_KEY = \"codeSnippets:list\";\n\n/**\n * Get the localStorage key for the preferred System 1 model (global)\n * Format: \"preferredSystem1Model\"\n */\nexport const PREFERRED_SYSTEM_1_MODEL_KEY = \"preferredSystem1Model\";\n\n/**\n * Get the localStorage key for the preferred System 1 thinking level (global)\n * Format: \"preferredSystem1ThinkingLevel\"\n */\nexport const PREFERRED_SYSTEM_1_THINKING_LEVEL_KEY = \"preferredSystem1ThinkingLevel\";\n\n/**\n * Get the localStorage key for cached per-agent AI defaults (global).\n * Format: \"agentAiDefaults\"\n */\nexport const AGENT_AI_DEFAULTS_KEY = \"agentAiDefaults\";\n\n/**\n * Get the localStorage key for vim mode preference (global)\n * Format: \"vimEnabled\"\n */\nexport const VIM_ENABLED_KEY = \"vimEnabled\";\n\n/**\n * Preferred expiration for mux.md shares (global)\n * Stores: \"1h\" | \"24h\" | \"7d\" | \"30d\" | \"never\"\n * Default: \"7d\"\n */\nexport const SHARE_EXPIRATION_KEY = \"shareExpiration\";\n\n/**\n * Whether to sign shared messages by default.\n * Stores: boolean\n * Default: true\n */\nexport const SHARE_SIGNING_KEY = \"shareSigning\";\n\n/**\n * Git status indicator display mode (global)\n * Stores: \"line-delta\" | \"divergence\"\n */\n\nexport const GIT_STATUS_INDICATOR_MODE_KEY = \"gitStatusIndicatorMode\";\n\n/**\n * Editor configuration for \"Open in Editor\" feature (global)\n * Format: \"editorConfig\"\n */\nexport const EDITOR_CONFIG_KEY = \"editorConfig\";\n\nexport type EditorType = \"vscode\" | \"cursor\" | \"zed\" | \"custom\";\n\nexport interface EditorConfig {\n  editor: EditorType;\n  customCommand?: string; // Only when editor='custom'\n}\n\nexport const DEFAULT_EDITOR_CONFIG: EditorConfig = {\n  editor: \"vscode\",\n};\n\n/**\n * Integrated terminal font configuration (global)\n * Stores: { fontFamily: string; fontSize: number }\n */\nexport const TERMINAL_FONT_CONFIG_KEY = \"terminalFontConfig\";\n\nexport interface TerminalFontConfig {\n  fontFamily: string;\n  fontSize: number;\n}\n\nexport const DEFAULT_TERMINAL_FONT_CONFIG: TerminalFontConfig = {\n  fontFamily: \"Geist Mono, ui-monospace, monospace\",\n  fontSize: 13,\n};\n\n/**\n * Tutorial state storage key (global)\n * Stores: { disabled: boolean, completed: { creation?: true, workspace?: true } }\n */\nexport const TUTORIAL_STATE_KEY = \"tutorialState\";\n\nexport type TutorialSequence = \"creation\" | \"workspace\";\n\nexport interface TutorialState {\n  disabled: boolean;\n  completed: Partial<Record<TutorialSequence, true>>;\n}\n\nexport const DEFAULT_TUTORIAL_STATE: TutorialState = {\n  disabled: false,\n  completed: {},\n};\n\n/**\n * Get the localStorage key for review (hunk read) state per workspace\n * Stores which hunks have been marked as read during code review\n * Format: \"review-state:{workspaceId}\"\n */\nexport function getReviewStateKey(workspaceId: string): string {\n  return `review-state:${workspaceId}`;\n}\n\n/**\n * Get the localStorage key for hunk first-seen timestamps per workspace\n * Tracks when each hunk content address was first observed (for LIFO sorting)\n * Format: \"hunkFirstSeen:{workspaceId}\"\n */\nexport function getHunkFirstSeenKey(workspaceId: string): string {\n  return `hunkFirstSeen:${workspaceId}`;\n}\n\n/**\n * Get the localStorage key for review sort order preference (global)\n * Format: \"review-sort-order\"\n */\nexport const REVIEW_SORT_ORDER_KEY = \"review-sort-order\";\n\n/**\n * Get the localStorage key for hunk expand/collapse state in Review tab\n * Stores user's manual expand/collapse preferences per hunk\n * Format: \"reviewExpandState:{workspaceId}\"\n */\nexport function getReviewExpandStateKey(workspaceId: string): string {\n  return `reviewExpandState:${workspaceId}`;\n}\n\n/**\n * Get the localStorage key for read-more expansion state per hunk.\n * Tracks how many lines are expanded up/down for each hunk.\n * Format: \"reviewReadMore:{workspaceId}\"\n */\nexport function getReviewReadMoreKey(workspaceId: string): string {\n  return `reviewReadMore:${workspaceId}`;\n}\n\n/**\n * Get the localStorage key for FileTree expand/collapse state in Review tab\n * Stores directory expand/collapse preferences per workspace\n * Format: \"fileTreeExpandState:{workspaceId}\"\n */\nexport function getFileTreeExpandStateKey(workspaceId: string): string {\n  return `fileTreeExpandState:${workspaceId}`;\n}\n\n/**\n * LocalStorage key for file tree view mode in the Review tab (global).\n * Format: \"reviewFileTreeViewMode\"\n */\nexport const REVIEW_FILE_TREE_VIEW_MODE_KEY = \"reviewFileTreeViewMode\";\n\n/**\n * Get the localStorage key for persisted agent status for a workspace\n * Stores the most recent successful status_set payload (emoji, message, url)\n * Format: \"statusState:{workspaceId}\"\n */\n\n/**\n * Get the localStorage key for \"notify on response\" toggle per workspace.\n * When true, a browser notification is shown when assistant responses complete.\n * Format: \"notifyOnResponse:{workspaceId}\"\n */\nexport function getNotifyOnResponseKey(workspaceId: string): string {\n  return `notifyOnResponse:${workspaceId}`;\n}\n\n/**\n * Get the localStorage key for \"auto-enable notifications\" toggle per project.\n * When true, new workspaces in this project automatically have notifications enabled.\n * Format: \"notifyOnResponseAutoEnable:{projectPath}\"\n */\nexport function getNotifyOnResponseAutoEnableKey(projectPath: string): string {\n  return `notifyOnResponseAutoEnable:${projectPath}`;\n}\n\nexport function getStatusStateKey(workspaceId: string): string {\n  return `statusState:${workspaceId}`;\n}\n\n/**\n * Get the localStorage key for session timing stats for a workspace\n * Stores aggregate timing data: totalDurationMs, totalToolExecutionMs, totalTtftMs, ttftCount, responseCount\n * Format: \"sessionTiming:{workspaceId}\"\n */\nexport function getSessionTimingKey(workspaceId: string): string {\n  return `sessionTiming:${workspaceId}`;\n}\n\n/**\n * Get the localStorage key for last-read timestamps per workspace.\n * Format: \"workspaceLastRead:{workspaceId}\"\n */\nexport function getWorkspaceLastReadKey(workspaceId: string): string {\n  return `workspaceLastRead:${workspaceId}`;\n}\n\n/**\n * Left sidebar collapsed state (global, manual toggle)\n * Format: \"sidebarCollapsed\"\n */\nexport const LEFT_SIDEBAR_COLLAPSED_KEY = \"sidebarCollapsed\";\n\n/**\n * Left sidebar width\n * Format: \"left-sidebar:width\"\n */\nexport const LEFT_SIDEBAR_WIDTH_KEY = \"left-sidebar:width\";\n\n/**\n * Right sidebar tab selection (global)\n * Format: \"right-sidebar-tab\"\n */\nexport const RIGHT_SIDEBAR_TAB_KEY = \"right-sidebar-tab\";\n\n/**\n * Right sidebar collapsed state (global, manual toggle)\n * Format: \"right-sidebar:collapsed\"\n */\nexport const RIGHT_SIDEBAR_COLLAPSED_KEY = \"right-sidebar:collapsed\";\n\n/**\n * Right sidebar width (unified across all tabs)\n * Format: \"right-sidebar:width\"\n */\nexport const RIGHT_SIDEBAR_WIDTH_KEY = \"right-sidebar:width\";\n\n/**\n * Get the localStorage key for right sidebar dock-lite layout per workspace.\n * Each workspace can have its own split/tab configuration (e.g., different\n * numbers of terminals). Width and collapsed state remain global.\n * Format: \"right-sidebar:layout:{workspaceId}\"\n */\nexport function getRightSidebarLayoutKey(workspaceId: string): string {\n  return `right-sidebar:layout:${workspaceId}`;\n}\n\n/**\n * Get the localStorage key for terminal titles per workspace.\n * Maps sessionId -> title for persisting OSC-set terminal titles.\n * Format: \"right-sidebar:terminal-titles:{workspaceId}\"\n */\nexport function getTerminalTitlesKey(workspaceId: string): string {\n  return `right-sidebar:terminal-titles:${workspaceId}`;\n}\n\n/**\n * Get the localStorage key for unified Review search state per workspace\n * Stores: { input: string, useRegex: boolean, matchCase: boolean }\n * Format: \"reviewSearchState:{workspaceId}\"\n */\nexport function getReviewSearchStateKey(workspaceId: string): string {\n  return `reviewSearchState:${workspaceId}`;\n}\n\n/**\n * Get the localStorage key for reviews per workspace\n * Stores: ReviewsState (reviews created from diff viewer - pending, attached, or checked)\n * Format: \"reviews:{workspaceId}\"\n */\nexport function getReviewsKey(workspaceId: string): string {\n  return `reviews:${workspaceId}`;\n}\n\n/**\n * Get the localStorage key for auto-compaction enabled preference per workspace\n * Format: \"autoCompaction:enabled:{workspaceId}\"\n */\nexport function getAutoCompactionEnabledKey(workspaceId: string): string {\n  return `autoCompaction:enabled:${workspaceId}`;\n}\n\n/**\n * Get the localStorage key for auto-compaction threshold percentage per model\n * Format: \"autoCompaction:threshold:{model}\"\n * Stored per-model because different models have different context windows\n */\nexport function getAutoCompactionThresholdKey(model: string): string {\n  return `autoCompaction:threshold:${model}`;\n}\n\n/**\n * List of workspace-scoped key functions that should be copied on fork and deleted on removal\n */\nconst PERSISTENT_WORKSPACE_KEY_FUNCTIONS: Array<(workspaceId: string) => string> = [\n  getWorkspaceAISettingsByAgentKey,\n  getModelKey,\n  getInputKey,\n  getWorkspaceNameStateKey,\n  getInputAttachmentsKey,\n  getAgentIdKey,\n  getPinnedAgentIdKey,\n  getThinkingLevelKey,\n  getAutoRetryKey,\n  getRetryStateKey,\n  getReviewStateKey,\n  getHunkFirstSeenKey,\n  getReviewExpandStateKey,\n  getReviewReadMoreKey,\n  getFileTreeExpandStateKey,\n  getReviewSearchStateKey,\n  getReviewsKey,\n  getAutoCompactionEnabledKey,\n  getWorkspaceLastReadKey,\n  getStatusStateKey,\n  // Note: auto-compaction threshold is per-model, not per-workspace\n];\n\n/**\n * Get the localStorage key for cached plan content for a workspace\n * Stores: { content: string; path: string } - used for optimistic rendering\n * Format: \"planContent:{workspaceId}\"\n */\nexport function getPlanContentKey(workspaceId: string): string {\n  return `planContent:${workspaceId}`;\n}\n\n/**\n * Get the localStorage key for cached post-compaction state for a workspace\n * Stores: { planPath: string | null; trackedFilePaths: string[]; excludedItems: string[] }\n * Format: \"postCompactionState:{workspaceId}\"\n */\nexport function getPostCompactionStateKey(workspaceId: string): string {\n  return `postCompactionState:${workspaceId}`;\n}\n\n/**\n * Additional ephemeral keys to delete on workspace removal (not copied on fork)\n */\nconst EPHEMERAL_WORKSPACE_KEY_FUNCTIONS: Array<(workspaceId: string) => string> = [\n  getCancelledCompactionKey,\n  getPendingWorkspaceSendErrorKey,\n  getPlanContentKey, // Cache only, no need to preserve on fork\n  getPostCompactionStateKey, // Cache only, no need to preserve on fork\n];\n\n/**\n * Copy all workspace-specific localStorage keys from source to destination workspace.\n * Includes keys listed in PERSISTENT_WORKSPACE_KEY_FUNCTIONS (model, draft input text/attachments, etc).\n */\nexport function copyWorkspaceStorage(sourceWorkspaceId: string, destWorkspaceId: string): void {\n  for (const getKey of PERSISTENT_WORKSPACE_KEY_FUNCTIONS) {\n    const sourceKey = getKey(sourceWorkspaceId);\n    const destKey = getKey(destWorkspaceId);\n    const value = localStorage.getItem(sourceKey);\n    if (value !== null) {\n      localStorage.setItem(destKey, value);\n    }\n  }\n}\n\n/**\n * Delete all workspace-specific localStorage keys for a workspace\n * Should be called when a workspace is deleted to prevent orphaned data\n */\nexport function deleteWorkspaceStorage(workspaceId: string): void {\n  const allKeyFunctions = [\n    ...PERSISTENT_WORKSPACE_KEY_FUNCTIONS,\n    ...EPHEMERAL_WORKSPACE_KEY_FUNCTIONS,\n  ];\n\n  for (const getKey of allKeyFunctions) {\n    const key = getKey(workspaceId);\n    localStorage.removeItem(key);\n  }\n}\n\n/**\n * Migrate all workspace-specific localStorage keys from old to new workspace ID\n * Should be called when a workspace is renamed to preserve settings\n */\nexport function migrateWorkspaceStorage(oldWorkspaceId: string, newWorkspaceId: string): void {\n  copyWorkspaceStorage(oldWorkspaceId, newWorkspaceId);\n  deleteWorkspaceStorage(oldWorkspaceId);\n}\n"]}