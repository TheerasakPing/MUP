{"version":3,"file":"experiments.js","sourceRoot":"","sources":["../../../src/common/constants/experiments.ts"],"names":[],"mappings":";AAAA;;;;;GAKG;;;;;AAEU,QAAA,cAAc,GAAG;IAC5B,yBAAyB,EAAE,2BAA2B;IACtD,mCAAmC,EAAE,qCAAqC;IAC1E,qBAAqB,EAAE,uBAAuB;IAC9C,QAAQ,EAAE,UAAU;IACpB,0BAA0B,EAAE,4BAA4B;IACxD,YAAY,EAAE,cAAc;CACpB,CAAC;AAsBX;;;GAGG;AACU,QAAA,WAAW,GAA+C;IACrE,CAAC,QAAA,cAAc,CAAC,yBAAyB,CAAC,EAAE;QAC1C,EAAE,EAAE,QAAA,cAAc,CAAC,yBAAyB;QAC5C,IAAI,EAAE,2BAA2B;QACjC,WAAW,EAAE,+EAA+E;QAC5F,gBAAgB,EAAE,KAAK;QACvB,eAAe,EAAE,IAAI;QACrB,cAAc,EAAE,IAAI;KACrB;IACD,CAAC,QAAA,cAAc,CAAC,mCAAmC,CAAC,EAAE;QACpD,EAAE,EAAE,QAAA,cAAc,CAAC,mCAAmC;QACtD,IAAI,EAAE,oBAAoB;QAC1B,WAAW,EAAE,0DAA0D;QACvE,gBAAgB,EAAE,KAAK;QACvB,eAAe,EAAE,IAAI;QACrB,cAAc,EAAE,IAAI;KACrB;IACD,CAAC,QAAA,cAAc,CAAC,qBAAqB,CAAC,EAAE;QACtC,EAAE,EAAE,QAAA,cAAc,CAAC,qBAAqB;QACxC,IAAI,EAAE,8BAA8B;QACpC,WAAW,EACT,mOAAmO;QACrO,gBAAgB,EAAE,KAAK;QACvB,eAAe,EAAE,IAAI;QACrB,cAAc,EAAE,IAAI;KACrB;IACD,CAAC,QAAA,cAAc,CAAC,QAAQ,CAAC,EAAE;QACzB,EAAE,EAAE,QAAA,cAAc,CAAC,QAAQ;QAC3B,IAAI,EAAE,UAAU;QAChB,WAAW,EAAE,6EAA6E;QAC1F,gBAAgB,EAAE,KAAK;QACvB,eAAe,EAAE,IAAI;QACrB,cAAc,EAAE,IAAI;KACrB;IACD,CAAC,QAAA,cAAc,CAAC,0BAA0B,CAAC,EAAE;QAC3C,EAAE,EAAE,QAAA,cAAc,CAAC,0BAA0B;QAC7C,IAAI,EAAE,6BAA6B;QACnC,WAAW,EAAE,kDAAkD;QAC/D,gBAAgB,EAAE,KAAK;QACvB,eAAe,EAAE,IAAI;QACrB,cAAc,EAAE,IAAI;KACrB;IACD,CAAC,QAAA,cAAc,CAAC,YAAY,CAAC,EAAE;QAC7B,EAAE,EAAE,QAAA,cAAc,CAAC,YAAY;QAC/B,IAAI,EAAE,cAAc;QACpB,WAAW,EAAE,4DAA4D;QACzE,gBAAgB,EAAE,KAAK;QACvB,eAAe,EAAE,IAAI;QACrB,cAAc,EAAE,IAAI;KACrB;CACF,CAAC;AAEF;;;GAGG;AACH,0BAAiC,YAA0B,EAAU;IACnE,OAAO,cAAc,YAAY,EAAE,CAAC;AAAA,CACrC;AAED;;GAEG;AACH,6BAA4D;IAC1D,OAAO,MAAM,CAAC,MAAM,CAAC,QAAA,WAAW,CAAC,CAAC;AAAA,CACnC","sourcesContent":["/**\r\n * Experiments System\r\n *\r\n * Global feature flags for experimental features.\r\n * State is persisted in localStorage as `experiment:${experimentId}`.\r\n */\r\n\r\nexport const EXPERIMENT_IDS = {\r\n  PROGRAMMATIC_TOOL_CALLING: \"programmatic-tool-calling\",\r\n  PROGRAMMATIC_TOOL_CALLING_EXCLUSIVE: \"programmatic-tool-calling-exclusive\",\r\n  CONFIGURABLE_BIND_URL: \"configurable-bind-url\",\r\n  SYSTEM_1: \"system-1\",\r\n  EXEC_SUBAGENT_HARD_RESTART: \"exec-subagent-hard-restart\",\r\n  MUX_GOVERNOR: \"mux-governor\",\r\n} as const;\r\n\r\nexport type ExperimentId = (typeof EXPERIMENT_IDS)[keyof typeof EXPERIMENT_IDS];\r\n\r\nexport interface ExperimentDefinition {\r\n  id: ExperimentId;\r\n  name: string;\r\n  description: string;\r\n  /** Default state - false means disabled by default */\r\n  enabledByDefault: boolean;\r\n  /**\r\n   * When true, user can override remote PostHog assignment via Settings toggle.\r\n   * When false (default), remote assignment is authoritative.\r\n   */\r\n  userOverridable?: boolean;\r\n  /**\r\n   * When false, experiment is hidden from Settings â†’ Experiments.\r\n   * Defaults to true. Use false for invisible A/B tests.\r\n   */\r\n  showInSettings?: boolean;\r\n}\r\n\r\n/**\r\n * Registry of all experiments.\r\n * Use Record<ExperimentId, ExperimentDefinition> to ensure exhaustive coverage.\r\n */\r\nexport const EXPERIMENTS: Record<ExperimentId, ExperimentDefinition> = {\r\n  [EXPERIMENT_IDS.PROGRAMMATIC_TOOL_CALLING]: {\r\n    id: EXPERIMENT_IDS.PROGRAMMATIC_TOOL_CALLING,\r\n    name: \"Programmatic Tool Calling\",\r\n    description: \"Enable code_execution tool for multi-tool workflows in a sandboxed JS runtime\",\r\n    enabledByDefault: false,\r\n    userOverridable: true,\r\n    showInSettings: true,\r\n  },\r\n  [EXPERIMENT_IDS.PROGRAMMATIC_TOOL_CALLING_EXCLUSIVE]: {\r\n    id: EXPERIMENT_IDS.PROGRAMMATIC_TOOL_CALLING_EXCLUSIVE,\r\n    name: \"PTC Exclusive Mode\",\r\n    description: \"Replace all tools with code_execution (forces PTC usage)\",\r\n    enabledByDefault: false,\r\n    userOverridable: true,\r\n    showInSettings: true,\r\n  },\r\n  [EXPERIMENT_IDS.CONFIGURABLE_BIND_URL]: {\r\n    id: EXPERIMENT_IDS.CONFIGURABLE_BIND_URL,\r\n    name: \"Expose API server on LAN/VPN\",\r\n    description:\r\n      \"Allow mux to listen on a non-localhost address so other devices on your LAN/VPN can connect. Anyone on your network with the auth token can access your mux API. HTTP only; use only on trusted networks (Tailscale recommended).\",\r\n    enabledByDefault: false,\r\n    userOverridable: true,\r\n    showInSettings: true,\r\n  },\r\n  [EXPERIMENT_IDS.SYSTEM_1]: {\r\n    id: EXPERIMENT_IDS.SYSTEM_1,\r\n    name: \"System 1\",\r\n    description: \"Context optimization helpers inspired by Thinking, Fast and Slow (Kahneman)\",\r\n    enabledByDefault: false,\r\n    userOverridable: true,\r\n    showInSettings: true,\r\n  },\r\n  [EXPERIMENT_IDS.EXEC_SUBAGENT_HARD_RESTART]: {\r\n    id: EXPERIMENT_IDS.EXEC_SUBAGENT_HARD_RESTART,\r\n    name: \"Exec sub-agent hard restart\",\r\n    description: \"Hard-restart exec sub-agents on context overflow\",\r\n    enabledByDefault: false,\r\n    userOverridable: true,\r\n    showInSettings: true,\r\n  },\r\n  [EXPERIMENT_IDS.MUX_GOVERNOR]: {\r\n    id: EXPERIMENT_IDS.MUX_GOVERNOR,\r\n    name: \"Mux Governor\",\r\n    description: \"Remote policy delivery for enterprise Mux Governor service\",\r\n    enabledByDefault: false,\r\n    userOverridable: true,\r\n    showInSettings: true,\r\n  },\r\n};\r\n\r\n/**\r\n * Get localStorage key for an experiment.\r\n * Format: \"experiment:{experimentId}\"\r\n */\r\nexport function getExperimentKey(experimentId: ExperimentId): string {\r\n  return `experiment:${experimentId}`;\r\n}\r\n\r\n/**\r\n * Get all experiment definitions as an array for iteration.\r\n */\r\nexport function getExperimentList(): ExperimentDefinition[] {\r\n  return Object.values(EXPERIMENTS);\r\n}\r\n"]}