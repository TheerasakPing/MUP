{"version":3,"file":"experiments.js","sourceRoot":"","sources":["../../../src/common/constants/experiments.ts"],"names":[],"mappings":";AAAA;;;;;GAKG;;;;;AAEU,QAAA,cAAc,GAAG;IAC5B,yBAAyB,EAAE,2BAA2B;IACtD,mCAAmC,EAAE,qCAAqC;IAC1E,qBAAqB,EAAE,uBAAuB;IAC9C,QAAQ,EAAE,UAAU;IACpB,0BAA0B,EAAE,4BAA4B;IACxD,YAAY,EAAE,cAAc;CACpB,CAAC;AAsBX;;;GAGG;AACU,QAAA,WAAW,GAA+C;IACrE,CAAC,QAAA,cAAc,CAAC,yBAAyB,CAAC,EAAE;QAC1C,EAAE,EAAE,QAAA,cAAc,CAAC,yBAAyB;QAC5C,IAAI,EAAE,2BAA2B;QACjC,WAAW,EAAE,+EAA+E;QAC5F,gBAAgB,EAAE,KAAK;QACvB,eAAe,EAAE,IAAI;QACrB,cAAc,EAAE,IAAI;KACrB;IACD,CAAC,QAAA,cAAc,CAAC,mCAAmC,CAAC,EAAE;QACpD,EAAE,EAAE,QAAA,cAAc,CAAC,mCAAmC;QACtD,IAAI,EAAE,oBAAoB;QAC1B,WAAW,EAAE,0DAA0D;QACvE,gBAAgB,EAAE,KAAK;QACvB,eAAe,EAAE,IAAI;QACrB,cAAc,EAAE,IAAI;KACrB;IACD,CAAC,QAAA,cAAc,CAAC,qBAAqB,CAAC,EAAE;QACtC,EAAE,EAAE,QAAA,cAAc,CAAC,qBAAqB;QACxC,IAAI,EAAE,8BAA8B;QACpC,WAAW,EACT,mOAAmO;QACrO,gBAAgB,EAAE,KAAK;QACvB,eAAe,EAAE,IAAI;QACrB,cAAc,EAAE,IAAI;KACrB;IACD,CAAC,QAAA,cAAc,CAAC,QAAQ,CAAC,EAAE;QACzB,EAAE,EAAE,QAAA,cAAc,CAAC,QAAQ;QAC3B,IAAI,EAAE,UAAU;QAChB,WAAW,EAAE,6EAA6E;QAC1F,gBAAgB,EAAE,KAAK;QACvB,eAAe,EAAE,IAAI;QACrB,cAAc,EAAE,IAAI;KACrB;IACD,CAAC,QAAA,cAAc,CAAC,0BAA0B,CAAC,EAAE;QAC3C,EAAE,EAAE,QAAA,cAAc,CAAC,0BAA0B;QAC7C,IAAI,EAAE,6BAA6B;QACnC,WAAW,EAAE,kDAAkD;QAC/D,gBAAgB,EAAE,KAAK;QACvB,eAAe,EAAE,IAAI;QACrB,cAAc,EAAE,IAAI;KACrB;IACD,CAAC,QAAA,cAAc,CAAC,YAAY,CAAC,EAAE;QAC7B,EAAE,EAAE,QAAA,cAAc,CAAC,YAAY;QAC/B,IAAI,EAAE,cAAc;QACpB,WAAW,EAAE,4DAA4D;QACzE,gBAAgB,EAAE,KAAK;QACvB,eAAe,EAAE,IAAI;QACrB,cAAc,EAAE,IAAI;KACrB;CACF,CAAC;AAEF;;;GAGG;AACH,0BAAiC,YAA0B,EAAU;IACnE,OAAO,cAAc,YAAY,EAAE,CAAC;AAAA,CACrC;AAED;;GAEG;AACH,6BAA4D;IAC1D,OAAO,MAAM,CAAC,MAAM,CAAC,QAAA,WAAW,CAAC,CAAC;AAAA,CACnC","sourcesContent":["/**\n * Experiments System\n *\n * Global feature flags for experimental features.\n * State is persisted in localStorage as `experiment:${experimentId}`.\n */\n\nexport const EXPERIMENT_IDS = {\n  PROGRAMMATIC_TOOL_CALLING: \"programmatic-tool-calling\",\n  PROGRAMMATIC_TOOL_CALLING_EXCLUSIVE: \"programmatic-tool-calling-exclusive\",\n  CONFIGURABLE_BIND_URL: \"configurable-bind-url\",\n  SYSTEM_1: \"system-1\",\n  EXEC_SUBAGENT_HARD_RESTART: \"exec-subagent-hard-restart\",\n  MUX_GOVERNOR: \"mux-governor\",\n} as const;\n\nexport type ExperimentId = (typeof EXPERIMENT_IDS)[keyof typeof EXPERIMENT_IDS];\n\nexport interface ExperimentDefinition {\n  id: ExperimentId;\n  name: string;\n  description: string;\n  /** Default state - false means disabled by default */\n  enabledByDefault: boolean;\n  /**\n   * When true, user can override remote PostHog assignment via Settings toggle.\n   * When false (default), remote assignment is authoritative.\n   */\n  userOverridable?: boolean;\n  /**\n   * When false, experiment is hidden from Settings â†’ Experiments.\n   * Defaults to true. Use false for invisible A/B tests.\n   */\n  showInSettings?: boolean;\n}\n\n/**\n * Registry of all experiments.\n * Use Record<ExperimentId, ExperimentDefinition> to ensure exhaustive coverage.\n */\nexport const EXPERIMENTS: Record<ExperimentId, ExperimentDefinition> = {\n  [EXPERIMENT_IDS.PROGRAMMATIC_TOOL_CALLING]: {\n    id: EXPERIMENT_IDS.PROGRAMMATIC_TOOL_CALLING,\n    name: \"Programmatic Tool Calling\",\n    description: \"Enable code_execution tool for multi-tool workflows in a sandboxed JS runtime\",\n    enabledByDefault: false,\n    userOverridable: true,\n    showInSettings: true,\n  },\n  [EXPERIMENT_IDS.PROGRAMMATIC_TOOL_CALLING_EXCLUSIVE]: {\n    id: EXPERIMENT_IDS.PROGRAMMATIC_TOOL_CALLING_EXCLUSIVE,\n    name: \"PTC Exclusive Mode\",\n    description: \"Replace all tools with code_execution (forces PTC usage)\",\n    enabledByDefault: false,\n    userOverridable: true,\n    showInSettings: true,\n  },\n  [EXPERIMENT_IDS.CONFIGURABLE_BIND_URL]: {\n    id: EXPERIMENT_IDS.CONFIGURABLE_BIND_URL,\n    name: \"Expose API server on LAN/VPN\",\n    description:\n      \"Allow mux to listen on a non-localhost address so other devices on your LAN/VPN can connect. Anyone on your network with the auth token can access your mux API. HTTP only; use only on trusted networks (Tailscale recommended).\",\n    enabledByDefault: false,\n    userOverridable: true,\n    showInSettings: true,\n  },\n  [EXPERIMENT_IDS.SYSTEM_1]: {\n    id: EXPERIMENT_IDS.SYSTEM_1,\n    name: \"System 1\",\n    description: \"Context optimization helpers inspired by Thinking, Fast and Slow (Kahneman)\",\n    enabledByDefault: false,\n    userOverridable: true,\n    showInSettings: true,\n  },\n  [EXPERIMENT_IDS.EXEC_SUBAGENT_HARD_RESTART]: {\n    id: EXPERIMENT_IDS.EXEC_SUBAGENT_HARD_RESTART,\n    name: \"Exec sub-agent hard restart\",\n    description: \"Hard-restart exec sub-agents on context overflow\",\n    enabledByDefault: false,\n    userOverridable: true,\n    showInSettings: true,\n  },\n  [EXPERIMENT_IDS.MUX_GOVERNOR]: {\n    id: EXPERIMENT_IDS.MUX_GOVERNOR,\n    name: \"Mux Governor\",\n    description: \"Remote policy delivery for enterprise Mux Governor service\",\n    enabledByDefault: false,\n    userOverridable: true,\n    showInSettings: true,\n  },\n};\n\n/**\n * Get localStorage key for an experiment.\n * Format: \"experiment:{experimentId}\"\n */\nexport function getExperimentKey(experimentId: ExperimentId): string {\n  return `experiment:${experimentId}`;\n}\n\n/**\n * Get all experiment definitions as an array for iteration.\n */\nexport function getExperimentList(): ExperimentDefinition[] {\n  return Object.values(EXPERIMENTS);\n}\n"]}