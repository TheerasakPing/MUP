{"version":3,"file":"muxGovernorOAuth.js","sourceRoot":"","sources":["../../../src/common/constants/muxGovernorOAuth.ts"],"names":[],"mappings":";AAAA;;;GAGG;;;;;;;AAEH,wEAG4C;sGAF1C,uCAAqB;0GACrB,2CAAyB;AAM3B;;;GAGG;AACH,8BAAqC,QAAgB,EAAU;IAC7D,MAAM,GAAG,GAAG,IAAI,GAAG,CAAC,QAAQ,CAAC,CAAC;IAC9B,IAAI,GAAG,CAAC,QAAQ,KAAK,OAAO,IAAI,GAAG,CAAC,QAAQ,KAAK,QAAQ,EAAE,CAAC;QAC1D,MAAM,IAAI,KAAK,CAAC,2BAA2B,GAAG,CAAC,QAAQ,0BAA0B,CAAC,CAAC;IACrF,CAAC;IACD,OAAO,GAAG,CAAC,MAAM,CAAC;AAAA,CACnB;AAED;;GAEG;AACH,mCAA0C,KAIzC,EAAU;IACT,MAAM,GAAG,GAAG,IAAI,GAAG,CAAC,mBAAmB,EAAE,KAAK,CAAC,cAAc,CAAC,CAAC;IAC/D,GAAG,CAAC,YAAY,CAAC,GAAG,CAAC,eAAe,EAAE,MAAM,CAAC,CAAC;IAC9C,GAAG,CAAC,YAAY,CAAC,GAAG,CAAC,WAAW,EAAE,uCAAqB,CAAC,CAAC;IACzD,GAAG,CAAC,YAAY,CAAC,GAAG,CAAC,cAAc,EAAE,KAAK,CAAC,WAAW,CAAC,CAAC;IACxD,GAAG,CAAC,YAAY,CAAC,GAAG,CAAC,OAAO,EAAE,KAAK,CAAC,KAAK,CAAC,CAAC;IAC3C,OAAO,GAAG,CAAC,QAAQ,EAAE,CAAC;AAAA,CACvB;AAED;;GAEG;AACH,kCAAyC,cAAsB,EAAU;IACvE,OAAO,IAAI,GAAG,CAAC,yBAAyB,EAAE,cAAc,CAAC,CAAC,QAAQ,EAAE,CAAC;AAAA,CACtE;AAED;;GAEG;AACH,mCAA0C,KAAuB,EAAmB;IAClF,MAAM,IAAI,GAAG,IAAI,eAAe,EAAE,CAAC;IACnC,IAAI,CAAC,GAAG,CAAC,YAAY,EAAE,oBAAoB,CAAC,CAAC;IAC7C,IAAI,CAAC,GAAG,CAAC,MAAM,EAAE,KAAK,CAAC,IAAI,CAAC,CAAC;IAC7B,IAAI,CAAC,GAAG,CAAC,WAAW,EAAE,uCAAqB,CAAC,CAAC;IAC7C,IAAI,CAAC,GAAG,CAAC,eAAe,EAAE,2CAAyB,CAAC,CAAC;IACrD,OAAO,IAAI,CAAC;AAAA,CACb","sourcesContent":["/**\n * OAuth constants and helpers for Mux Governor (enterprise policy service).\n * Uses same client credentials as Mux Gateway but with a user-provided origin.\n */\n\nimport {\n  MUX_GATEWAY_CLIENT_ID,\n  MUX_GATEWAY_CLIENT_SECRET,\n} from \"@/common/constants/muxGatewayOAuth\";\n\n// Re-export gateway credentials for use by governor\nexport { MUX_GATEWAY_CLIENT_ID, MUX_GATEWAY_CLIENT_SECRET };\n\n/**\n * Normalize a user-entered URL to an origin (scheme + host + port).\n * Throws if URL is invalid or uses unsupported scheme.\n */\nexport function normalizeGovernorUrl(inputUrl: string): string {\n  const url = new URL(inputUrl);\n  if (url.protocol !== \"http:\" && url.protocol !== \"https:\") {\n    throw new Error(`Unsupported URL scheme: ${url.protocol}. Must be http or https.`);\n  }\n  return url.origin;\n}\n\n/**\n * Build the OAuth2 authorize URL for a Mux Governor server.\n */\nexport function buildGovernorAuthorizeUrl(input: {\n  governorOrigin: string;\n  redirectUri: string;\n  state: string;\n}): string {\n  const url = new URL(\"/oauth2/authorize\", input.governorOrigin);\n  url.searchParams.set(\"response_type\", \"code\");\n  url.searchParams.set(\"client_id\", MUX_GATEWAY_CLIENT_ID);\n  url.searchParams.set(\"redirect_uri\", input.redirectUri);\n  url.searchParams.set(\"state\", input.state);\n  return url.toString();\n}\n\n/**\n * Build the OAuth2 token exchange URL for a Mux Governor server.\n */\nexport function buildGovernorExchangeUrl(governorOrigin: string): string {\n  return new URL(\"/api/v1/oauth2/exchange\", governorOrigin).toString();\n}\n\n/**\n * Build the request body for the OAuth2 token exchange.\n */\nexport function buildGovernorExchangeBody(input: { code: string }): URLSearchParams {\n  const body = new URLSearchParams();\n  body.set(\"grant_type\", \"authorization_code\");\n  body.set(\"code\", input.code);\n  body.set(\"client_id\", MUX_GATEWAY_CLIENT_ID);\n  body.set(\"client_secret\", MUX_GATEWAY_CLIENT_SECRET);\n  return body;\n}\n"]}