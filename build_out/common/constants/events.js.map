{"version":3,"file":"events.js","sourceRoot":"","sources":["../../../src/common/constants/events.ts"],"names":[],"mappings":";AAAA;;;;;GAKG;;;;AAMU,QAAA,aAAa,GAAG;IAC3B;;;OAGG;IACH,oBAAoB,EAAE,wBAAwB;IAE9C;;;OAGG;IACH,iBAAiB,EAAE,qBAAqB;IAExC;;;OAGG;IACH,mBAAmB,EAAE,uBAAuB;IAE5C;;;OAGG;IACH,iBAAiB,EAAE,qBAAqB;IAExC;;;OAGG;IACH,kBAAkB,EAAE,sBAAsB;IAE1C;;;OAGG;IACH,wBAAwB,EAAE,4BAA4B;IAEtD;;;;;;;;;;OAUG;IACH,sBAAsB,EAAE,0BAA0B;IAElD;;;OAGG;IACH,2BAA2B,EAAE,8BAA8B;IAE3D;;;OAGG;IACH,qBAAqB,EAAE,yBAAyB;IAEhD;;;OAGG;IACH,eAAe,EAAE,oBAAoB;IACrC;;;OAGG;IACH,wBAAwB,EAAE,4BAA4B;IAEtD;;;OAGG;IACH,kBAAkB,EAAE,sBAAsB;IAE1C;;;OAGG;IACH,sBAAsB,EAAE,yBAAyB;CACzC,CAAC;AAuDX;;;;;;;;;;;GAWG;AACH,2BACE,SAAY,EACZ,GAAG,IAAkF,EAChD;IACrC,MAAM,CAAC,MAAM,CAAC,GAAG,IAAI,CAAC;IACtB,OAAO,IAAI,WAAW,CAAC,SAAS,EAAE,EAAE,MAAM,EAA6C,CAAC,CAAC;AAAA,CAC1F;AAED;;;GAGG;AACI,MAAM,qBAAqB,GAAG,CAAC,GAAW,EAAU,EAAE,CAAC,kBAAkB,GAAG,EAAE,CAAC;AAAzE,QAAA,qBAAqB,GAArB,qBAAqB,CAAoD","sourcesContent":["/**\n * Custom Event Constants & Types\n * These are window-level custom events used for cross-component communication\n *\n * Each event has a corresponding type in CustomEventPayloads for type safety\n */\n\nimport type { ThinkingLevel } from \"@/common/types/thinking\";\nimport type { ReviewNoteDataForDisplay } from \"@/common/types/message\";\nimport type { FilePart } from \"@/common/orpc/schemas\";\n\nexport const CUSTOM_EVENTS = {\n  /**\n   * Event to show a toast notification when thinking level changes\n   * Detail: { workspaceId: string, level: ThinkingLevel }\n   */\n  THINKING_LEVEL_TOAST: \"mux:thinkingLevelToast\",\n\n  /**\n   * Event to insert text into the chat input\n   * Detail: { text: string, mode?: \"replace\" | \"append\", fileParts?: FilePart[], reviews?: ReviewNoteDataForDisplay[] }\n   */\n  UPDATE_CHAT_INPUT: \"mux:updateChatInput\",\n\n  /**\n   * Event to open the model selector\n   * No detail\n   */\n  OPEN_MODEL_SELECTOR: \"mux:openModelSelector\",\n\n  /**\n   * Event to open the agent picker (AgentModePicker)\n   * No detail\n   */\n  OPEN_AGENT_PICKER: \"mux:openAgentPicker\",\n\n  /**\n   * Event to close the agent picker (AgentModePicker)\n   * No detail\n   */\n  CLOSE_AGENT_PICKER: \"mux:closeAgentPicker\",\n\n  /**\n   * Event to request a refresh of the agent definition list (AgentContext).\n   * No detail.\n   */\n  AGENTS_REFRESH_REQUESTED: \"mux:agentsRefreshRequested\",\n\n  /**\n   * Event to trigger resume check for a workspace\n   * Detail: { workspaceId: string }\n   *\n   * Emitted when:\n   * - Stream error occurs\n   * - Stream aborted\n   * - App startup (for all workspaces with interrupted streams)\n   *\n   * useResumeManager handles this idempotently - safe to emit multiple times\n   */\n  RESUME_CHECK_REQUESTED: \"mux:resumeCheckRequested\",\n\n  /**\n   * Event emitted when the mux gateway session expires.\n   * No detail\n   */\n  MUX_GATEWAY_SESSION_EXPIRED: \"mux:muxGatewaySessionExpired\",\n\n  /**\n   * Event to switch to a different workspace after fork\n   * Detail: { workspaceId: string, projectPath: string, projectName: string, workspacePath: string, branch: string }\n   */\n  WORKSPACE_FORK_SWITCH: \"mux:workspaceForkSwitch\",\n\n  /**\n   * Event to execute a command from the command palette\n   * Detail: { commandId: string }\n   */\n  EXECUTE_COMMAND: \"mux:executeCommand\",\n  /**\n   * Event to enter the chat-based workspace creation experience.\n   * Detail: { projectPath: string, startMessage?: string, model?: string, trunkBranch?: string, runtime?: string }\n   */\n  START_WORKSPACE_CREATION: \"mux:startWorkspaceCreation\",\n\n  /**\n   * Event to toggle voice input (dictation) mode\n   * No detail\n   */\n  TOGGLE_VOICE_INPUT: \"mux:toggleVoiceInput\",\n\n  /**\n   * Event to open the debug LLM request modal\n   * No detail\n   */\n  OPEN_DEBUG_LLM_REQUEST: \"mux:openDebugLlmRequest\",\n} as const;\n\n/**\n * Payload types for custom events\n * Maps event names to their detail payload structure\n */\nexport interface CustomEventPayloads {\n  [CUSTOM_EVENTS.THINKING_LEVEL_TOAST]: {\n    workspaceId: string;\n    level: ThinkingLevel;\n  };\n  [CUSTOM_EVENTS.UPDATE_CHAT_INPUT]: {\n    text: string;\n    mode?: \"replace\" | \"append\";\n    fileParts?: FilePart[];\n    reviews?: ReviewNoteDataForDisplay[];\n  };\n  [CUSTOM_EVENTS.OPEN_AGENT_PICKER]: never; // No payload\n  [CUSTOM_EVENTS.CLOSE_AGENT_PICKER]: never; // No payload\n  [CUSTOM_EVENTS.AGENTS_REFRESH_REQUESTED]: never; // No payload\n  [CUSTOM_EVENTS.OPEN_MODEL_SELECTOR]: never; // No payload\n  [CUSTOM_EVENTS.RESUME_CHECK_REQUESTED]: {\n    workspaceId: string;\n    isManual?: boolean; // true when user explicitly clicks retry (bypasses eligibility checks)\n  };\n  [CUSTOM_EVENTS.MUX_GATEWAY_SESSION_EXPIRED]: never; // No payload\n  [CUSTOM_EVENTS.WORKSPACE_FORK_SWITCH]: {\n    workspaceId: string;\n    projectPath: string;\n    projectName: string;\n    workspacePath: string;\n    branch: string;\n  };\n  [CUSTOM_EVENTS.EXECUTE_COMMAND]: {\n    commandId: string;\n  };\n  [CUSTOM_EVENTS.START_WORKSPACE_CREATION]: {\n    projectPath: string;\n    startMessage?: string;\n    model?: string;\n    trunkBranch?: string;\n    runtime?: string;\n  };\n  [CUSTOM_EVENTS.TOGGLE_VOICE_INPUT]: never; // No payload\n  [CUSTOM_EVENTS.OPEN_DEBUG_LLM_REQUEST]: never; // No payload\n}\n\n/**\n * Type-safe custom event type\n * Usage: CustomEventType<typeof CUSTOM_EVENTS.RESUME_CHECK_REQUESTED>\n */\nexport type CustomEventType<K extends keyof CustomEventPayloads> = CustomEvent<\n  CustomEventPayloads[K]\n>;\n\n/**\n * Helper to create a typed custom event\n *\n * @example\n * ```typescript\n * const event = createCustomEvent(CUSTOM_EVENTS.RESUME_CHECK_REQUESTED, {\n *   workspaceId: 'abc123',\n *   isManual: true\n * });\n * window.dispatchEvent(event);\n * ```\n */\nexport function createCustomEvent<K extends keyof CustomEventPayloads>(\n  eventName: K,\n  ...args: CustomEventPayloads[K] extends never ? [] : [detail: CustomEventPayloads[K]]\n): CustomEvent<CustomEventPayloads[K]> {\n  const [detail] = args;\n  return new CustomEvent(eventName, { detail } as CustomEventInit<CustomEventPayloads[K]>);\n}\n\n/**\n * Helper to create a storage change event name for a specific key\n * Used by usePersistedState for same-tab synchronization\n */\nexport const getStorageChangeEvent = (key: string): string => `storage-change:${key}`;\n"]}