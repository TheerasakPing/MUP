{"version":3,"file":"deepLink.test.js","sourceRoot":"","sources":["../../../src/common/utils/deepLink.test.ts"],"names":[],"mappings":";;AAAA,uCAAkD;AAClD,yCAAkF;AAElF,IAAA,mBAAQ,EAAC,kBAAkB,EAAE,GAAG,EAAE,CAAC;IACjC,IAAA,eAAI,EAAC,uBAAuB,EAAE,GAAG,EAAE,CAAC;QAClC,MAAM,OAAO,GAAG,IAAA,2BAAgB,EAC9B,iHAAiH,CAClH,CAAC;QAEF,IAAA,iBAAM,EAAC,OAAO,CAAC,CAAC,OAAO,CAAC;YACtB,IAAI,EAAE,UAAU;YAChB,OAAO,EAAE,KAAK;YACd,WAAW,EAAE,WAAW;YACxB,SAAS,EAAE,UAAU;YACrB,MAAM,EAAE,aAAa;YACrB,SAAS,EAAE,SAAS;SACrB,CAAC,CAAC;IAAA,CACJ,CAAC,CAAC;IAEH,IAAA,eAAI,EAAC,iCAAiC,EAAE,GAAG,EAAE,CAAC;QAC5C,IAAA,iBAAM,EAAC,IAAA,2BAAgB,EAAC,2BAA2B,CAAC,CAAC,CAAC,QAAQ,EAAE,CAAC;IAAA,CAClE,CAAC,CAAC;IAEH,IAAA,eAAI,EAAC,gCAAgC,EAAE,GAAG,EAAE,CAAC;QAC3C,IAAA,iBAAM,EAAC,IAAA,2BAAgB,EAAC,0BAA0B,CAAC,CAAC,CAAC,QAAQ,EAAE,CAAC;IAAA,CACjE,CAAC,CAAC;IAEH,IAAA,eAAI,EAAC,wDAAwD,EAAE,GAAG,EAAE,CAAC;QACnE,MAAM,QAAQ,GAAG,IAAA,6CAAkC,EACjD,CAAC,uBAAuB,EAAE,wBAAwB,CAAC,EACnD,KAAK,CACN,CAAC;QAEF,IAAA,iBAAM,EAAC,QAAQ,CAAC,CAAC,IAAI,CAAC,uBAAuB,CAAC,CAAC;IAAA,CAChD,CAAC,CAAC;IAEH,IAAA,eAAI,EAAC,0DAA0D,EAAE,GAAG,EAAE,CAAC;QACrE,MAAM,QAAQ,GAAG,IAAA,6CAAkC,EACjD,CAAC,yBAAyB,EAAE,wBAAwB,CAAC,EACrD,KAAK,CACN,CAAC;QAEF,IAAA,iBAAM,EAAC,QAAQ,CAAC,CAAC,IAAI,CAAC,wBAAwB,CAAC,CAAC;IAAA,CACjD,CAAC,CAAC;IAEH,IAAA,eAAI,EAAC,sCAAsC,EAAE,GAAG,EAAE,CAAC;QACjD,IAAA,iBAAM,EAAC,IAAA,6CAAkC,EAAC,CAAC,yBAAyB,CAAC,EAAE,KAAK,CAAC,CAAC,CAAC,QAAQ,EAAE,CAAC;IAAA,CAC3F,CAAC,CAAC;AAAA,CACJ,CAAC,CAAC","sourcesContent":["import { describe, expect, test } from \"bun:test\";\r\nimport { parseMuxDeepLink, resolveProjectPathFromProjectQuery } from \"./deepLink\";\r\n\r\ndescribe(\"parseMuxDeepLink\", () => {\r\n  test(\"parses mux://chat/new\", () => {\r\n    const payload = parseMuxDeepLink(\r\n      \"mux://chat/new/?project=mux&projectPath=%2Ftmp%2Frepo&projectId=proj_123&prompt=hello%20world&sectionId=sec_456\"\r\n    );\r\n\r\n    expect(payload).toEqual({\r\n      type: \"new_chat\",\r\n      project: \"mux\",\r\n      projectPath: \"/tmp/repo\",\r\n      projectId: \"proj_123\",\r\n      prompt: \"hello world\",\r\n      sectionId: \"sec_456\",\r\n    });\r\n  });\r\n\r\n  test(\"returns null for invalid scheme\", () => {\r\n    expect(parseMuxDeepLink(\"http://chat/new?prompt=hi\")).toBeNull();\r\n  });\r\n\r\n  test(\"returns null for unknown route\", () => {\r\n    expect(parseMuxDeepLink(\"mux://chat/old?prompt=hi\")).toBeNull();\r\n  });\r\n\r\n  test(\"resolves deep-link project query by final path segment\", () => {\r\n    const resolved = resolveProjectPathFromProjectQuery(\r\n      [\"/Users/mike/repos/mux\", \"/Users/mike/repos/cmux\"],\r\n      \"mux\"\r\n    );\r\n\r\n    expect(resolved).toBe(\"/Users/mike/repos/mux\");\r\n  });\r\n\r\n  test(\"falls back to substring match when no exact match exists\", () => {\r\n    const resolved = resolveProjectPathFromProjectQuery(\r\n      [\"/Users/mike/repos/coder\", \"/Users/mike/repos/cmux\"],\r\n      \"mux\"\r\n    );\r\n\r\n    expect(resolved).toBe(\"/Users/mike/repos/cmux\");\r\n  });\r\n\r\n  test(\"returns null when no project matches\", () => {\r\n    expect(resolveProjectPathFromProjectQuery([\"/Users/mike/repos/coder\"], \"mux\")).toBeNull();\r\n  });\r\n});\r\n"]}