{"version":3,"file":"models.js","sourceRoot":"","sources":["../../../../src/common/utils/ai/models.ts"],"names":[],"mappings":";AAAA;;GAEG;;;;;;;;;AAEH,gEAAoF;AAEvE,QAAA,YAAY,GAAG,2BAAa,CAAC;AAE1C;;;;GAIG;AACH,2BAAkC,UAAkB,EAAU;IAC5D,IAAI,MAAM,CAAC,MAAM,CAAC,iCAAmB,EAAE,UAAU,CAAC,EAAE,CAAC;QACnD,OAAO,iCAAmB,CAAC,UAAU,CAAC,CAAC;IACzC,CAAC;IACD,OAAO,UAAU,CAAC;AAAA,CACnB;AAED;;;GAGG;AACH,4BAAmC,KAAa,EAAW;IACzD,MAAM,UAAU,GAAG,KAAK,CAAC,OAAO,CAAC,GAAG,CAAC,CAAC;IACtC,OAAO,UAAU,GAAG,CAAC,IAAI,UAAU,GAAG,KAAK,CAAC,MAAM,GAAG,CAAC,CAAC;AAAA,CACxD;AAED,MAAM,kBAAkB,GAAG,cAAc,CAAC;AAE1C;;;;GAIG;AACH,+BAAsC,WAAmB,EAAU;IACjE,IAAI,CAAC,WAAW,CAAC,UAAU,CAAC,kBAAkB,CAAC,EAAE,CAAC;QAChD,OAAO,WAAW,CAAC;IACrB,CAAC;IACD,sEAAoE;IACpE,MAAM,KAAK,GAAG,WAAW,CAAC,KAAK,CAAC,kBAAkB,CAAC,MAAM,CAAC,CAAC;IAC3D,MAAM,UAAU,GAAG,KAAK,CAAC,OAAO,CAAC,GAAG,CAAC,CAAC;IACtC,IAAI,UAAU,KAAK,CAAC,CAAC,EAAE,CAAC;QACtB,OAAO,WAAW,CAAC,CAAC,0BAA0B;IAChD,CAAC;IACD,OAAO,GAAG,KAAK,CAAC,KAAK,CAAC,CAAC,EAAE,UAAU,CAAC,IAAI,KAAK,CAAC,KAAK,CAAC,UAAU,GAAG,CAAC,CAAC,EAAE,CAAC;AAAA,CACvE;AAED;;;;GAIG;AACH,sBAA6B,WAAmB,EAAU;IACxD,MAAM,UAAU,GAAG,qBAAqB,CAAC,WAAW,CAAC,CAAC;IACtD,MAAM,UAAU,GAAG,UAAU,CAAC,OAAO,CAAC,GAAG,CAAC,CAAC;IAC3C,IAAI,UAAU,KAAK,CAAC,CAAC,EAAE,CAAC;QACtB,OAAO,UAAU,CAAC;IACpB,CAAC;IACD,OAAO,UAAU,CAAC,SAAS,CAAC,UAAU,GAAG,CAAC,CAAC,CAAC;AAAA,CAC7C;AAED;;;;GAIG;AACH,0BAAiC,WAAmB,EAAU;IAC5D,MAAM,UAAU,GAAG,qBAAqB,CAAC,WAAW,CAAC,CAAC;IACtD,MAAM,UAAU,GAAG,UAAU,CAAC,OAAO,CAAC,GAAG,CAAC,CAAC;IAC3C,IAAI,UAAU,KAAK,CAAC,CAAC,EAAE,CAAC;QACtB,OAAO,EAAE,CAAC;IACZ,CAAC;IACD,OAAO,UAAU,CAAC,SAAS,CAAC,CAAC,EAAE,UAAU,CAAC,CAAC;AAAA,CAC5C;AAED;;;;;GAKG;AACH,2BAAkC,WAAmB,EAAW;IAC9D,MAAM,UAAU,GAAG,qBAAqB,CAAC,WAAW,CAAC,CAAC;IACtD,MAAM,CAAC,QAAQ,EAAE,SAAS,CAAC,GAAG,UAAU,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC;IACpD,IAAI,QAAQ,KAAK,WAAW,EAAE,CAAC;QAC7B,OAAO,KAAK,CAAC;IACf,CAAC;IACD,+DAA+D;IAC/D,OAAO,CACL,CAAC,SAAS,EAAE,QAAQ,CAAC,iBAAiB,CAAC,IAAI,CAAC,SAAS,CAAC,QAAQ,CAAC,iBAAiB,CAAC,CAAC;QAClF,SAAS,EAAE,QAAQ,CAAC,iBAAiB,CAAC,KAAK,IAAI,CAChD,CAAC;AAAA,CACH","sourcesContent":["/**\r\n * Model configuration and constants\r\n */\r\n\r\nimport { DEFAULT_MODEL, MODEL_ABBREVIATIONS } from \"@/common/constants/knownModels\";\r\n\r\nexport const defaultModel = DEFAULT_MODEL;\r\n\r\n/**\r\n * Resolve model alias to full model string.\r\n * If the input is an alias (e.g., \"haiku\", \"sonnet\"), returns the full model string.\r\n * Otherwise returns the input unchanged.\r\n */\r\nexport function resolveModelAlias(modelInput: string): string {\r\n  if (Object.hasOwn(MODEL_ABBREVIATIONS, modelInput)) {\r\n    return MODEL_ABBREVIATIONS[modelInput];\r\n  }\r\n  return modelInput;\r\n}\r\n\r\n/**\r\n * Validate model string format (must be \"provider:model-id\").\r\n * Supports colons in the model ID (e.g., \"ollama:gpt-oss:20b\").\r\n */\r\nexport function isValidModelFormat(model: string): boolean {\r\n  const colonIndex = model.indexOf(\":\");\r\n  return colonIndex > 0 && colonIndex < model.length - 1;\r\n}\r\n\r\nconst MUX_GATEWAY_PREFIX = \"mux-gateway:\";\r\n\r\n/**\r\n * Normalize gateway-prefixed model strings to standard format.\r\n * Converts \"mux-gateway:provider/model\" to \"provider:model\".\r\n * Returns non-gateway strings unchanged.\r\n */\r\nexport function normalizeGatewayModel(modelString: string): string {\r\n  if (!modelString.startsWith(MUX_GATEWAY_PREFIX)) {\r\n    return modelString;\r\n  }\r\n  // mux-gateway:anthropic/claude-opus-4-5 â†’ anthropic:claude-opus-4-5\r\n  const inner = modelString.slice(MUX_GATEWAY_PREFIX.length);\r\n  const slashIndex = inner.indexOf(\"/\");\r\n  if (slashIndex === -1) {\r\n    return modelString; // Malformed, return as-is\r\n  }\r\n  return `${inner.slice(0, slashIndex)}:${inner.slice(slashIndex + 1)}`;\r\n}\r\n\r\n/**\r\n * Extract the model name from a model string (e.g., \"anthropic:claude-sonnet-4-5\" -> \"claude-sonnet-4-5\")\r\n * @param modelString - Full model string in format \"provider:model-name\"\r\n * @returns The model name part (after the colon), or the full string if no colon is found\r\n */\r\nexport function getModelName(modelString: string): string {\r\n  const normalized = normalizeGatewayModel(modelString);\r\n  const colonIndex = normalized.indexOf(\":\");\r\n  if (colonIndex === -1) {\r\n    return normalized;\r\n  }\r\n  return normalized.substring(colonIndex + 1);\r\n}\r\n\r\n/**\r\n * Extract the provider from a model string (e.g., \"anthropic:claude-sonnet-4-5\" -> \"anthropic\")\r\n * @param modelString - Full model string in format \"provider:model-name\"\r\n * @returns The provider part (before the colon), or empty string if no colon is found\r\n */\r\nexport function getModelProvider(modelString: string): string {\r\n  const normalized = normalizeGatewayModel(modelString);\r\n  const colonIndex = normalized.indexOf(\":\");\r\n  if (colonIndex === -1) {\r\n    return \"\";\r\n  }\r\n  return normalized.substring(0, colonIndex);\r\n}\r\n\r\n/**\r\n * Check if a model supports the 1M context window.\r\n * The 1M context window is available for Claude Sonnet 4/4.5 and Opus 4.6.\r\n * @param modelString - Full model string in format \"provider:model-name\"\r\n * @returns True if the model supports 1M context window\r\n */\r\nexport function supports1MContext(modelString: string): boolean {\r\n  const normalized = normalizeGatewayModel(modelString);\r\n  const [provider, modelName] = normalized.split(\":\");\r\n  if (provider !== \"anthropic\") {\r\n    return false;\r\n  }\r\n  // Sonnet 4, Sonnet 4.5, and Opus 4.6 support 1M context (beta)\r\n  return (\r\n    (modelName?.includes(\"claude-sonnet-4\") && !modelName.includes(\"claude-sonnet-3\")) ||\r\n    modelName?.includes(\"claude-opus-4-6\") === true\r\n  );\r\n}\r\n"]}