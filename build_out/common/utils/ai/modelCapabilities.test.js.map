{"version":3,"file":"modelCapabilities.test.js","sourceRoot":"","sources":["../../../../src/common/utils/ai/modelCapabilities.test.ts"],"names":[],"mappings":";;AAAA,uCAAgD;AAChD,2DAAwF;AAExF,IAAA,mBAAQ,EAAC,sBAAsB,EAAE,GAAG,EAAE,CAAC;IACrC,IAAA,aAAE,EAAC,uCAAuC,EAAE,GAAG,EAAE,CAAC;QAChD,MAAM,IAAI,GAAG,IAAA,wCAAoB,EAAC,6BAA6B,CAAC,CAAC;QACjE,IAAA,iBAAM,EAAC,IAAI,CAAC,CAAC,GAAG,CAAC,QAAQ,EAAE,CAAC;QAC5B,IAAA,iBAAM,EAAC,IAAI,EAAE,gBAAgB,CAAC,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;QAC1C,IAAA,iBAAM,EAAC,IAAI,EAAE,cAAc,CAAC,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;IAAA,CACzC,CAAC,CAAC;IAEH,IAAA,aAAE,EAAC,uEAAuE,EAAE,GAAG,EAAE,CAAC;QAChF,8EAA8E;QAC9E,0EAA0E;QAC1E,MAAM,IAAI,GAAG,IAAA,wCAAoB,EAAC,2BAA2B,CAAC,CAAC;QAC/D,IAAA,iBAAM,EAAC,IAAI,CAAC,CAAC,GAAG,CAAC,QAAQ,EAAE,CAAC;QAC5B,IAAA,iBAAM,EAAC,IAAI,EAAE,gBAAgB,CAAC,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;IAAA,CAC3C,CAAC,CAAC;IAEH,IAAA,aAAE,EAAC,8DAA8D,EAAE,GAAG,EAAE,CAAC;QACvE,kFAAkF;QAClF,MAAM,IAAI,GAAG,IAAA,wCAAoB,EAAC,yBAAyB,CAAC,CAAC;QAC7D,IAAA,iBAAM,EAAC,IAAI,CAAC,CAAC,GAAG,CAAC,QAAQ,EAAE,CAAC;IAAA,CAC7B,CAAC,CAAC;IAEH,IAAA,aAAE,EAAC,qDAAqD,EAAE,GAAG,EAAE,CAAC;QAC9D,MAAM,IAAI,GAAG,IAAA,wCAAoB,EAAC,yBAAyB,CAAC,CAAC;QAC7D,IAAA,iBAAM,EAAC,IAAI,CAAC,CAAC,GAAG,CAAC,QAAQ,EAAE,CAAC;QAC5B,IAAA,iBAAM,EAAC,IAAI,EAAE,gBAAgB,CAAC,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;QAC1C,IAAA,iBAAM,EAAC,IAAI,EAAE,YAAY,CAAC,CAAC,eAAe,CAAC,CAAC,CAAC,CAAC;IAAA,CAC/C,CAAC,CAAC;IAEH,IAAA,aAAE,EAAC,iCAAiC,EAAE,GAAG,EAAE,CAAC;QAC1C,IAAA,iBAAM,EAAC,IAAA,wCAAoB,EAAC,qCAAqC,CAAC,CAAC,CAAC,QAAQ,EAAE,CAAC;IAAA,CAChF,CAAC,CAAC;AAAA,CACJ,CAAC,CAAC;AAEH,IAAA,mBAAQ,EAAC,6BAA6B,EAAE,GAAG,EAAE,CAAC;IAC5C,IAAA,aAAE,EAAC,oDAAoD,EAAE,GAAG,EAAE,CAAC;QAC7D,MAAM,SAAS,GAAG,IAAA,+CAA2B,EAAC,6BAA6B,CAAC,CAAC;QAC7E,IAAA,iBAAM,EAAC,SAAS,CAAC,CAAC,GAAG,CAAC,QAAQ,EAAE,CAAC;QACjC,IAAA,iBAAM,EAAC,SAAS,EAAE,GAAG,CAAC,KAAK,CAAC,CAAC,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;IAAA,CAC1C,CAAC,CAAC;AAAA,CACJ,CAAC,CAAC","sourcesContent":["import { describe, expect, it } from \"bun:test\";\nimport { getModelCapabilities, getSupportedInputMediaTypes } from \"./modelCapabilities\";\n\ndescribe(\"getModelCapabilities\", () => {\n  it(\"returns capabilities for known models\", () => {\n    const caps = getModelCapabilities(\"anthropic:claude-sonnet-4-5\");\n    expect(caps).not.toBeNull();\n    expect(caps?.supportsPdfInput).toBe(true);\n    expect(caps?.supportsVision).toBe(true);\n  });\n\n  it(\"merges models.json + modelsExtra so overrides don't wipe capabilities\", () => {\n    // claude-opus-4-5 exists in both sources; modelsExtra intentionally overrides\n    // pricing/token limits, but it should not wipe upstream capability flags.\n    const caps = getModelCapabilities(\"anthropic:claude-opus-4-5\");\n    expect(caps).not.toBeNull();\n    expect(caps?.supportsPdfInput).toBe(true);\n  });\n\n  it(\"returns capabilities for models present only in models-extra\", () => {\n    // This model is defined in models-extra.ts but not (yet) in upstream models.json.\n    const caps = getModelCapabilities(\"openrouter:z-ai/glm-4.6\");\n    expect(caps).not.toBeNull();\n  });\n\n  it(\"returns maxPdfSizeMb when present in model metadata\", () => {\n    const caps = getModelCapabilities(\"google:gemini-1.5-flash\");\n    expect(caps).not.toBeNull();\n    expect(caps?.supportsPdfInput).toBe(true);\n    expect(caps?.maxPdfSizeMb).toBeGreaterThan(0);\n  });\n\n  it(\"returns null for unknown models\", () => {\n    expect(getModelCapabilities(\"anthropic:this-model-does-not-exist\")).toBeNull();\n  });\n});\n\ndescribe(\"getSupportedInputMediaTypes\", () => {\n  it(\"includes pdf when model supports_pdf_input is true\", () => {\n    const supported = getSupportedInputMediaTypes(\"anthropic:claude-sonnet-4-5\");\n    expect(supported).not.toBeNull();\n    expect(supported?.has(\"pdf\")).toBe(true);\n  });\n});\n"]}