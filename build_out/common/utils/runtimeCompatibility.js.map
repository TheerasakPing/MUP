{"version":3,"file":"runtimeCompatibility.js","sourceRoot":"","sources":["../../../src/common/utils/runtimeCompatibility.ts"],"names":[],"mappings":";AAAA;;;;;GAKG;;;AAEH,mDAA0D;AAG1D;;;;;;;;;;;;;GAaG;AACH,qCAA4C,MAAiC,EAAW;IACtF,IAAI,CAAC,MAAM,EAAE,CAAC;QACZ,OAAO,KAAK,CAAC;IACf,CAAC;IACD,qCAAqC;IACrC,OAAO,CAAC,2BAAiB,CAAC,SAAS,CAAC,MAAM,CAAC,IAAI,CAAC,CAAC,OAAO,CAAC;AAAA,CAC1D","sourcesContent":["/**\r\n * Runtime configuration compatibility checks.\r\n *\r\n * This module is intentionally in common/ to avoid circular dependencies\r\n * with runtime implementations (LocalRuntime, SSHRuntime, etc.).\r\n */\r\n\r\nimport { RuntimeModeSchema } from \"@/common/orpc/schemas\";\r\nimport type { RuntimeConfig } from \"@/common/types/runtime\";\r\n\r\n/**\r\n * Check if a runtime config is from a newer version and incompatible.\r\n *\r\n * This handles downgrade compatibility: if a user upgrades to a version\r\n * with new runtime types, then downgrades, those workspaces should show\r\n * a clear error rather than crashing.\r\n *\r\n * Currently supported types:\r\n * - \"local\" without srcBaseDir: Project-dir runtime (uses project path directly)\r\n * - \"local\" with srcBaseDir: Legacy worktree config (for backward compat)\r\n * - \"worktree\": Explicit worktree runtime\r\n * - \"ssh\": Remote SSH runtime\r\n * - \"docker\": Docker container runtime\r\n */\r\nexport function isIncompatibleRuntimeConfig(config: RuntimeConfig | undefined): boolean {\r\n  if (!config) {\r\n    return false;\r\n  }\r\n  // Unknown type from a future version\r\n  return !RuntimeModeSchema.safeParse(config.type).success;\r\n}\r\n"]}