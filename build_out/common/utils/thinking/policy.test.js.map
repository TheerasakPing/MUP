{"version":3,"file":"policy.test.js","sourceRoot":"","sources":["../../../../src/common/utils/thinking/policy.test.ts"],"names":[],"mappings":"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","sourcesContent":["import { describe, expect, test } from \"bun:test\";\r\nimport { getThinkingPolicyForModel, enforceThinkingPolicy, resolveThinkingInput } from \"./policy\";\r\n\r\ndescribe(\"getThinkingPolicyForModel\", () => {\r\n  test(\"returns 5 levels including xhigh for gpt-5.1-codex-max\", () => {\r\n    expect(getThinkingPolicyForModel(\"openai:gpt-5.1-codex-max\")).toEqual([\r\n      \"off\",\r\n      \"low\",\r\n      \"medium\",\r\n      \"high\",\r\n      \"xhigh\",\r\n    ]);\r\n  });\r\n\r\n  test(\"returns 5 levels for gpt-5.1-codex-max with version suffix\", () => {\r\n    expect(getThinkingPolicyForModel(\"openai:gpt-5.1-codex-max-2025-12-01\")).toEqual([\r\n      \"off\",\r\n      \"low\",\r\n      \"medium\",\r\n      \"high\",\r\n      \"xhigh\",\r\n    ]);\r\n  });\r\n\r\n  test(\"returns 5 levels for bare gpt-5.1-codex-max without prefix\", () => {\r\n    expect(getThinkingPolicyForModel(\"gpt-5.1-codex-max\")).toEqual([\r\n      \"off\",\r\n      \"low\",\r\n      \"medium\",\r\n      \"high\",\r\n      \"xhigh\",\r\n    ]);\r\n  });\r\n\r\n  test(\"returns 5 levels for codex-max alias\", () => {\r\n    expect(getThinkingPolicyForModel(\"codex-max\")).toEqual([\r\n      \"off\",\r\n      \"low\",\r\n      \"medium\",\r\n      \"high\",\r\n      \"xhigh\",\r\n    ]);\r\n  });\r\n\r\n  test(\"returns 5 levels for gpt-5.1-codex-max with whitespace after colon\", () => {\r\n    expect(getThinkingPolicyForModel(\"openai: gpt-5.1-codex-max\")).toEqual([\r\n      \"off\",\r\n      \"low\",\r\n      \"medium\",\r\n      \"high\",\r\n      \"xhigh\",\r\n    ]);\r\n  });\r\n\r\n  test(\"returns medium/high/xhigh for gpt-5.2-pro\", () => {\r\n    expect(getThinkingPolicyForModel(\"openai:gpt-5.2-pro\")).toEqual([\"medium\", \"high\", \"xhigh\"]);\r\n  });\r\n\r\n  test(\"returns medium/high/xhigh for gpt-5.2-pro behind mux-gateway\", () => {\r\n    expect(getThinkingPolicyForModel(\"mux-gateway:openai/gpt-5.2-pro\")).toEqual([\r\n      \"medium\",\r\n      \"high\",\r\n      \"xhigh\",\r\n    ]);\r\n  });\r\n\r\n  test(\"returns 5 levels including xhigh for gpt-5.2-codex\", () => {\r\n    expect(getThinkingPolicyForModel(\"openai:gpt-5.2-codex\")).toEqual([\r\n      \"off\",\r\n      \"low\",\r\n      \"medium\",\r\n      \"high\",\r\n      \"xhigh\",\r\n    ]);\r\n  });\r\n\r\n  test(\"returns 5 levels including xhigh for gpt-5.2\", () => {\r\n    expect(getThinkingPolicyForModel(\"openai:gpt-5.2\")).toEqual([\r\n      \"off\",\r\n      \"low\",\r\n      \"medium\",\r\n      \"high\",\r\n      \"xhigh\",\r\n    ]);\r\n  });\r\n\r\n  test(\"returns 5 levels including xhigh for gpt-5.2 behind mux-gateway\", () => {\r\n    expect(getThinkingPolicyForModel(\"mux-gateway:openai/gpt-5.2\")).toEqual([\r\n      \"off\",\r\n      \"low\",\r\n      \"medium\",\r\n      \"high\",\r\n      \"xhigh\",\r\n    ]);\r\n  });\r\n\r\n  test(\"returns 5 levels including xhigh for gpt-5.2 with version suffix\", () => {\r\n    expect(getThinkingPolicyForModel(\"openai:gpt-5.2-2025-12-11\")).toEqual([\r\n      \"off\",\r\n      \"low\",\r\n      \"medium\",\r\n      \"high\",\r\n      \"xhigh\",\r\n    ]);\r\n  });\r\n\r\n  test(\"returns 5 levels including xhigh for gpt-5.1-codex-max behind mux-gateway\", () => {\r\n    expect(getThinkingPolicyForModel(\"mux-gateway:openai/gpt-5.1-codex-max\")).toEqual([\r\n      \"off\",\r\n      \"low\",\r\n      \"medium\",\r\n      \"high\",\r\n      \"xhigh\",\r\n    ]);\r\n  });\r\n  test(\"returns medium/high/xhigh for gpt-5.2-pro with version suffix\", () => {\r\n    expect(getThinkingPolicyForModel(\"openai:gpt-5.2-pro-2025-12-11\")).toEqual([\r\n      \"medium\",\r\n      \"high\",\r\n      \"xhigh\",\r\n    ]);\r\n  });\r\n\r\n  test(\"returns single HIGH for gpt-5-pro base model (legacy)\", () => {\r\n    expect(getThinkingPolicyForModel(\"openai:gpt-5-pro\")).toEqual([\"high\"]);\r\n  });\r\n\r\n  test(\"returns single HIGH for gpt-5-pro with version suffix (legacy)\", () => {\r\n    expect(getThinkingPolicyForModel(\"openai:gpt-5-pro-2025-10-06\")).toEqual([\"high\"]);\r\n  });\r\n\r\n  test(\"returns single HIGH for gpt-5-pro with whitespace after colon (legacy)\", () => {\r\n    expect(getThinkingPolicyForModel(\"openai: gpt-5-pro\")).toEqual([\"high\"]);\r\n  });\r\n\r\n  test(\"returns all levels for gpt-5-pro-mini (not a fixed policy)\", () => {\r\n    expect(getThinkingPolicyForModel(\"openai:gpt-5-pro-mini\")).toEqual([\r\n      \"off\",\r\n      \"low\",\r\n      \"medium\",\r\n      \"high\",\r\n    ]);\r\n  });\r\n\r\n  test(\"returns all levels for other OpenAI models\", () => {\r\n    expect(getThinkingPolicyForModel(\"openai:gpt-4o\")).toEqual([\"off\", \"low\", \"medium\", \"high\"]);\r\n    expect(getThinkingPolicyForModel(\"openai:gpt-4o-mini\")).toEqual([\r\n      \"off\",\r\n      \"low\",\r\n      \"medium\",\r\n      \"high\",\r\n    ]);\r\n  });\r\n\r\n  test(\"returns all levels for Opus 4.5 (uses default policy)\", () => {\r\n    // Opus 4.5 uses the default policy - no special case needed\r\n    // The effort parameter handles the \"off\" case by setting effort=\"low\"\r\n    expect(getThinkingPolicyForModel(\"anthropic:claude-opus-4-5\")).toEqual([\r\n      \"off\",\r\n      \"low\",\r\n      \"medium\",\r\n      \"high\",\r\n    ]);\r\n    expect(getThinkingPolicyForModel(\"anthropic:claude-opus-4-5-20251101\")).toEqual([\r\n      \"off\",\r\n      \"low\",\r\n      \"medium\",\r\n      \"high\",\r\n    ]);\r\n  });\r\n\r\n  test(\"returns 5 levels including xhigh for Opus 4.6\", () => {\r\n    expect(getThinkingPolicyForModel(\"anthropic:claude-opus-4-6\")).toEqual([\r\n      \"off\",\r\n      \"low\",\r\n      \"medium\",\r\n      \"high\",\r\n      \"xhigh\",\r\n    ]);\r\n    expect(getThinkingPolicyForModel(\"anthropic:claude-opus-4-6-20260201\")).toEqual([\r\n      \"off\",\r\n      \"low\",\r\n      \"medium\",\r\n      \"high\",\r\n      \"xhigh\",\r\n    ]);\r\n    // Behind gateway\r\n    expect(getThinkingPolicyForModel(\"mux-gateway:anthropic/claude-opus-4-6\")).toEqual([\r\n      \"off\",\r\n      \"low\",\r\n      \"medium\",\r\n      \"high\",\r\n      \"xhigh\",\r\n    ]);\r\n  });\r\n\r\n  test(\"returns low/high for Gemini 3 Pro\", () => {\r\n    expect(getThinkingPolicyForModel(\"google:gemini-3-pro-preview\")).toEqual([\"low\", \"high\"]);\r\n  });\r\n\r\n  test(\"returns off/low/medium/high for Gemini 3 Flash\", () => {\r\n    expect(getThinkingPolicyForModel(\"google:gemini-3-flash-preview\")).toEqual([\r\n      \"off\",\r\n      \"low\",\r\n      \"medium\",\r\n      \"high\",\r\n    ]);\r\n  });\r\n\r\n  test(\"returns all levels for other providers\", () => {\r\n    expect(getThinkingPolicyForModel(\"anthropic:claude-opus-4\")).toEqual([\r\n      \"off\",\r\n      \"low\",\r\n      \"medium\",\r\n      \"high\",\r\n    ]);\r\n    expect(getThinkingPolicyForModel(\"google:gemini-2.0-flash-thinking\")).toEqual([\r\n      \"off\",\r\n      \"low\",\r\n      \"medium\",\r\n      \"high\",\r\n    ]);\r\n  });\r\n});\r\n\r\ndescribe(\"enforceThinkingPolicy\", () => {\r\n  describe(\"single-option policy models (gpt-5-pro)\", () => {\r\n    test(\"enforces high for any requested level\", () => {\r\n      expect(enforceThinkingPolicy(\"openai:gpt-5-pro\", \"off\")).toBe(\"high\");\r\n      expect(enforceThinkingPolicy(\"openai:gpt-5-pro\", \"low\")).toBe(\"high\");\r\n      expect(enforceThinkingPolicy(\"openai:gpt-5-pro\", \"medium\")).toBe(\"high\");\r\n      expect(enforceThinkingPolicy(\"openai:gpt-5-pro\", \"high\")).toBe(\"high\");\r\n    });\r\n\r\n    test(\"enforces high for versioned gpt-5-pro\", () => {\r\n      expect(enforceThinkingPolicy(\"openai:gpt-5-pro-2025-10-06\", \"low\")).toBe(\"high\");\r\n    });\r\n  });\r\n\r\n  describe(\"multi-option policy models\", () => {\r\n    test(\"allows requested level if in allowed set\", () => {\r\n      expect(enforceThinkingPolicy(\"anthropic:claude-opus-4\", \"off\")).toBe(\"off\");\r\n      expect(enforceThinkingPolicy(\"anthropic:claude-opus-4\", \"low\")).toBe(\"low\");\r\n      expect(enforceThinkingPolicy(\"anthropic:claude-opus-4\", \"medium\")).toBe(\"medium\");\r\n      expect(enforceThinkingPolicy(\"anthropic:claude-opus-4\", \"high\")).toBe(\"high\");\r\n    });\r\n\r\n    test(\"falls back to medium when requested level not allowed\", () => {\r\n      // Simulating behavior with gpt-5-pro (only allows \"high\")\r\n      // When requesting \"low\", falls back to first allowed level which is \"high\"\r\n      expect(enforceThinkingPolicy(\"openai:gpt-5-pro\", \"low\")).toBe(\"high\");\r\n    });\r\n  });\r\n\r\n  describe(\"Opus 4.5 (all levels supported)\", () => {\r\n    test(\"allows all levels including off\", () => {\r\n      expect(enforceThinkingPolicy(\"anthropic:claude-opus-4-5\", \"off\")).toBe(\"off\");\r\n      expect(enforceThinkingPolicy(\"anthropic:claude-opus-4-5\", \"low\")).toBe(\"low\");\r\n      expect(enforceThinkingPolicy(\"anthropic:claude-opus-4-5\", \"medium\")).toBe(\"medium\");\r\n      expect(enforceThinkingPolicy(\"anthropic:claude-opus-4-5\", \"high\")).toBe(\"high\");\r\n    });\r\n\r\n    test(\"allows off for versioned model\", () => {\r\n      expect(enforceThinkingPolicy(\"anthropic:claude-opus-4-5-20251101\", \"off\")).toBe(\"off\");\r\n    });\r\n  });\r\n\r\n  describe(\"GPT-5.1-Codex-Max (5 levels including xhigh)\", () => {\r\n    test(\"allows all 5 levels including xhigh\", () => {\r\n      expect(enforceThinkingPolicy(\"openai:gpt-5.1-codex-max\", \"off\")).toBe(\"off\");\r\n      expect(enforceThinkingPolicy(\"openai:gpt-5.1-codex-max\", \"low\")).toBe(\"low\");\r\n      expect(enforceThinkingPolicy(\"openai:gpt-5.1-codex-max\", \"medium\")).toBe(\"medium\");\r\n      expect(enforceThinkingPolicy(\"openai:gpt-5.1-codex-max\", \"high\")).toBe(\"high\");\r\n      expect(enforceThinkingPolicy(\"openai:gpt-5.1-codex-max\", \"xhigh\")).toBe(\"xhigh\");\r\n    });\r\n\r\n    test(\"allows xhigh for versioned model\", () => {\r\n      expect(enforceThinkingPolicy(\"openai:gpt-5.1-codex-max-2025-12-01\", \"xhigh\")).toBe(\"xhigh\");\r\n    });\r\n  });\r\n\r\n  describe(\"GPT-5.2 (5 levels including xhigh)\", () => {\r\n    test(\"allows xhigh for base model\", () => {\r\n      expect(enforceThinkingPolicy(\"openai:gpt-5.2\", \"xhigh\")).toBe(\"xhigh\");\r\n    });\r\n\r\n    test(\"allows xhigh behind mux-gateway\", () => {\r\n      expect(enforceThinkingPolicy(\"mux-gateway:openai/gpt-5.2\", \"xhigh\")).toBe(\"xhigh\");\r\n    });\r\n\r\n    test(\"allows xhigh for versioned model\", () => {\r\n      expect(enforceThinkingPolicy(\"openai:gpt-5.2-2025-12-11\", \"xhigh\")).toBe(\"xhigh\");\r\n    });\r\n  });\r\n\r\n  describe(\"Opus 4.6 (5 levels including xhigh)\", () => {\r\n    test(\"allows all 5 levels including xhigh\", () => {\r\n      expect(enforceThinkingPolicy(\"anthropic:claude-opus-4-6\", \"off\")).toBe(\"off\");\r\n      expect(enforceThinkingPolicy(\"anthropic:claude-opus-4-6\", \"low\")).toBe(\"low\");\r\n      expect(enforceThinkingPolicy(\"anthropic:claude-opus-4-6\", \"medium\")).toBe(\"medium\");\r\n      expect(enforceThinkingPolicy(\"anthropic:claude-opus-4-6\", \"high\")).toBe(\"high\");\r\n      expect(enforceThinkingPolicy(\"anthropic:claude-opus-4-6\", \"xhigh\")).toBe(\"xhigh\");\r\n    });\r\n  });\r\n\r\n  describe(\"xhigh fallback for models without xhigh support\", () => {\r\n    test(\"clamps to highest allowed when xhigh requested on standard model\", () => {\r\n      expect(enforceThinkingPolicy(\"anthropic:claude-opus-4-5\", \"xhigh\")).toBe(\"high\");\r\n    });\r\n\r\n    test(\"falls back to high when xhigh requested on gpt-5-pro\", () => {\r\n      expect(enforceThinkingPolicy(\"openai:gpt-5-pro\", \"xhigh\")).toBe(\"high\");\r\n    });\r\n\r\n    test(\"clamps xhigh to high for standard Anthropic models\", () => {\r\n      expect(enforceThinkingPolicy(\"anthropic:claude-sonnet-4-5\", \"xhigh\")).toBe(\"high\");\r\n    });\r\n  });\r\n});\r\n\r\n// Note: Tests for invalid levels removed - TypeScript type system prevents invalid\r\n// ThinkingLevel values at compile time, making runtime invalid-level tests unnecessary.\r\ndescribe(\"resolveThinkingInput\", () => {\r\n  test(\"passes through named levels directly\", () => {\r\n    expect(resolveThinkingInput(\"off\", \"anthropic:claude-opus-4-1\")).toBe(\"off\");\r\n    expect(resolveThinkingInput(\"high\", \"anthropic:claude-opus-4-1\")).toBe(\"high\");\r\n    expect(resolveThinkingInput(\"medium\", \"openai:gpt-5.2-pro\")).toBe(\"medium\");\r\n  });\r\n\r\n  test(\"numeric 0 maps to model's lowest allowed level\", () => {\r\n    // Default models: lowest = \"off\"\r\n    expect(resolveThinkingInput(0, \"anthropic:claude-opus-4-1\")).toBe(\"off\");\r\n    // gpt-5.2-pro: lowest = \"medium\"\r\n    expect(resolveThinkingInput(0, \"openai:gpt-5.2-pro\")).toBe(\"medium\");\r\n    // gpt-5-pro: only \"high\"\r\n    expect(resolveThinkingInput(0, \"openai:gpt-5-pro\")).toBe(\"high\");\r\n    // gemini-3: lowest = \"low\"\r\n    expect(resolveThinkingInput(0, \"google:gemini-3\")).toBe(\"low\");\r\n  });\r\n\r\n  test(\"numeric indices map through model's sorted allowed levels\", () => {\r\n    // Default: [off, low, medium, high] → 0=off, 1=low, 2=medium, 3=high\r\n    expect(resolveThinkingInput(0, \"anthropic:claude-sonnet-4-5\")).toBe(\"off\");\r\n    expect(resolveThinkingInput(1, \"anthropic:claude-sonnet-4-5\")).toBe(\"low\");\r\n    expect(resolveThinkingInput(2, \"anthropic:claude-sonnet-4-5\")).toBe(\"medium\");\r\n    expect(resolveThinkingInput(3, \"anthropic:claude-sonnet-4-5\")).toBe(\"high\");\r\n\r\n    // gpt-5.2-pro: [medium, high, xhigh] → 0=medium, 1=high, 2=xhigh\r\n    expect(resolveThinkingInput(0, \"openai:gpt-5.2-pro\")).toBe(\"medium\");\r\n    expect(resolveThinkingInput(1, \"openai:gpt-5.2-pro\")).toBe(\"high\");\r\n    expect(resolveThinkingInput(2, \"openai:gpt-5.2-pro\")).toBe(\"xhigh\");\r\n  });\r\n\r\n  test(\"out-of-range numeric index clamps to model's highest level\", () => {\r\n    // Default has 4 levels, index 9 clamps to \"high\"\r\n    expect(resolveThinkingInput(9, \"anthropic:claude-sonnet-4-5\")).toBe(\"high\");\r\n    // gpt-5-pro only has \"high\", any index clamps to \"high\"\r\n    expect(resolveThinkingInput(5, \"openai:gpt-5-pro\")).toBe(\"high\");\r\n    // gpt-5.2-pro has 3 levels, index 4 clamps to \"xhigh\"\r\n    expect(resolveThinkingInput(4, \"openai:gpt-5.2-pro\")).toBe(\"xhigh\");\r\n  });\r\n});\r\n"]}