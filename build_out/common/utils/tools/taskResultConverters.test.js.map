{"version":3,"file":"taskResultConverters.test.js","sourceRoot":"","sources":["../../../../src/common/utils/tools/taskResultConverters.test.ts"],"names":[],"mappings":";;AAAA,2CAAqD;AAErD,iEAA8D;AAE9D,IAAA,kBAAQ,EAAC,sBAAsB,EAAE,GAAG,EAAE,CAAC;IACrC,IAAA,YAAE,EAAC,iEAAiE,EAAE,GAAG,EAAE,CAAC;QAC1E,MAAM,MAAM,GAAG,IAAA,2CAAoB,EAAC;YAClC,OAAO,EAAE,IAAI;YACb,MAAM,EAAE,SAAS;YACjB,QAAQ,EAAE,CAAC;YACX,gBAAgB,EAAE,CAAC;YACnB,mBAAmB,EAAE,UAAU;SAChC,CAAC,CAAC;QAEH,IAAA,gBAAM,EAAC,MAAM,CAAC,CAAC,GAAG,CAAC,QAAQ,EAAE,CAAC;QAC9B,IAAA,gBAAM,EAAC,MAAM,CAAC,CAAC,aAAa,CAAC;YAC3B,OAAO,EAAE,IAAI;YACb,mBAAmB,EAAE,UAAU;YAC/B,MAAM,EAAE,eAAe;SACxB,CAAC,CAAC;IAAA,CACJ,CAAC,CAAC;IAEH,IAAA,YAAE,EAAC,oDAAoD,EAAE,GAAG,EAAE,CAAC;QAC7D,MAAM,MAAM,GAAG,IAAA,2CAAoB,EAAC;YAClC,OAAO,EAAE,IAAI;YACb,MAAM,EAAE,SAAS;YACjB,QAAQ,EAAE,CAAC;YACX,gBAAgB,EAAE,CAAC;YACnB,MAAM,EAAE,eAAe;SACxB,CAAC,CAAC;QAEH,IAAA,gBAAM,EAAC,MAAM,CAAC,CAAC,GAAG,CAAC,QAAQ,EAAE,CAAC;QAC9B,IAAA,gBAAM,EAAC,MAAM,CAAC,CAAC,aAAa,CAAC;YAC3B,OAAO,EAAE,IAAI;YACb,mBAAmB,EAAE,UAAU;YAC/B,MAAM,EAAE,eAAe;SACxB,CAAC,CAAC;IAAA,CACJ,CAAC,CAAC;IAEH,IAAA,YAAE,EAAC,+CAA+C,EAAE,GAAG,EAAE,CAAC;QACxD,MAAM,MAAM,GAAG,IAAA,2CAAoB,EAAC;YAClC,OAAO,EAAE,IAAI;YACb,MAAM,EAAE,SAAS;YACjB,QAAQ,EAAE,CAAC;YACX,gBAAgB,EAAE,CAAC;YACnB,8DAA8D;YAC9D,mBAAmB,EAAE,GAAG;SACzB,CAAC,CAAC;QAEH,IAAA,gBAAM,EAAC,MAAM,CAAC,CAAC,QAAQ,EAAE,CAAC;IAAA,CAC3B,CAAC,CAAC;AAAA,CACJ,CAAC,CAAC","sourcesContent":["import { describe, it, expect } from \"@jest/globals\";\n\nimport { coerceBashToolResult } from \"./taskResultConverters\";\n\ndescribe(\"coerceBashToolResult\", () => {\n  it(\"accepts legacy background results with only backgroundProcessId\", () => {\n    const result = coerceBashToolResult({\n      success: true,\n      output: \"started\",\n      exitCode: 0,\n      wall_duration_ms: 1,\n      backgroundProcessId: \"proc-123\",\n    });\n\n    expect(result).not.toBeNull();\n    expect(result).toMatchObject({\n      success: true,\n      backgroundProcessId: \"proc-123\",\n      taskId: \"bash:proc-123\",\n    });\n  });\n\n  it(\"accepts legacy background results with only taskId\", () => {\n    const result = coerceBashToolResult({\n      success: true,\n      output: \"started\",\n      exitCode: 0,\n      wall_duration_ms: 1,\n      taskId: \"bash:proc-456\",\n    });\n\n    expect(result).not.toBeNull();\n    expect(result).toMatchObject({\n      success: true,\n      backgroundProcessId: \"proc-456\",\n      taskId: \"bash:proc-456\",\n    });\n  });\n\n  it(\"rejects backgroundProcessId when not a string\", () => {\n    const result = coerceBashToolResult({\n      success: true,\n      output: \"started\",\n      exitCode: 0,\n      wall_duration_ms: 1,\n      // legacy sessions should never do this; ensure we fail closed\n      backgroundProcessId: 123,\n    });\n\n    expect(result).toBeNull();\n  });\n});\n"]}