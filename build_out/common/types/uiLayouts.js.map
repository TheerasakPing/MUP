{"version":3,"file":"uiLayouts.js","sourceRoot":"","sources":["../../../src/common/types/uiLayouts.ts"],"names":[],"mappings":"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","sourcesContent":["import assert from \"@/common/utils/assert\";\r\nimport type { Keybind } from \"@/common/types/keybind\";\r\nimport { hasModifierKeybind, normalizeKeybind } from \"@/common/types/keybind\";\r\n\r\n/**\r\n * Layout slots are 1-indexed and unbounded.\r\n *\r\n * Slots 1â€“9 are reserved for the default Ctrl/Cmd+Alt+1..9 hotkeys.\r\n */\r\nexport type LayoutSlotNumber = number;\r\n\r\nexport interface LayoutSlot {\r\n  slot: LayoutSlotNumber;\r\n  /** The layout stored in this slot, if any. */\r\n  preset?: LayoutPreset;\r\n  /** Optional keybind override for applying this slot. */\r\n  keybindOverride?: Keybind;\r\n}\r\n\r\nexport type RightSidebarPresetBaseTabType = \"costs\" | \"review\" | \"explorer\" | \"stats\";\r\nexport type RightSidebarPresetTabType = RightSidebarPresetBaseTabType | `terminal_new:${string}`;\r\n\r\nexport type RightSidebarLayoutPresetNode =\r\n  | {\r\n      type: \"split\";\r\n      id: string;\r\n      direction: \"horizontal\" | \"vertical\";\r\n      sizes: [number, number];\r\n      children: [RightSidebarLayoutPresetNode, RightSidebarLayoutPresetNode];\r\n    }\r\n  | {\r\n      type: \"tabset\";\r\n      id: string;\r\n      tabs: RightSidebarPresetTabType[];\r\n      activeTab: RightSidebarPresetTabType;\r\n    };\r\n\r\nexport interface RightSidebarLayoutPresetState {\r\n  version: 1;\r\n  nextId: number;\r\n  focusedTabsetId: string;\r\n  root: RightSidebarLayoutPresetNode;\r\n}\r\n\r\nexport type RightSidebarWidthPreset =\r\n  | {\r\n      mode: \"px\";\r\n      value: number;\r\n    }\r\n  | {\r\n      mode: \"fraction\";\r\n      value: number;\r\n    };\r\n\r\nexport interface LayoutPreset {\r\n  id: string;\r\n  name: string;\r\n  leftSidebarCollapsed: boolean;\r\n  leftSidebarWidthPx?: number;\r\n  rightSidebar: {\r\n    collapsed: boolean;\r\n    width: RightSidebarWidthPreset;\r\n    layout: RightSidebarLayoutPresetState;\r\n  };\r\n}\r\n\r\nexport interface LayoutPresetsConfig {\r\n  version: 2;\r\n  slots: LayoutSlot[];\r\n}\r\n\r\nexport const DEFAULT_LAYOUT_PRESETS_CONFIG: LayoutPresetsConfig = {\r\n  version: 2,\r\n  slots: [],\r\n};\r\n\r\nfunction isLayoutSlotNumber(value: unknown): value is LayoutSlotNumber {\r\n  return typeof value === \"number\" && Number.isInteger(value) && value >= 1;\r\n}\r\n\r\nfunction normalizeOptionalNonEmptyString(value: unknown): string | undefined {\r\n  if (typeof value !== \"string\") {\r\n    return undefined;\r\n  }\r\n\r\n  const trimmed = value.trim();\r\n  return trimmed ? trimmed : undefined;\r\n}\r\n\r\nfunction normalizeRightSidebarWidthPreset(raw: unknown): RightSidebarWidthPreset {\r\n  if (!raw || typeof raw !== \"object\") {\r\n    return { mode: \"px\", value: 400 };\r\n  }\r\n\r\n  const record = raw as Record<string, unknown>;\r\n  const mode = record.mode;\r\n\r\n  if (mode === \"fraction\") {\r\n    const value =\r\n      typeof record.value === \"number\" && Number.isFinite(record.value) ? record.value : 0.3;\r\n    // Keep in a sensible range (avoid 0px or >100% layouts)\r\n    const clamped = Math.min(0.9, Math.max(0.1, value));\r\n    return { mode: \"fraction\", value: clamped };\r\n  }\r\n\r\n  const value =\r\n    typeof record.value === \"number\" && Number.isFinite(record.value) ? record.value : 400;\r\n  const rounded = Math.floor(value);\r\n  const clamped = Math.min(1200, Math.max(300, rounded));\r\n  return { mode: \"px\", value: clamped };\r\n}\r\n\r\nfunction isPresetTabType(value: unknown): value is RightSidebarPresetTabType {\r\n  if (typeof value !== \"string\") return false;\r\n  if (value === \"costs\" || value === \"review\" || value === \"explorer\" || value === \"stats\") {\r\n    return true;\r\n  }\r\n  return value.startsWith(\"terminal_new:\") && value.length > \"terminal_new:\".length;\r\n}\r\n\r\nfunction isLayoutNode(value: unknown): value is RightSidebarLayoutPresetNode {\r\n  if (!value || typeof value !== \"object\") return false;\r\n  const v = value as Record<string, unknown>;\r\n\r\n  if (v.type === \"tabset\") {\r\n    return (\r\n      typeof v.id === \"string\" &&\r\n      Array.isArray(v.tabs) &&\r\n      v.tabs.every((t) => isPresetTabType(t)) &&\r\n      isPresetTabType(v.activeTab)\r\n    );\r\n  }\r\n\r\n  if (v.type === \"split\") {\r\n    if (typeof v.id !== \"string\") return false;\r\n    if (v.direction !== \"horizontal\" && v.direction !== \"vertical\") return false;\r\n    if (!Array.isArray(v.sizes) || v.sizes.length !== 2) return false;\r\n    if (typeof v.sizes[0] !== \"number\" || typeof v.sizes[1] !== \"number\") return false;\r\n    if (!Array.isArray(v.children) || v.children.length !== 2) return false;\r\n    return isLayoutNode(v.children[0]) && isLayoutNode(v.children[1]);\r\n  }\r\n\r\n  return false;\r\n}\r\n\r\nfunction findTabset(\r\n  root: RightSidebarLayoutPresetNode,\r\n  tabsetId: string\r\n): RightSidebarLayoutPresetNode | null {\r\n  if (root.type === \"tabset\") {\r\n    return root.id === tabsetId ? root : null;\r\n  }\r\n  return findTabset(root.children[0], tabsetId) ?? findTabset(root.children[1], tabsetId);\r\n}\r\n\r\nfunction isRightSidebarLayoutPresetState(value: unknown): value is RightSidebarLayoutPresetState {\r\n  if (!value || typeof value !== \"object\") return false;\r\n  const v = value as Record<string, unknown>;\r\n  if (v.version !== 1) return false;\r\n  if (typeof v.nextId !== \"number\") return false;\r\n  if (typeof v.focusedTabsetId !== \"string\") return false;\r\n  if (!isLayoutNode(v.root)) return false;\r\n  return findTabset(v.root, v.focusedTabsetId) !== null;\r\n}\r\n\r\nfunction normalizeLayoutSlot(raw: unknown): LayoutSlot | undefined {\r\n  if (!raw || typeof raw !== \"object\") {\r\n    return undefined;\r\n  }\r\n\r\n  const record = raw as Record<string, unknown>;\r\n\r\n  if (!isLayoutSlotNumber(record.slot)) {\r\n    return undefined;\r\n  }\r\n\r\n  const preset = normalizeLayoutPreset(record.preset);\r\n\r\n  const keybindOverrideRaw = normalizeKeybind(record.keybindOverride);\r\n  const keybindOverride = keybindOverrideRaw\r\n    ? hasModifierKeybind(keybindOverrideRaw)\r\n      ? keybindOverrideRaw\r\n      : undefined\r\n    : undefined;\r\n\r\n  if (!preset && !keybindOverride) {\r\n    return undefined;\r\n  }\r\n\r\n  return {\r\n    slot: record.slot,\r\n    preset: preset ?? undefined,\r\n    keybindOverride,\r\n  };\r\n}\r\n\r\nfunction normalizeLayoutSlotV1(\r\n  raw: unknown\r\n): { slot: LayoutSlotNumber; presetId?: string; keybindOverride?: Keybind } | undefined {\r\n  if (!raw || typeof raw !== \"object\") {\r\n    return undefined;\r\n  }\r\n\r\n  const record = raw as Record<string, unknown>;\r\n\r\n  if (!isLayoutSlotNumber(record.slot)) {\r\n    return undefined;\r\n  }\r\n\r\n  const presetId = normalizeOptionalNonEmptyString(record.presetId);\r\n  const keybindOverrideRaw = normalizeKeybind(record.keybindOverride);\r\n  const keybindOverride = keybindOverrideRaw\r\n    ? hasModifierKeybind(keybindOverrideRaw)\r\n      ? keybindOverrideRaw\r\n      : undefined\r\n    : undefined;\r\n\r\n  if (!presetId && !keybindOverride) {\r\n    return undefined;\r\n  }\r\n\r\n  return {\r\n    slot: record.slot,\r\n    presetId,\r\n    keybindOverride,\r\n  };\r\n}\r\n\r\nfunction normalizeLayoutPreset(raw: unknown): LayoutPreset | undefined {\r\n  if (!raw || typeof raw !== \"object\") {\r\n    return undefined;\r\n  }\r\n\r\n  const record = raw as Record<string, unknown>;\r\n\r\n  const id = normalizeOptionalNonEmptyString(record.id);\r\n  const name = normalizeOptionalNonEmptyString(record.name);\r\n  if (!id || !name) {\r\n    return undefined;\r\n  }\r\n\r\n  const leftSidebarCollapsed =\r\n    typeof record.leftSidebarCollapsed === \"boolean\" ? record.leftSidebarCollapsed : false;\r\n\r\n  const leftSidebarWidthPx =\r\n    typeof record.leftSidebarWidthPx === \"number\" && Number.isFinite(record.leftSidebarWidthPx)\r\n      ? Math.min(600, Math.max(200, Math.floor(record.leftSidebarWidthPx)))\r\n      : undefined;\r\n\r\n  if (!record.rightSidebar || typeof record.rightSidebar !== \"object\") {\r\n    return undefined;\r\n  }\r\n\r\n  const rightSidebarRecord = record.rightSidebar as Record<string, unknown>;\r\n  const collapsed =\r\n    typeof rightSidebarRecord.collapsed === \"boolean\" ? rightSidebarRecord.collapsed : false;\r\n  const width = normalizeRightSidebarWidthPreset(rightSidebarRecord.width);\r\n\r\n  const layoutRaw = rightSidebarRecord.layout;\r\n  if (!isRightSidebarLayoutPresetState(layoutRaw)) {\r\n    return undefined;\r\n  }\r\n\r\n  const layout: RightSidebarLayoutPresetState = layoutRaw;\r\n\r\n  return {\r\n    id,\r\n    name,\r\n    leftSidebarCollapsed,\r\n    leftSidebarWidthPx,\r\n    rightSidebar: {\r\n      collapsed,\r\n      width,\r\n      layout,\r\n    },\r\n  };\r\n}\r\n\r\nexport function normalizeLayoutPresetsConfig(raw: unknown): LayoutPresetsConfig {\r\n  if (!raw || typeof raw !== \"object\") {\r\n    return DEFAULT_LAYOUT_PRESETS_CONFIG;\r\n  }\r\n\r\n  const record = raw as Record<string, unknown>;\r\n\r\n  if (record.version === 2) {\r\n    return normalizeLayoutPresetsConfigV2(record);\r\n  }\r\n\r\n  if (record.version === 1) {\r\n    return migrateLayoutPresetsConfigV1(record);\r\n  }\r\n\r\n  return DEFAULT_LAYOUT_PRESETS_CONFIG;\r\n}\r\n\r\nfunction normalizeLayoutPresetsConfigV2(record: Record<string, unknown>): LayoutPresetsConfig {\r\n  const slotsArray = Array.isArray(record.slots) ? record.slots : [];\r\n  const slotsByNumber = new Map<LayoutSlotNumber, LayoutSlot>();\r\n\r\n  for (const entry of slotsArray) {\r\n    const slot = normalizeLayoutSlot(entry);\r\n    if (!slot) continue;\r\n    slotsByNumber.set(slot.slot, slot);\r\n  }\r\n\r\n  const slots = Array.from(slotsByNumber.values()).sort((a, b) => a.slot - b.slot);\r\n\r\n  const result: LayoutPresetsConfig = {\r\n    version: 2,\r\n    slots,\r\n  };\r\n\r\n  assert(result.version === 2, \"normalizeLayoutPresetsConfig: version must be 2\");\r\n  assert(Array.isArray(result.slots), \"normalizeLayoutPresetsConfig: slots must be an array\");\r\n\r\n  return result;\r\n}\r\n\r\nfunction migrateLayoutPresetsConfigV1(record: Record<string, unknown>): LayoutPresetsConfig {\r\n  const presetsArray = Array.isArray(record.presets) ? record.presets : [];\r\n  const presetsById = new Map<string, LayoutPreset>();\r\n\r\n  for (const entry of presetsArray) {\r\n    const preset = normalizeLayoutPreset(entry);\r\n    if (!preset) continue;\r\n    presetsById.set(preset.id, preset);\r\n  }\r\n\r\n  const slotsArray = Array.isArray(record.slots) ? record.slots : [];\r\n  const slotsByNumber = new Map<LayoutSlotNumber, LayoutSlot>();\r\n\r\n  for (const entry of slotsArray) {\r\n    const slot = normalizeLayoutSlotV1(entry);\r\n    if (!slot) continue;\r\n\r\n    const preset = slot.presetId ? presetsById.get(slot.presetId) : undefined;\r\n    if (!preset && !slot.keybindOverride) {\r\n      continue;\r\n    }\r\n\r\n    slotsByNumber.set(slot.slot, {\r\n      slot: slot.slot,\r\n      preset,\r\n      keybindOverride: slot.keybindOverride,\r\n    });\r\n  }\r\n\r\n  const slots = Array.from(slotsByNumber.values()).sort((a, b) => a.slot - b.slot);\r\n\r\n  const result: LayoutPresetsConfig = {\r\n    version: 2,\r\n    slots,\r\n  };\r\n\r\n  assert(result.version === 2, \"migrateLayoutPresetsConfigV1: version must be 2\");\r\n  assert(Array.isArray(result.slots), \"migrateLayoutPresetsConfigV1: slots must be an array\");\r\n\r\n  return result;\r\n}\r\n\r\nexport function isLayoutPresetsConfigEmpty(value: LayoutPresetsConfig): boolean {\r\n  assert(value.version === 2, \"isLayoutPresetsConfigEmpty: version must be 2\");\r\n\r\n  for (const slot of value.slots) {\r\n    if (slot.preset || slot.keybindOverride) {\r\n      return false;\r\n    }\r\n  }\r\n\r\n  return true;\r\n}\r\n"]}