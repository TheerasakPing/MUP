{"version":3,"file":"mcp.js","sourceRoot":"","sources":["../../../src/common/types/mcp.ts"],"names":[],"mappings":"","sourcesContent":["/** Supported MCP server transports. */\r\nexport type MCPServerTransport = \"stdio\" | \"http\" | \"sse\" | \"auto\";\r\n\r\nexport type MCPHeaderValue = string | { secret: string };\r\n\r\nexport interface MCPServerBaseInfo {\r\n  transport: MCPServerTransport;\r\n  disabled: boolean;\r\n  /**\r\n   * Optional tool allowlist at project level.\r\n   * If set, only these tools are exposed from this server.\r\n   * If not set, all tools are exposed.\r\n   */\r\n  toolAllowlist?: string[];\r\n}\r\n\r\n/** stdio server definition (local process). */\r\nexport interface MCPStdioServerInfo extends MCPServerBaseInfo {\r\n  transport: \"stdio\";\r\n  command: string;\r\n}\r\n\r\n/** HTTP-based server definition. */\r\nexport interface MCPHttpServerInfo extends MCPServerBaseInfo {\r\n  transport: \"http\" | \"sse\" | \"auto\";\r\n  url: string;\r\n  /** Optional headers (string literal or reference to a project secret key). */\r\n  headers?: Record<string, MCPHeaderValue>;\r\n}\r\n\r\n/** Normalized server info (always has disabled field). */\r\nexport type MCPServerInfo = MCPStdioServerInfo | MCPHttpServerInfo;\r\n\r\nexport interface MCPConfig {\r\n  servers: Record<string, MCPServerInfo>;\r\n}\r\n\r\n/**\r\n * Internal map of server name â†’ server info (used after filtering disabled).\r\n * Values are not shown to the model; only server names are exposed.\r\n */\r\nexport type MCPServerMap = Record<string, MCPServerInfo>;\r\n\r\n/**\r\n * Parsed OAuth hints from a `WWW-Authenticate: Bearer ...` challenge.\r\n *\r\n * NOTE: This type is safe for IPC/UI; it must never contain tokens.\r\n */\r\nexport interface BearerChallenge {\r\n  scope?: string;\r\n  /** `resource_metadata` hint URL (if present and parseable). */\r\n  resourceMetadataUrl?: string;\r\n}\r\n\r\n/** Result of testing an MCP server connection */\r\nexport type MCPTestResult =\r\n  | { success: true; tools: string[] }\r\n  | { success: false; error: string; oauthChallenge?: BearerChallenge };\r\n\r\n/** Cached test result with timestamp for age display */\r\nexport interface CachedMCPTestResult {\r\n  result: MCPTestResult;\r\n  testedAt: number; // Unix timestamp ms\r\n}\r\n\r\n/**\r\n * Per-workspace MCP overrides.\r\n *\r\n * Stored per-workspace in <workspace>/.mux/mcp.local.jsonc (workspace-local and intended to be gitignored).\r\n *\r\n * Legacy note: older mux versions stored these overrides in ~/.mux/config.json under each workspace entry.\r\n * Newer versions migrate those values into the workspace-local file on first read/write.\r\n */\r\nexport interface WorkspaceMCPOverrides {\r\n  /**\r\n   * Server names to explicitly disable for this workspace.\r\n   * Overrides project-level enabled state.\r\n   */\r\n  disabledServers?: string[];\r\n\r\n  /**\r\n   * Server names to explicitly enable for this workspace.\r\n   * Overrides project-level disabled state.\r\n   */\r\n  enabledServers?: string[];\r\n\r\n  /**\r\n   * Per-server tool allowlist.\r\n   * Key: server name (from .mux/mcp.jsonc)\r\n   * Value: raw MCP tool names (NOT namespaced)\r\n   *\r\n   * If omitted for a server => expose all tools from that server.\r\n   * If present but empty => expose no tools from that server.\r\n   */\r\n  toolAllowlist?: Record<string, string[]>;\r\n}\r\n"]}